<!DOCTYPE html><html lang="ja"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.0d86aa92c5843d055886.css" id="gatsby-global-css">/*!
 * ress.css • v2.0.4
 * MIT License
 * github.com/filipelinhares/ress
 */html{box-sizing:border-box;-webkit-text-size-adjust:100%;word-break:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4}*,:after,:before{background-repeat:no-repeat;box-sizing:inherit}:after,:before{text-decoration:inherit;vertical-align:inherit}*{padding:0;margin:0}hr{overflow:visible;height:0}details,main{display:block}summary{display:list-item}small{font-size:80%}[hidden]{display:none}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}a{background-color:transparent}a:active,a:hover{outline-width:0}code,kbd,pre,samp{font-family:monospace,monospace}pre{font-size:1em}b,strong{font-weight:bolder}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}input{border-radius:0}[disabled]{cursor:default}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}textarea{overflow:auto;resize:vertical}button,input,optgroup,select,textarea{font:inherit}optgroup{font-weight:700}button{overflow:visible}button,select{text-transform:none}[role=button],[type=button],[type=reset],[type=submit],button{cursor:pointer;color:inherit}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button:-moz-focusring{outline:1px dotted ButtonText}[type=reset],[type=submit],button,html [type=button]{-webkit-appearance:button}button,input,select,textarea{background-color:transparent;border-style:none}select{-moz-appearance:none;-webkit-appearance:none}select::-ms-expand{display:none}select::-ms-value{color:currentColor}legend{border:0;color:inherit;display:table;white-space:normal;max-width:100%}::-webkit-file-upload-button{-webkit-appearance:button;color:inherit;font:inherit}img{border-style:none}progress{vertical-align:baseline}svg:not([fill]){fill:currentColor}@media screen{[hidden~=screen]{display:inherit}[hidden~=screen]:not(:active):not(:focus):not(:target){position:absolute!important;clip:rect(0 0 0 0)!important}}[aria-busy=true]{cursor:progress}[aria-controls]{cursor:pointer}[aria-disabled]{cursor:default}</style><meta name="generator" content="Gatsby 2.30.1"/><link rel="preconnect" href="https://www.google-analytics.com"/><link rel="dns-prefetch" href="https://www.google-analytics.com"/><title data-react-helmet="true">AWS CloudTrail用のコスパの良いSIEMを探す - On Blahfe</title><link data-react-helmet="true" rel="canonical" href="https://nabinno.github.io/posts/93"/><meta data-react-helmet="true" name="google-site-verification" content=""/><meta data-react-helmet="true" name="description" content="IT統制において証跡管理の充実という観点から、また、ゼロトラストの強化という観点からSIEMの導入が必要になってきました。今回はAWS CloudTrail用のSIEMについてざっと調べました。   &gt; PROBLEMPROBLEM 

-"/><meta data-react-helmet="true" property="og:url" content="https://nabinno.github.io/posts/93"/><meta data-react-helmet="true" property="og:type" content="article"/><meta data-react-helmet="true" property="og:title" content="AWS CloudTrail用のコスパの良いSIEMを探す - On Blahfe"/><meta data-react-helmet="true" property="og:description" content="IT統制において証跡管理の充実という観点から、また、ゼロトラストの強化という観点からSIEMの導入が必要になってきました。今回はAWS CloudTrail用のSIEMについてざっと調べました。   &gt; PROBLEMPROBLEM 

-"/><meta data-react-helmet="true" property="og:image" content="https://img.esa.io/uploads/production/attachments/16651/2021/08/15/97367/649a1db9-aa36-4be6-846b-bb34d1e1eb31.png"/><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"/><meta data-react-helmet="true" name="twitter:creator" content="@nabinno"/><meta data-react-helmet="true" name="twitter:title" content="AWS CloudTrail用のコスパの良いSIEMを探す - On Blahfe"/><meta data-react-helmet="true" name="twitter:description" content="IT統制において証跡管理の充実という観点から、また、ゼロトラストの強化という観点からSIEMの導入が必要になってきました。今回はAWS CloudTrail用のSIEMについてざっと調べました。   &gt; PROBLEMPROBLEM 

-"/><meta data-react-helmet="true" name="twitter:image" content="https://img.esa.io/uploads/production/attachments/16651/2021/08/15/97367/649a1db9-aa36-4be6-846b-bb34d1e1eb31.png"/><link rel="icon" href="/favicon-32x32.png?v=381a3661ec5793ff376970a2019b6518" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><meta name="theme-color" content="#fff"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=381a3661ec5793ff376970a2019b6518"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=381a3661ec5793ff376970a2019b6518"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=381a3661ec5793ff376970a2019b6518"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=381a3661ec5793ff376970a2019b6518"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=381a3661ec5793ff376970a2019b6518"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=381a3661ec5793ff376970a2019b6518"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=381a3661ec5793ff376970a2019b6518"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=381a3661ec5793ff376970a2019b6518"/><link rel="alternate" type="application/rss+xml" href="/rss.xml"/><link as="script" rel="preload" href="/webpack-runtime-7a7e64c679eaacb6bc0d.js"/><link as="script" rel="preload" href="/framework-dbb498007a7447f28d8e.js"/><link as="script" rel="preload" href="/app-1609d7d465ccd6a5a330.js"/><link as="script" rel="preload" href="/styles-e9d24b1846c7d6eb9685.js"/><link as="script" rel="preload" href="/commons-d1e204551af284801370.js"/><link as="script" rel="preload" href="/component---src-templates-posts-tsx-01adf45b9f8003118fcd.js"/><link as="script" rel="preload" href="/component---src-templates-post-tsx-557e62df0f80429a7567.js"/><link as="fetch" rel="preload" href="/page-data/posts/93/page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data/app-data.json" crossorigin="anonymous"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="ly78bw">.css-ly78bw{font-family:-apple-system-body,'Source Han Mono',BlinkMacSystemFont,'Helvetica Neue','Hiragino Sans','Hiragino Kaku Gothic ProN','Noto Sans Japanese','游ゴシック  Medium','Yu Gothic Medium','メイリオ',meiryo,sans-serif;}@media screen and (-webkit-min-device-pixel-ratio:2),screen and (min-resolution:2dppx){.css-ly78bw{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;}}</style><div class="css-ly78bw e1j2fp1f0"><div><style data-emotion-css="10061d2">.css-10061d2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;}@media (min-width:980px){.css-10061d2{-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;}}</style><div class="css-10061d2 e1rphn8v0"><style data-emotion-css="1ur9eye">.css-1ur9eye{max-width:620px;width:100%;margin:20px auto;}</style><div style="margin-top:32px" class="css-1ur9eye e1rphn8v1"><style data-emotion-css="1igky03">.css-1igky03{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-right:auto;margin-bottom:1.75rem;}</style><h1 class="css-1igky03"><style data-emotion-css="1a6yofc">.css-1a6yofc{color:rgba(26,32,44,0.88);-webkit-text-decoration:none;text-decoration:none;font-family:Montserrat,sans-serif;font-weight:900;font-size:1.4427rem;line-height:1.1;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;padding:16px;margin:-16px;}.css-1a6yofc:hover{background-color:rgba(255,255,255,0.1);}</style><a class="css-1a6yofc" href="/">On Blahfe</a></h1><style data-emotion-css="kvk3sk">.css-kvk3sk{padding:0 12px;}@media (min-width:600px){.css-kvk3sk{padding:0;}}</style><div class="css-kvk3sk epep3293"><style data-emotion-css="19sxenz">.css-19sxenz{display:block;margin-bottom:4px;font-weight:600;-webkit-letter-spacing:0.5px;-moz-letter-spacing:0.5px;-ms-letter-spacing:0.5px;letter-spacing:0.5px;opacity:0.6;font-size:15px;}</style><time class="css-19sxenz">2021.08.15</time><style data-emotion-css="1b1c2m5">.css-1b1c2m5{font-size:24px;line-height:1.4;font-weight:700;margin-bottom:4px;color:#1a202c;font-family:-apple-system,'Source Han Mono','BlinkMacSystemFont','Helvetica Neue','Hiragino Sans','游ゴシック Medium','YuGothic','Hiragino Kaku Gothic ProN','メイリオ','Meiryo,sans-serif';}@media (min-width:600px){.css-1b1c2m5{font-size:30px;}}</style><h1 class="css-1b1c2m5 epep3291">AWS CloudTrail用のコスパの良いSIEMを探す</h1><style data-emotion-css="3bor06">.css-3bor06{display:inline-block;background-color:white;border:1px solid #eee;color:rgba(0,0,0,0.6);padding:6px 12px;margin-right:8px;font-weight:bold;font-size:12px;border-radius:4px;-webkit-text-decoration:none;text-decoration:none;background-image:linear-gradient( 45deg,#58463C 0px,#80695F 100% );color:white;margin-bottom:4px;text-transform:capitalize;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;}.css-3bor06:hover{border-color:#ccc;color:rgba(0,0,0,0.8);}.css-3bor06:before{content:'#';}.css-3bor06:hover{border-color:inherit;color:white;}.css-3bor06:before{content:'';}</style><a class="css-3bor06 epep3292" href="/categories/blog/backend">blog/backend</a><style data-emotion-css="1qp0zyo">.css-1qp0zyo{display:inline-block;background-color:white;border:1px solid #eee;color:rgba(0,0,0,0.6);padding:6px 12px;margin-right:8px;font-weight:bold;font-size:12px;border-radius:4px;-webkit-text-decoration:none;text-decoration:none;}.css-1qp0zyo:hover{border-color:#ccc;color:rgba(0,0,0,0.8);}.css-1qp0zyo:before{content:'#';}</style><a style="margin-top:4px;margin-bottom:8px" class="css-1qp0zyo evhx4tm0" href="/tags/siem">siem</a><a style="margin-top:4px;margin-bottom:8px" class="css-1qp0zyo evhx4tm0" href="/tags/aws-cloudtrail">aws-cloudtrail</a><a style="margin-top:4px;margin-bottom:8px" class="css-1qp0zyo evhx4tm0" href="/tags/azure-sentinel">azure-sentinel</a><a style="margin-top:4px;margin-bottom:8px" class="css-1qp0zyo evhx4tm0" href="/tags/sumo-logic">sumo-logic</a><style data-emotion-css="1f03b13">.css-1f03b13{margin-top:24px;margin-bottom:4.375rem;line-height:1.8;font-size:15px;word-break:break-all;color:rgba(26,32,44,0.88);}.css-1f03b13 .hidden{display:none;}.css-1f03b13 pre{display:block;padding:10.5px;margin:0 0 11px;font-size:13px;line-height:1.6;word-break:break-all;word-wrap:break-word;color:#4a5568;background-color:#3e4149;border:1px solid #ccc;border-radius:4px;}.css-1f03b13 pre code{padding:0;font-size:inherit;color:inherit;white-space:pre-wrap;background-color:transparent;border-radius:0;}.css-1f03b13 h1{font-size:200%;border-bottom:3px solid rgba(0,0,0,0.1);padding-bottom:10px;margin:30px 0;margin-bottom:10px;}.css-1f03b13 h1 .emoji{width:36px;height:36px;}.css-1f03b13 h1 a{color:#0a9b94;}.css-1f03b13 h1 a:hover{color:#1a202c;}.css-1f03b13 h2{font-size:160%;margin:30px 0 16px;font-weight:900;border-bottom:3px solid rgba(0,0,0,0.1);padding-bottom:4px;position:relative;}.css-1f03b13 h2:before{position:absolute;content:' ';width:100px;bottom:-3px;height:3px;background-color:#80695F;}.css-1f03b13 h2 .emoji{width:28px;height:28px;}.css-1f03b13 h2 a{color:#0a9b94;}.css-1f03b13 h2 a:hover{color:#1a202c;}.css-1f03b13 h3{margin:24px 0;margin-bottom:10px;font-size:130%;font-weight:900;}.css-1f03b13 h3 .emoji{width:22px;height:22px;}.css-1f03b13 h4{font-size:120%;font-weight:900;}.css-1f03b13 .markdown > ul,.css-1f03b13 .markdown > ol{margin:16px 0;}.css-1f03b13 ul,.css-1f03b13 ol{padding-left:40px;}.css-1f03b13 li{margin:4px 0;}.css-1f03b13 li > p{margin:0;}.css-1f03b13 dt{margin-top:14px;margin-bottom:4px;}.css-1f03b13 dd{padding:0 14px;margin-bottom:4px;}.css-1f03b13 p{margin:16px 0;}.css-1f03b13 p img{margin-bottom:0;}.css-1f03b13 blockquote{font-size:100%;color:rgba(60,74,96,0.7);border-left:5px solid rgba(0,0,0,0.1);margin-bottom:30px;padding:0 20px;}.css-1f03b13 blockquote p{margin:10px 0 !important;}.css-1f03b13 code{color:#3c4a60;white-space:pre-wrap;border-radius:4px;background-color:rgba(0,0,0,0.05);}.css-1f03b13 pre{border:none;}.css-1f03b13 pre code{background:#f6f6f6;}.css-1f03b13 a{color:#58463C;}.css-1f03b13 a:hover{color:#80695F;}.css-1f03b13 .code-block .highlight{border-radius:4px;}.css-1f03b13 .code-block__copy-button{position:absolute;top:0;right:0;display:none;background-color:white;border:1px solid rgba(0,0,0,0.1);padding:2px 7px;font-size:10px;font-family:'Source Han Mono','Lato',Emoji,Arial,'ヒラギノ角ゴPro W3','Hiragino Kaku Gothic Pro','メイリオ',Meiryo,'ＭＳ Ｐゴシック',sans-serif;}.css-1f03b13 .code-block__copy-button i{color:rgba(60,74,96,0.3);}.css-1f03b13 .code-block__copy-button:hover{background-color:#f6f6f6;border:1px solid rgba(0,0,0,0.2);}.css-1f03b13 .code-block__copy-label::after{content:'Copy';}.css-1f03b13 .code-block__copy-label.copied::after{content:'Copied';}.css-1f03b13 .code-block .highlight{position:relative;}.css-1f03b13 .code-block:hover .code-block__copy-button{display:block;}.css-1f03b13 table{border:1px solid rgba(0,0,0,0.1);width:100%;border-collapse:collapse;border-spacing:0;margin:20px 0;margin-bottom:30px;}.css-1f03b13 table tr:nth-child(odd) td{background-color:#f9f9f9;}.css-1f03b13 table tr th,.css-1f03b13 table tr td{padding:8px;line-height:1.6;vertical-align:top;border:1px solid rgba(0,0,0,0.1);}.css-1f03b13 strong{font-weight:700;}.css-1f03b13 img{max-width:100%;border:1px solid #eee;border-radius:4px;}.css-1f03b13 .anchor{-webkit-transition-duration:0;transition-duration:0;display:none;margin-left:-20px;width:20px;height:20px;font-size:20px;text-align:right;padding-top:8px;}.css-1f03b13 .anchor i:hover{color:#08837d;}.css-1f03b13 .anchor .fa-pencil{-webkit-transform:rotateY(180deg);-webkit-transform:rotateY(180deg);-ms-transform:rotateY(180deg);transform:rotateY(180deg);}.css-1f03b13 h1,.css-1f03b13 h2,.css-1f03b13 h3,.css-1f03b13 h4{-webkit-font-smoothing:antialiased;}.css-1f03b13 h1:hover .anchor,.css-1f03b13 h2:hover .anchor,.css-1f03b13 h3:hover .anchor{display:inline-block;}.css-1f03b13 h2 .anchor{padding-top:5px;font-size:18px;}.css-1f03b13 h2 .anchor i{top:4px;}.css-1f03b13 h3 .anchor{padding-top:3px;font-size:15px;}.css-1f03b13 h3 .anchor i{top:4px;}.css-1f03b13 .emoji{border:none;height:19px;width:19px;}.css-1f03b13 iframe{max-width:100%;}.css-1f03b13 hr{border-top-color:rgba(33,37,41,0.12);display:block;border-top-width:1px;border-top-style:solid;margin:32px 0;}.css-1f03b13 .code-filename{border-top-left-radius:4px;border-top-right-radius:4px;position:relative;top:auto;right:auto;bottom:auto;left:auto;top:4px;display:inline-block;padding:3px 10px;background-color:#3e4149;color:#fff;font-size:85%;line-height:1.5;margin-bottom:-10px;}.css-1f03b13 .code-filename i{color:rgba(60,74,96,0.3);}@media (max-width:900px){.css-1f03b13 video{width:100%;}}.css-1f03b13 .highlight code table td{padding:5px;}.css-1f03b13 .highlight code table pre{margin:0;}.css-1f03b13 .highlight code .c,.css-1f03b13 .highlight code .cd{color:#75715e;font-style:italic;}.css-1f03b13 .highlight code .cm{color:#75715e;font-style:italic;}.css-1f03b13 .highlight code .c1{color:#75715e;font-style:italic;}.css-1f03b13 .highlight code .cp{color:#75715e;font-weight:bold;}.css-1f03b13 .highlight code .cs{color:#75715e;font-weight:bold;font-style:italic;}.css-1f03b13 .highlight code .err{color:#960050;background-color:#1e0010;}.css-1f03b13 .highlight code .gi{color:#ffffff;background-color:#324932;}.css-1f03b13 .highlight code .gd{color:#ffffff;background-color:#493131;}.css-1f03b13 .highlight code .ge{color:#000000;font-style:italic;}.css-1f03b13 .highlight code .gr{color:#aa0000;}.css-1f03b13 .highlight code .gt{color:#aa0000;}.css-1f03b13 .highlight code .gh{color:#999999;}.css-1f03b13 .highlight code .go{color:#888888;}.css-1f03b13 .highlight code .gp{color:#555555;}.css-1f03b13 .highlight code .gs{font-weight:bold;}.css-1f03b13 .highlight code .gu{color:#aaaaaa;}.css-1f03b13 .highlight code .k,.css-1f03b13 .highlight code .kv{color:#66d9ef;font-weight:bold;}.css-1f03b13 .highlight code .kc{color:#66d9ef;font-weight:bold;}.css-1f03b13 .highlight code .kd{color:#66d9ef;font-weight:bold;}.css-1f03b13 .highlight code .kp{color:#66d9ef;font-weight:bold;}.css-1f03b13 .highlight code .kr{color:#66d9ef;font-weight:bold;}.css-1f03b13 .highlight code .kt{color:#66d9ef;font-weight:bold;}.css-1f03b13 .highlight code .kn{color:#f92672;font-weight:bold;}.css-1f03b13 .highlight code .ow{color:#f92672;font-weight:bold;}.css-1f03b13 .highlight code .o{color:#f92672;font-weight:bold;}.css-1f03b13 .highlight code .mf{color:#ae81ff;}.css-1f03b13 .highlight code .mh{color:#ae81ff;}.css-1f03b13 .highlight code .il{color:#ae81ff;}.css-1f03b13 .highlight code .mi{color:#ae81ff;}.css-1f03b13 .highlight code .mo{color:#ae81ff;}.css-1f03b13 .highlight code .m,.css-1f03b13 .highlight code .mb,.css-1f03b13 .highlight code .mx{color:#ae81ff;}.css-1f03b13 .highlight code .se{color:#ae81ff;}.css-1f03b13 .highlight code .sb{color:#e6db74;}.css-1f03b13 .highlight code .sc{color:#e6db74;}.css-1f03b13 .highlight code .sd{color:#e6db74;}.css-1f03b13 .highlight code .s2{color:#e6db74;}.css-1f03b13 .highlight code .sh{color:#e6db74;}.css-1f03b13 .highlight code .si{color:#e6db74;}.css-1f03b13 .highlight code .sx{color:#e6db74;}.css-1f03b13 .highlight code .sr{color:#e6db74;}.css-1f03b13 .highlight code .s1{color:#e6db74;}.css-1f03b13 .highlight code .ss{color:#e6db74;}.css-1f03b13 .highlight code .s{color:#e6db74;}.css-1f03b13 .highlight code .na{color:#a6e22e;}.css-1f03b13 .highlight code .nc{color:#a6e22e;font-weight:bold;}.css-1f03b13 .highlight code .nd{color:#a6e22e;font-weight:bold;}.css-1f03b13 .highlight code .ne{color:#a6e22e;font-weight:bold;}.css-1f03b13 .highlight code .nf{color:#a6e22e;font-weight:bold;}.css-1f03b13 .highlight code .no{color:#66d9ef;}.css-1f03b13 .highlight code .bp{color:#f8f8f2;}.css-1f03b13 .highlight code .nb{color:#f8f8f2;}.css-1f03b13 .highlight code .ni{color:#f8f8f2;}.css-1f03b13 .highlight code .nn{color:#f8f8f2;}.css-1f03b13 .highlight code .vc{color:#f8f8f2;}.css-1f03b13 .highlight code .vg{color:#f8f8f2;}.css-1f03b13 .highlight code .vi{color:#f8f8f2;}.css-1f03b13 .highlight code .nv{color:#f8f8f2;}.css-1f03b13 .highlight code .w{color:#f8f8f2;}.css-1f03b13 .highlight code .nl{color:#f8f8f2;font-weight:bold;}.css-1f03b13 .highlight code .nt{color:#f92672;}.css-1f03b13 .highlight code{color:#f8f8f2;background-color:#3e4149;}.css-1f03b13 h1,.css-1f03b13 h2,.css-1f03b13 h3,.css-1f03b13 h4,.css-1f03b13 h5,.css-1f03b13 h6{font-weight:700;}.css-1f03b13 .footnotes{margin-top:4.375rem;padding:20px 0;background-color:#efefef;}</style><div class="css-1f03b13 e1a9pvvr0"><p data-sourcepos="1:1-1:243">IT統制において証跡管理の充実という観点から、また、ゼロトラストの強化という観点からSIEMの導入が必要になってきました。今回はAWS CloudTrail用のSIEMについてざっと調べました。</p>
<a href="https://img.esa.io/uploads/production/attachments/16651/2021/08/15/97367/649a1db9-aa36-4be6-846b-bb34d1e1eb31.png" target="_blank" rel="noopener noreferrer"><img width="681" alt="thumbnail" src="https://img.esa.io/uploads/production/attachments/16651/2021/08/15/97367/649a1db9-aa36-4be6-846b-bb34d1e1eb31.png"></a>
<h1 data-sourcepos="5:1-5:9" id="1-0-0" name="1-0-0"><a class="anchor" id="PROBLEM" name="PROBLEM" href="#PROBLEM" data-position="1-0-0"><i class="fa fa-link"></i><span class="hidden" data-text="PROBLEM"> &gt; PROBLEM</span></a>PROBLEM</h1>
<ul data-sourcepos="6:1-10:0">
<li data-sourcepos="6:1-10:0">AWS CloudTrailのログをセキュリティアカウントに集約しているが、深く監視しきれていない
<ul data-sourcepos="7:5-10:0">
<li data-sourcepos="7:5-7:99">可能ならアカウントが不審な操作をした場合にアラートを飛ばしたい</li>
<li data-sourcepos="8:5-10:0">可能ならCloudTrail以外のIaaSリソースを監視対象にしたい
<ul data-sourcepos="9:9-10:0">
<li data-sourcepos="9:9-10:0">NewRelicのように人のコストをかけずに管理したい</li>
</ul></li>
</ul></li>
</ul>
<h1 data-sourcepos="11:1-11:10" id="2-0-0" name="2-0-0"><a class="anchor" id="SOLUTION" name="SOLUTION" href="#SOLUTION" data-position="2-0-0"><i class="fa fa-link"></i><span class="hidden" data-text="SOLUTION"> &gt; SOLUTION</span></a>SOLUTION</h1>
<p data-sourcepos="12:1-12:102">と言うわけで、コスパが良いと噂のSumo LogicとAzure Sentinelを比較評価します。</p>
<h2 data-sourcepos="14:1-14:17" id="2-1-0" name="2-1-0"><a class="anchor" id="Azure Sentinel" name="Azure Sentinel" href="#Azure Sentinel" data-position="2-1-0"><i class="fa fa-link"></i><span class="hidden" data-text="Azure Sentinel"> &gt; Azure Sentinel</span></a>Azure Sentinel</h2>
<h3 data-sourcepos="15:1-15:10" id="2-1-1" name="2-1-1"><a class="anchor" id="料金" name="料金" href="#料金" data-position="2-1-1"><i class="fa fa-link"></i><span class="hidden" data-text="料金"> &gt; 料金</span></a>料金</h3>
<ul data-sourcepos="16:1-18:0">
<li data-sourcepos="16:1-16:113"><a href="https://azure.microsoft.com/ja-jp/pricing/details/azure-sentinel/" target="_blank" rel="noopener noreferrer">Azure Sentinel の価格 | Microsoft Azure</a></li>
<li data-sourcepos="17:1-18:0"><a href="https://azure.microsoft.com/ja-jp/pricing/details/monitor/" target="_blank" rel="noopener noreferrer">価格 - Azure Monitor | Microsoft Azure</a></li>
</ul>
<h3 data-sourcepos="19:1-19:42" id="2-1-2" name="2-1-2"><a class="anchor" id="SIEMからCloudTrailへの接続方法" name="SIEMからCloudTrailへの接続方法" href="#SIEMからCloudTrailへの接続方法" data-position="2-1-2"><i class="fa fa-link"></i><span class="hidden" data-text="SIEMからCloudTrailへの接続方法"> &gt; SIEMからCloudTrailへの接続方法</span></a>SIEMからCloudTrailへの接続方法</h3>
<ol data-sourcepos="20:1-37:0">
<li data-sourcepos="20:1-24:24">下記設定でLog Analyticsワークスペースを作成
<ul data-sourcepos="21:5-24:24">
<li data-sourcepos="21:5-21:51">サブスクリプション <code>無料試用版</code></li>
<li data-sourcepos="22:5-22:44">リソース グループ <code>production</code></li>
<li data-sourcepos="23:5-23:28">名前 <code>prod-sentinel</code></li>
<li data-sourcepos="24:5-24:24">地域 <code>東日本</code></li>
</ul>
</li>
<li data-sourcepos="25:1-25:141"><code>[ワークスペースprod-sentinel - データコネクタ]</code> にて <code>[アマゾンウェブサービス]</code> コネクタページを開く</li>
<li data-sourcepos="26:1-37:0"><code>[AWSアカウント - IAM - ロール]</code> にて下記設定で <code>[別のAWSアカウント]</code> を作成
<ul data-sourcepos="27:5-37:0">
<li data-sourcepos="27:5-27:48">アカウントID <code>{Microsoft account ID}</code></li>
<li data-sourcepos="28:5-30:57">オプション
<ul data-sourcepos="29:9-30:57">
<li data-sourcepos="29:9-29:45"><code>外部IDが必要</code> をチェック</li>
<li data-sourcepos="30:9-30:57">外部ID <code>{外部ID (ワークスペースID)}</code></li>
</ul></li>
<li data-sourcepos="31:5-31:78">パーミッションポリシーを適用 <code>AWSCloudTrailReadOnlyAccess</code></li>
<li data-sourcepos="32:5-32:34">ロール名 <code>AzureSentinel</code></li>
<li data-sourcepos="33:5-37:0">※ Cf.
<ul data-sourcepos="34:9-37:0">
<li data-sourcepos="34:9-34:139"><a href="https://docs.microsoft.com/ja-jp/azure/sentinel/connect-aws" target="_blank" rel="noopener noreferrer">AWS CloudTrail を Azure Sentinel に接続する | Microsoft Docs</a></li>
<li data-sourcepos="35:9-35:240"><a href="https://docs.microsoft.com/ja-jp/azure/architecture/reference-architectures/aws/aws-azure-security-solutions" target="_blank" rel="noopener noreferrer">アマゾン ウェブ サービス (AWS) のための MCAS と Azure Sentinel - Azure Solution Ideas | Microsoft Docs</a></li>
<li data-sourcepos="36:9-37:0"><a href="https://dev.classmethod.jp/articles/security-jaws-21-report/" target="_blank" rel="noopener noreferrer">Security-JAWS 第21回レポート #secjaws #secjaws21 #jawsug | DevelopersIO</a></li>
</ul></li>
</ul>
</li>
</ol>
<h3 data-sourcepos="38:1-38:31" id="2-1-3" name="2-1-3"><a class="anchor" id="SIEM機能 (AWS CloudTrail)" name="SIEM機能 (AWS CloudTrail)" href="#SIEM機能 (AWS CloudTrail)" data-position="2-1-3"><i class="fa fa-link"></i><span class="hidden" data-text="SIEM機能 (AWS CloudTrail)"> &gt; SIEM機能 (AWS CloudTrail)</span></a>SIEM機能 (AWS CloudTrail)</h3>
<ul data-sourcepos="39:1-65:0">
<li data-sourcepos="39:1-43:33">デフォルト監視対象
<ul data-sourcepos="40:5-43:33">
<li data-sourcepos="40:5-40:51">時間経過に伴うイベントアラート</li>
<li data-sourcepos="41:5-41:48">悪意ある可能性があるイベント</li>
<li data-sourcepos="42:5-42:33">最近のインシデント</li>
<li data-sourcepos="43:5-43:33">データソースの異常</li>
</ul></li>
<li data-sourcepos="44:1-47:14">ログクエリ
<ul data-sourcepos="45:5-47:14">
<li data-sourcepos="45:5-45:11">Audit</li>
<li data-sourcepos="46:5-46:13">Network</li>
<li data-sourcepos="47:5-47:14">Security</li>
</ul></li>
<li data-sourcepos="48:1-61:69">脅威管理
<ul data-sourcepos="49:5-61:69">
<li data-sourcepos="49:5-49:24">インシデント</li>
<li data-sourcepos="50:5-52:364">ブック ... 簡易な分析情報を提供
<ul data-sourcepos="51:9-52:364">
<li data-sourcepos="51:9-51:263">AWSネットワークアクティビティ ... SG、ネットワークACL、IGW、ELB、VPC、サブネット、NIの作成・更新・削除など、AWS ネットワーク関連のリソースアクティビティに関する分析情報を得ます。</li>
<li data-sourcepos="52:9-52:364">AWSユーザーアクティビティ ... 失敗したサインイン試行、IP アドレス、リージョン、ユーザー エージェント、ID の種類、また想定されたロールを持つ悪意のある可能性があるユーザー アクティビティなど、AWS ユーザー アクティビティに関する分析情報を得ます。</li>
</ul></li>
<li data-sourcepos="53:5-60:45">ハンティング ... 脅威判定となるログクエリを提供
<ul data-sourcepos="54:9-60:45">
<li data-sourcepos="54:9-54:40">Changes made to AWS IAM policy</li>
<li data-sourcepos="55:9-55:51">Tracking Privileged Account Rare Activity</li>
<li data-sourcepos="56:9-56:50">Exploit and Pentest Framework User Agent</li>
<li data-sourcepos="57:9-57:65">IAM Privilege Escalation by Instance Profile attachment</li>
<li data-sourcepos="58:9-58:46">Privileged role attached to Instance</li>
<li data-sourcepos="59:9-59:63">Suspicious credential token access of valid IAM Roles</li>
<li data-sourcepos="60:9-60:45">Unused or Unsupported Cloud Regions</li>
</ul></li>
<li data-sourcepos="61:5-61:69">ノートブック ... Jupyter Notebookによる分析を提供</li>
</ul></li>
<li data-sourcepos="62:1-65:0">ソリューション ... 外部のエンドポイントセキュリティツールと連携することが可能
<ul data-sourcepos="63:5-65:0">
<li data-sourcepos="63:5-63:26">Trend Micro Apex One</li>
<li data-sourcepos="64:5-65:0">McAfee Network Security Platform</li>
</ul></li>
</ul>
<h2 data-sourcepos="66:1-66:13" id="2-2-0" name="2-2-0"><a class="anchor" id="Sumo Logic" name="Sumo Logic" href="#Sumo Logic" data-position="2-2-0"><i class="fa fa-link"></i><span class="hidden" data-text="Sumo Logic"> &gt; Sumo Logic</span></a>Sumo Logic</h2>
<h3 data-sourcepos="67:1-67:10" id="2-2-1" name="2-2-1"><a class="anchor" id="料金-1" name="料金-1" href="#料金-1" data-position="2-2-1"><i class="fa fa-link"></i><span class="hidden" data-text="料金"> &gt; 料金</span></a>料金</h3>
<ul data-sourcepos="68:1-69:0">
<li data-sourcepos="68:1-69:0"><a href="https://www.sumologic.jp/pricing/jp/" target="_blank" rel="noopener noreferrer">Sumo Logic 料金表</a></li>
</ul>
<h3 data-sourcepos="70:1-70:42" id="2-2-2" name="2-2-2"><a class="anchor" id="SIEMからCloudTrailへの接続方法-1" name="SIEMからCloudTrailへの接続方法-1" href="#SIEMからCloudTrailへの接続方法-1" data-position="2-2-2"><i class="fa fa-link"></i><span class="hidden" data-text="SIEMからCloudTrailへの接続方法"> &gt; SIEMからCloudTrailへの接続方法</span></a>SIEMからCloudTrailへの接続方法</h3>
<ol data-sourcepos="71:1-229:0">
<li data-sourcepos="71:1-105:18"><code>[AWSアカウントSecurity - S3]</code> にてバケット <code>cloudtrail-accumulativelogs-{account-id}</code> を下記設定にて作成
<ul data-sourcepos="72:5-105:18">
<li data-sourcepos="72:5-72:66"><p data-sourcepos="72:7-72:66">パブリックアクセスをすべてブロック <code>オフ</code></p></li>
<li data-sourcepos="73:5-105:18"><details><summary>バケットポリシー</summary>
<div class="code-block" data-sourcepos="75:9-104:11"><div class="code-filename"><i class="fa fa-file-code-o"></i>json</div><div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AWSCloudTrailAclCheck20150319"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"Service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cloudtrail.amazonaws.com"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:GetBucketAcl"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::cloudtrail-accumulativelogs-{account-id}"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"AWSCloudTrailWrite20150319"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"Service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cloudtrail.amazonaws.com"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"s3:PutObject"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:s3:::cloudtrail-accumulativelogs-{account-id}/AWSLogs/{organization-id}/*"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"StringEquals"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"s3:x-amz-acl"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bucket-owner-full-control"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
  </details></li>
</ul>
</li>
<li data-sourcepos="106:1-208:18"><code>[親AWSアカウント - KMS]</code> にて下記設定でKSMを作成
<ul data-sourcepos="107:5-208:18">
<li data-sourcepos="107:5-107:33"><p data-sourcepos="107:7-107:33">キーのタイプ <code>対称</code></p></li>
<li data-sourcepos="108:5-108:45"><p data-sourcepos="108:7-108:45">キーマテリアルオリジン <code>KMS</code></p></li>
<li data-sourcepos="109:5-109:51"><p data-sourcepos="109:7-109:51">リージョンごと <code>単一リージョン</code></p></li>
<li data-sourcepos="110:5-110:41"><p data-sourcepos="110:7-110:41">エイリアス名 <code>cloudtrail-kms</code></p></li>
<li data-sourcepos="111:5-208:18"><details><summary>キーポリシー</summary>
<div class="code-block" data-sourcepos="113:9-207:11"><div class="code-filename"><i class="fa fa-file-code-o"></i>json</div><div class="highlight"><pre class="highlight json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"Version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2012-10-17"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Key policy created by CloudTrail"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"Statement"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Enable IAM User Permissions"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kms:*"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow CloudTrail to encrypt logs"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"Service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cloudtrail.amazonaws.com"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kms:GenerateDataKey*"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"StringLike"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"kms:EncryptionContext:aws:cloudtrail:arn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:cloudtrail:*:{account-id}:trail/*"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow CloudTrail to describe key"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"Service"</span><span class="p">:</span><span class="w"> </span><span class="s2">"cloudtrail.amazonaws.com"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kms:DescribeKey"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow principals in the account to decrypt log files"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"kms:Decrypt"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"kms:ReEncryptFrom"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"StringEquals"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"kms:CallerAccount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{account-id}"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"StringLike"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"kms:EncryptionContext:aws:cloudtrail:arn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:cloudtrail:*:{account-id}:trail/*"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow alias creation during setup"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="s2">"kms:CreateAlias"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"StringEquals"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"kms:CallerAccount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{account-id}"</span><span class="p">,</span><span class="w">
                    </span><span class="nl">"kms:ViaService"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ec2.ap-northeast-1.amazonaws.com"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"Sid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Enable cross account log decryption"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Effect"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Allow"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Principal"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"AWS"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"Action"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
                </span><span class="s2">"kms:Decrypt"</span><span class="p">,</span><span class="w">
                </span><span class="s2">"kms:ReEncryptFrom"</span><span class="w">
            </span><span class="p">],</span><span class="w">
            </span><span class="nl">"Resource"</span><span class="p">:</span><span class="w"> </span><span class="s2">"*"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"Condition"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"StringEquals"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"kms:CallerAccount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"{account-id}"</span><span class="w">
                </span><span class="p">},</span><span class="w">
                </span><span class="nl">"StringLike"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                    </span><span class="nl">"kms:EncryptionContext:aws:cloudtrail:arn"</span><span class="p">:</span><span class="w"> </span><span class="s2">"arn:aws:cloudtrail:*:{account-id}:trail/*"</span><span class="w">
                </span><span class="p">}</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>
  </details></li>
</ul>
</li>
<li data-sourcepos="209:1-220:46"><code>[親AWSアカウント - CloudTrail]</code> にて下記設定で証跡を作成
<ul data-sourcepos="210:5-220:46">
<li data-sourcepos="210:5-218:46">全般的な詳細
<ul data-sourcepos="211:9-218:46">
<li data-sourcepos="211:9-211:37">証跡名 <code>cloudtrail-logs</code></li>
<li data-sourcepos="212:9-212:43">組織に証跡を適用 <code>はい</code></li>
<li data-sourcepos="213:9-213:75">ストレージの場所 <code>既存のS3バケットを使用する</code></li>
<li data-sourcepos="214:9-214:80">証跡ログバケット名 <code>cloudtrail-accumulativelogs-{account-id}</code></li>
<li data-sourcepos="215:9-215:56">ログファイルのSSE-KMS暗号化 <code>有効</code></li>
<li data-sourcepos="216:9-216:56">カスタマー管理のAWS KMSキー <code>新規</code></li>
<li data-sourcepos="217:9-217:81">AWS KMSエイリアス <code>arn:aws:kms:{region}:{account-id}:key/{kms-id}</code></li>
<li data-sourcepos="218:9-218:46">ログファイルの検証 <code>有効</code></li>
</ul></li>
<li data-sourcepos="219:5-220:46">管理イベント
<ul data-sourcepos="220:9-220:46">
<li data-sourcepos="220:9-220:46">APIアクティビティ <code>すべて</code></li>
</ul></li>
</ul>
</li>
<li data-sourcepos="221:1-229:0"><code>[Sumo Logic - Setup Wizard - Start streaming data to Sumo Logic - CloudTrail]</code> にて下記設定でCloudTrailデータタイプを作成
<ul data-sourcepos="222:5-229:0">
<li data-sourcepos="222:5-222:38">Source Category <code>aws/cloudtrail</code></li>
<li data-sourcepos="223:5-229:0">S3 Bucket
<ul data-sourcepos="224:9-229:0">
<li data-sourcepos="224:9-224:67">S3 Bucket Name <code>cloudtrail-accumulativelogs-{account-id}</code></li>
<li data-sourcepos="225:9-225:55">Path Expression <code>AWSLogs/{organization-id}/*</code></li>
<li data-sourcepos="226:9-226:42">S3 Region <code>Asia Pacific (Tokyo)</code></li>
<li data-sourcepos="227:9-229:0">How do you want the user to access the S3 Bucket? <code>Role-based access</code><ul data-sourcepos="228:13-229:0">
<li data-sourcepos="228:13-229:0">指定されたCFnテンプレートでIAMロールを作成</li>
</ul></li>
</ul></li>
</ul>
</li>
</ol>
<h3 data-sourcepos="230:1-230:31" id="2-2-3" name="2-2-3"><a class="anchor" id="SIEM機能 (AWS CloudTrail)-1" name="SIEM機能 (AWS CloudTrail)-1" href="#SIEM機能 (AWS CloudTrail)-1" data-position="2-2-3"><i class="fa fa-link"></i><span class="hidden" data-text="SIEM機能 (AWS CloudTrail)"> &gt; SIEM機能 (AWS CloudTrail)</span></a>SIEM機能 (AWS CloudTrail)</h3>
<p data-sourcepos="231:1-231:27">デフォルト監視対象</p>
<ul data-sourcepos="232:1-281:0">
<li data-sourcepos="232:1-241:24">Console Logins
<ul data-sourcepos="233:5-241:24">
<li data-sourcepos="233:5-233:31">Geo Location of All Users</li>
<li data-sourcepos="234:5-234:26">Login Events By User</li>
<li data-sourcepos="235:5-235:22">Logins Over Time</li>
<li data-sourcepos="236:5-236:29">Logins from Multiple IP</li>
<li data-sourcepos="237:5-237:33">Logins from Outside the USA</li>
<li data-sourcepos="238:5-238:29">Outlier - Success Login</li>
<li data-sourcepos="239:5-239:28">Outlier - Failed Login</li>
<li data-sourcepos="240:5-240:45">Login Results - One Day Time Comparison</li>
<li data-sourcepos="241:5-241:24">Logins without MFA</li>
</ul></li>
<li data-sourcepos="242:1-250:37">Network and Security
<ul data-sourcepos="243:5-250:37">
<li data-sourcepos="243:5-243:47">Authorization Failures from All Countries</li>
<li data-sourcepos="244:5-244:43">Network and Security Events Over Time</li>
<li data-sourcepos="245:5-245:38">Authorization Failures Over Time</li>
<li data-sourcepos="246:5-246:49">Network ACL with All Allowed Ingress/Egress</li>
<li data-sourcepos="247:5-247:35">Recent Authorization Failures</li>
<li data-sourcepos="248:5-248:51">Recent Security Group and Network ACL Changes</li>
<li data-sourcepos="249:5-249:54">Created and Deleted Network  and Security Events</li>
<li data-sourcepos="250:5-250:37">Short Lived Critical Operations</li>
</ul></li>
<li data-sourcepos="251:1-257:33">Operations
<ul data-sourcepos="252:5-257:33">
<li data-sourcepos="252:5-252:19">Action Events</li>
<li data-sourcepos="253:5-253:38">Requested AWS Services Over Time</li>
<li data-sourcepos="254:5-254:26">Events by AWS Region</li>
<li data-sourcepos="255:5-255:42">Recent Elastic IP Address Operations</li>
<li data-sourcepos="256:5-256:33">Created Resources Over Time</li>
<li data-sourcepos="257:5-257:33">Deleted Resources Over Time</li>
</ul></li>
<li data-sourcepos="258:1-264:53">Overview
<ul data-sourcepos="259:5-264:53">
<li data-sourcepos="259:5-259:31">Geo Location of All Users</li>
<li data-sourcepos="260:5-260:23">Created Resources</li>
<li data-sourcepos="261:5-261:33">Deleted Resources Over Time</li>
<li data-sourcepos="262:5-262:18">Top 10 Users</li>
<li data-sourcepos="263:5-263:19">Failed Logins</li>
<li data-sourcepos="264:5-264:53">Created and Deleted Network and Security Events</li>
</ul></li>
<li data-sourcepos="265:1-273:35">S3 Public Objects and Buckets
<ul data-sourcepos="266:5-273:35">
<li data-sourcepos="266:5-266:24">New Public Objects</li>
<li data-sourcepos="267:5-267:40">New Public Object by Object-Bucket</li>
<li data-sourcepos="268:5-268:30">New Public Objects Table</li>
<li data-sourcepos="269:5-269:20">Public Buckets</li>
<li data-sourcepos="270:5-270:26">Public Buckets Table</li>
<li data-sourcepos="271:5-271:29">Modified Public Objects</li>
<li data-sourcepos="272:5-272:45">Modified Public Objects by Object-Buket</li>
<li data-sourcepos="273:5-273:35">Modified Public Objects Table</li>
</ul></li>
<li data-sourcepos="274:1-281:0">User Monitoring
<ul data-sourcepos="275:5-281:0">
<li data-sourcepos="275:5-275:31">Geo Location of All Users</li>
<li data-sourcepos="276:5-276:18">Top 10 Users</li>
<li data-sourcepos="277:5-277:47">Launched and Terminated Instances by User</li>
<li data-sourcepos="278:5-278:41">Administrative Activities Over Time</li>
<li data-sourcepos="279:5-279:46">Top 10 Activities by Administrative User</li>
<li data-sourcepos="280:5-281:0">Recent Activity by Administrative Users</li>
</ul></li>
</ul>
<h1 data-sourcepos="282:1-282:8" id="3-0-0" name="3-0-0"><a class="anchor" id="総評" name="総評" href="#総評" data-position="3-0-0"><i class="fa fa-link"></i><span class="hidden" data-text="総評"> &gt; 総評</span></a>総評</h1>
<h2 data-sourcepos="283:1-283:18" id="3-1-0" name="3-1-0"><a class="anchor" id="使用コスト" name="使用コスト" href="#使用コスト" data-position="3-1-0"><i class="fa fa-link"></i><span class="hidden" data-text="使用コスト"> &gt; 使用コスト</span></a>使用コスト</h2>
<p data-sourcepos="284:1-284:102">初期導入の段階ではSumo LogicよりAzure Sentinelの方が倍のコストがかかります。</p>
<table data-sourcepos="286:1-290:30">
<thead>
<tr data-sourcepos="286:1-286:65">
<th data-sourcepos="286:2-286:22">ログ取込量/日</th>
<th data-sourcepos="286:24-286:45">Azure Sentinel月額</th>
<th data-sourcepos="286:47-286:64">Sumo Logic月額</th>
</tr>
</thead>
<tbody>
<tr data-sourcepos="288:1-288:29">
<td data-sourcepos="288:2-288:8">100MB</td>
<td data-sourcepos="288:10-288:20">2,396 JPY</td>
<td data-sourcepos="288:22-288:28">0 USD</td>
</tr>
<tr data-sourcepos="289:1-289:30">
<td data-sourcepos="289:2-289:8">500MB</td>
<td data-sourcepos="289:10-289:21">11,978 JPY</td>
<td data-sourcepos="289:23-289:29">0 USD</td>
</tr>
<tr data-sourcepos="290:1-290:30">
<td data-sourcepos="290:2-290:6">3GB</td>
<td data-sourcepos="290:8-290:19">71,870 JPY</td>
<td data-sourcepos="290:21-290:29">332 USD</td>
</tr>
</tbody>
</table>
<p data-sourcepos="292:1-292:153">※ Azure Sentinelの内訳は「 <code>((GB当たりのAzure Sentinel取込量347.20円) + (GB当たりのLog Analytics取込量451.36円) * 取込量GB</code> 」</p>
<h2 data-sourcepos="294:1-294:18" id="3-2-0" name="3-2-0"><a class="anchor" id="導入コスト" name="導入コスト" href="#導入コスト" data-position="3-2-0"><i class="fa fa-link"></i><span class="hidden" data-text="導入コスト"> &gt; 導入コスト</span></a>導入コスト</h2>
<p data-sourcepos="295:1-295:249">一度の設定で完了するSumo Logicの方が導入コストが低いです。Azure SentinelはIAMロールのみで済むという点で導入は楽ですがAWSアカウントごとに設定する必要があるので手離れが悪いです。</p>
<h2 data-sourcepos="297:1-297:13" id="3-3-0" name="3-3-0"><a class="anchor" id="SIEM機能" name="SIEM機能" href="#SIEM機能" data-position="3-3-0"><i class="fa fa-link"></i><span class="hidden" data-text="SIEM機能"> &gt; SIEM機能</span></a>SIEM機能</h2>
<p data-sourcepos="298:1-298:558">Azure Sentinelの方が分析機能が充実しています。Sumo Logicが大まかな脅威をログクエリからしか拾えないのに対し、Azure Sentinelは細かな脅威判定をログクエリで提供しているのに加え、Jupyter Notebookや外部のエンドポイントセキュリティツールを提供しています。また、デフォルトの監視対象も時間経過に伴うイベントアラート、悪意ある可能性があるイベント、最近のインシデント等必要十分な情報を提供しています。</p>
<p data-sourcepos="300:1-300:267">また、対象のデータソースはAzure SentinelがAWS CloudTrail、Google Workspace、Office 365、Azure AD等と幅広く用意しているのに対し、Sumo LogicはSIEMという観点では実質AWS CloudTrail専用のツールに落ち着いています。</p>
<h1 data-sourcepos="302:1-302:8" id="4-0-0" name="4-0-0"><a class="anchor" id="WRAPUP" name="WRAPUP" href="#WRAPUP" data-position="4-0-0"><i class="fa fa-link"></i><span class="hidden" data-text="WRAPUP"> &gt; WRAPUP</span></a>WRAPUP</h1>
<p data-sourcepos="303:1-303:368">メインプロダクトがまだ2-3しかない状況でSIEMをAWSだけに限定する場合はSumo Logicで十分でしょう。使用コスト、導入コストともに低く抑えることができるので、しばらくはSumo Logicで運用し、プロダクトがスケールする段階でAzure Sentinelを移行するのが現実的だと思いました。</p>
</div><style data-emotion-css="k022ln">.css-k022ln > .heading{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;margin-bottom:4.375rem;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.css-k022ln > .heading > .avatar{height:50px;width:50;margin-right:8px;border-radius:21px;}.css-k022ln > .heading > .description > a{color:#58463C;}.css-k022ln > .heading > .description > a:hover{color:#80695F;}</style><div class="css-k022ln ewgr1al0"><div class="heading"><img class="avatar" src="https://pbs.twimg.com/profile_images/1342772423859392512/fMR9l4Sv_400x400.jpg" alt="nabinno"/><div class="description">Emacsianでアート好き、ランニング好きな@nabinnoが書いています<br/><a href="https://utagaki.com/nabinno" target="_blank" rel="noopener noreferrer">Utagaki</a> / <a href="https://github.com/nabinno" target="_blank" rel="noopener noreferrer">GitHub</a> / <a href="https://twitter.com/nabinno" target="_blank" rel="noopener noreferrer">Twitter</a> / <a href="https://linkedin.com/in/nabinno" target="_blank" rel="noopener noreferrer">LinkedIn</a> / <a href="https://www.wantedly.com/companies/nextinnovation" target="_blank" rel="noopener noreferrer">ネクイノ</a></div></div></div></div><style data-emotion-css="1r17nfx">.css-1r17nfx{box-shadow:none;color:inherit;display:block;-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-1r17nfx" href="/posts/67"><style data-emotion-css="xbv8og">.css-xbv8og{height:100%;background-color:white;border-radius:8px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;border-bottom:1px solid #eee;padding:20px 12px;}@media (min-width:624px){.css-xbv8og{padding-left:0;padding-right:0;}}.css-xbv8og:hover .title{color:#80695F;}</style><div class="css-xbv8og"><style data-emotion-css="19idom">.css-19idom{margin-bottom:8px;}</style><div class="css-19idom eff00rj1"><style data-emotion-css="lhqszh">.css-lhqszh{line-height:1.4;background-color:white;font-weight:600;display:inline-block;font-size:12px;background-image:linear-gradient( 45deg,#58463C 0px,#80695F 100% );color:white;text-transform:capitalize;-webkit-letter-spacing:0.2px;-moz-letter-spacing:0.2px;-ms-letter-spacing:0.2px;letter-spacing:0.2px;border-style:solid;border-color:rgb(221,221,221);border-image:initial;margin:0px 8px 4px 0px;padding:4px 6px;border-radius:3px;border-width:0px;}</style><div class="css-lhqszh eff00rj0">blog/frontend</div><style data-emotion-css="jsyva2">.css-jsyva2{margin-bottom:1px;font-size:18px;line-height:1.48;color:#1a202c;}</style><h3 class="title css-jsyva2 eff00rj2">esaをHeadless CMSとして使う</h3><style data-emotion-css="1p4gbp4">.css-1p4gbp4{color:#1a202c;opacity:0.6;font-size:14px;line-height:1.6;word-break:break-all;overflow-y:hidden;max-height:67.2px;}</style><p class="css-1p4gbp4 eff00rj3">最近仕事の同僚からHeadless CMS という言葉を聞いていて「自分には関係ないな」と距離を取っていたのですが、なぜか回り回って自分からHeadless CMSを作ることになりました。世の中何が起</p></div><style data-emotion-css="8xl60i">.css-8xl60i{margin-top:auto;}</style><div class="css-8xl60i eff00rj4"><style data-emotion-css="2qp2g2">.css-2qp2g2{font-size:12px;font-weight:700;color:#666;}.css-2qp2g2:after{content:' ';width:1px;height:100%;background-color:#ddd;display:inline-block;}</style><time class="css-2qp2g2 eff00rj5">2021/01/18</time><style data-emotion-css="om1c75">.css-om1c75{font-size:12px;margin-left:4px;}.css-om1c75:before{content:'#';}</style><span class="css-om1c75 eff00rj6">gatsby</span><span class="css-om1c75 eff00rj6">esa</span><span class="css-om1c75 eff00rj6">headless-cms</span><span class="css-om1c75 eff00rj6">cms</span></div></div></a><a class="css-1r17nfx" href="/posts/44"><div class="css-xbv8og"><div class="css-19idom eff00rj1"><div class="css-lhqszh eff00rj0">blog/organization</div><h3 class="title css-jsyva2 eff00rj2">整理したい私はITILをかぶる、PlantUMLへの愛</h3><p class="css-1p4gbp4 eff00rj3">現在ネクイノでエンジニアリングマネージャー、バックエンドエンジニア、インフラエンジニアを担当しています。入社後8ヶ月、年の瀬ということで振り返り記事を書くことにしました。テーマを一つに絞らないと記事に</p></div><div class="css-8xl60i eff00rj4"><time class="css-2qp2g2 eff00rj5">2020/12/30</time><span class="css-om1c75 eff00rj6">team-building</span></div></div></a><a class="css-1r17nfx" href="/posts/124"><div class="css-xbv8og"><div class="css-19idom eff00rj1"><div class="css-lhqszh eff00rj0">blog/backend</div><h3 class="title css-jsyva2 eff00rj2">Increment Pは住所のバリデーションチェックでどの程度使えるか</h3><p class="css-1p4gbp4 eff00rj3">7月に調査した「imi-enrichment-addressは住所のバリデーションチェックでどの程度使えるか」の続きになります。コロナ禍であらゆる流通がオンラインに移行する中、正しい住所を使うことはい</p></div><div class="css-8xl60i eff00rj4"><time class="css-2qp2g2 eff00rj5">2021/11/23</time><span class="css-om1c75 eff00rj6">incrementp</span></div></div></a></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script>
  
  
  if(true) {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  }
  if (typeof ga === "function") {
    ga('create', 'UA-314558-24', 'auto', {});
      
      
      
      
      
      }</script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/posts/93";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-c2af0f9bcfb46c63126b.js"],"app":["/app-1609d7d465ccd6a5a330.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-7a73fce44527957a28a5.js"],"component---src-templates-post-tsx":["/component---src-templates-post-tsx-557e62df0f80429a7567.js"],"component---src-templates-posts-tsx":["/component---src-templates-posts-tsx-01adf45b9f8003118fcd.js"]};/*]]>*/</script><script src="/polyfill-c2af0f9bcfb46c63126b.js" nomodule=""></script><script src="/component---src-templates-post-tsx-557e62df0f80429a7567.js" async=""></script><script src="/component---src-templates-posts-tsx-01adf45b9f8003118fcd.js" async=""></script><script src="/commons-d1e204551af284801370.js" async=""></script><script src="/styles-e9d24b1846c7d6eb9685.js" async=""></script><script src="/app-1609d7d465ccd6a5a330.js" async=""></script><script src="/framework-dbb498007a7447f28d8e.js" async=""></script><script src="/webpack-runtime-7a7e64c679eaacb6bc0d.js" async=""></script></body></html>