{"componentChunkName":"component---src-templates-post-tsx","path":"/posts/56","result":{"data":{"esaPost":{"number":56,"relative_category":"blog/backend","fields":{"title":"Rubyã®CSVãƒ‘ãƒ¼ã‚¹ã‚’PyCallã§å®Ÿè¡Œã™ã‚‹ï¼ˆãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ï¼‰","excerpt":"å…ˆæ—¥Rubyã‹ã‚‰Pythonã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹PyCallã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å­˜åœ¨ã‚’çŸ¥ã‚Šã€ãœã²ã¨ã‚‚ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’å–ã‚ŠãŸã„ã¨æ€ã£ãŸæ¬¡ç¬¬ã§ã™ã€‚ç¾çŠ¶Rubyã®CSVã®èª­ã¿è¾¼ã¿ã«ä¸æº€ã‚’æŒã£ã¦ãŠã‚Šã€ãã“ã‚’ã©ã†ã«ã‹è§£æ¶ˆã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚   > PROBLEMPROBLEM \n\n- å¤§é‡ã®CSVã‚’èª­ã¿è¾¼ã‚€éš›ã€æ¯å›æ™‚é–“ãŒã‹ã‹ã‚‹   > SOLUTIONSOLUTION \n\nã¨ã„ã†ã‚ã‘ã§ã€ã€ŒDalibor Nasevicã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¨˜äº‹ã€ã«PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’ãã‚ãˆã¦æ¯”è¼ƒã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚è¨˜äº‹ã§ã¯ä¸‹è¨˜ã®é€šã‚Š CSV.foreach ãŒé€Ÿã„ã¨ã®çµè«–ã§ã—ãŸã€‚    kind_of_parse time (real) memory (MB)     1. CSV.read  39.13 866.6   2. CSV.parse  36.16 936.87   3. line by line from String Object 23.39 73.42   4. line by line from IO Object 24.55 0.0   5. CSV.foreach  24.04 0.0      > PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ \n\nãã‚Œã§ã¯ã€PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’è¨ˆã‚Šã¾ã—ã‚‡ã†ã€‚ã‚³ãƒ¼ãƒ‰ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚   ruby \n\nrequire_relative './helpers' require 'pycall/import' include PyCall::Import pyimport :pandas, as: :pd print_memory_usage do print_time_spent do csv = pd.read_csv.('data.csv') sum = csv['id'].sum.() puts \"Sum: #{sum}\" end end   \n\nPyCallã¯ pyenv ã¨ã®ç›¸æ€§ãŒæ‚ªã„ã®ã§Systemã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸPythonã§ãŸãŸãã¾ã™ã€‚   sh \n\n$ PYTHON=/usr/bin/python3.4 ruby parse_6_pycall.rb Sum: 499999500000 Time: 1.49 Memory: 54.99 MB   \n\nçµæœ    kind_of_parse time (real) memory (MB)     1. CSV.read  39.13 866.6   2. CSV.parse  36.16 936.87   3. line by line from String Object 23.39 73.42   4. line by line from IO Object 24.55 0.0   5. CSV.foreach  24.04 0.0   6. PyCall 1.49 54.99    \n\nã¯ã„ã€çµæœãŒå‡ºã¾ã—ãŸã€‚Daliborã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¨˜äº‹ã§ä¸€ç•ªé€Ÿã‹ã£ãŸ CSV.foreach ã‚ˆã‚Š16å€ã®å®Ÿè¡Œé€Ÿåº¦ã¨ãªã‚Šã¾ã—ãŸã€‚   > WRAPUPWRAPUP \n\nPyCallã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ PyObjectã¨ActiveRecordã¨ç›¸æ€§ãŒæ‚ªãã†ãªã®ã¨ã€Pythonã¨RubyåŒæ–¹ã®ãƒ¡ãƒ¢ãƒªãƒ¼ç®¡ç†ãŒé‹ç”¨ã‚’é›£ã—ãã™ã‚‹ã“ã¨ã‹ã‚‰ã€å®‰æ˜“ã«æœ¬ç•ªç’°å¢ƒã®Railsã«å°å…¥ã™ã‚‹ã®ã¯å³ã—ã„ã¨æ€ã„ã¾ã™ã€‚ \n\nãŸã ã—ã€å®Ÿè¡Œå›æ•°ãŒé™å®šã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã‚‰ç©æ¥µçš„ã«ä½¿ã£ã¦è‰¯ã„ã§ã—ã‚‡ã†ã€‚","thumbnail":"https://img.esa.io/uploads/production/attachments/16651/2021/01/11/97367/180665c6-7370-4579-8340-7be6254834e8.png"},"wip":false,"body_md":"<img width=\"1920\" alt=\"thumbnail\" src=\"https://img.esa.io/uploads/production/attachments/16651/2021/01/11/97367/180665c6-7370-4579-8340-7be6254834e8.png\">\r\n\r\nå…ˆæ—¥Rubyã‹ã‚‰Pythonã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹PyCallã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å­˜åœ¨ã‚’çŸ¥ã‚Šã€ãœã²ã¨ã‚‚ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’å–ã‚ŠãŸã„ã¨æ€ã£ãŸæ¬¡ç¬¬ã§ã™ã€‚ç¾çŠ¶Rubyã®CSVã®èª­ã¿è¾¼ã¿ã«ä¸æº€ã‚’æŒã£ã¦ãŠã‚Šã€ãã“ã‚’ã©ã†ã«ã‹è§£æ¶ˆã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚\r\n\r\n# PROBLEM\r\n- å¤§é‡ã®CSVã‚’èª­ã¿è¾¼ã‚€éš›ã€æ¯å›æ™‚é–“ãŒã‹ã‹ã‚‹\r\n\r\n# SOLUTION\r\nã¨ã„ã†ã‚ã‘ã§ã€ã€Œ[Dalibor Nasevicã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¨˜äº‹](https://dalibornasevic.com/posts/68-processing-large-csv-files-with-ruby)ã€ã«PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’ãã‚ãˆã¦æ¯”è¼ƒã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚è¨˜äº‹ã§ã¯ä¸‹è¨˜ã®é€šã‚Š `CSV.foreach` ãŒé€Ÿã„ã¨ã®çµè«–ã§ã—ãŸã€‚\r\n\r\n| kind_of_parse                      | time (real) | memory (MB) |\r\n|------------------------------------|-------------|-------------|\r\n| 1. `CSV.read`                      |       39.13 |       866.6 |\r\n| 2. `CSV.parse`                     |       36.16 |      936.87 |\r\n| 3. line by line from String Object |       23.39 |       73.42 |\r\n| 4. line by line from IO Object     |       24.55 |         0.0 |\r\n| 5. `CSV.foreach`                   |       24.04 |         0.0 |\r\n\r\n## PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯\r\nãã‚Œã§ã¯ã€PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’è¨ˆã‚Šã¾ã—ã‚‡ã†ã€‚ã‚³ãƒ¼ãƒ‰ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚\r\n\r\n```ruby\r\nrequire_relative './helpers'\r\nrequire 'pycall/import'\r\ninclude PyCall::Import\r\npyimport :pandas, as: :pd\r\n\r\nprint_memory_usage do\r\n  print_time_spent do\r\n    csv = pd.read_csv.('data.csv')\r\n    sum = csv['id'].sum.()\r\n    puts \"Sum: #{sum}\"\r\n  end\r\nend\r\n```\r\n\r\nPyCallã¯ `pyenv` ã¨ã®ç›¸æ€§ãŒæ‚ªã„ã®ã§Systemã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸPythonã§ãŸãŸãã¾ã™ã€‚\r\n\r\n```sh\r\n$ PYTHON=/usr/bin/python3.4 ruby parse_6_pycall.rb\r\nSum: 499999500000\r\nTime: 1.49\r\nMemory: 54.99 MB\r\n```\r\n\r\n**çµæœ**\r\n\r\n| kind_of_parse                      | time (real) | memory (MB) |\r\n|------------------------------------|-------------|-------------|\r\n| 1. `CSV.read`                      |       39.13 |       866.6 |\r\n| 2. `CSV.parse`                     |       36.16 |      936.87 |\r\n| 3. line by line from String Object |       23.39 |       73.42 |\r\n| 4. line by line from IO Object     |       24.55 |         0.0 |\r\n| 5. `CSV.foreach`                   |       24.04 |         0.0 |\r\n| 6. PyCall                          |        1.49 |       54.99 |\r\n\r\nã¯ã„ã€çµæœãŒå‡ºã¾ã—ãŸã€‚Daliborã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¨˜äº‹ã§ä¸€ç•ªé€Ÿã‹ã£ãŸ `CSV.foreach` ã‚ˆã‚Š16å€ã®å®Ÿè¡Œé€Ÿåº¦ã¨ãªã‚Šã¾ã—ãŸã€‚\r\n\r\n# WRAPUP\r\nPyCallã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ `PyObject`ã¨ActiveRecordã¨ç›¸æ€§ãŒæ‚ªãã†ãªã®ã¨ã€Pythonã¨RubyåŒæ–¹ã®ãƒ¡ãƒ¢ãƒªãƒ¼ç®¡ç†ãŒé‹ç”¨ã‚’é›£ã—ãã™ã‚‹ã“ã¨ã‹ã‚‰ã€å®‰æ˜“ã«æœ¬ç•ªç’°å¢ƒã®Railsã«å°å…¥ã™ã‚‹ã®ã¯å³ã—ã„ã¨æ€ã„ã¾ã™ã€‚\r\n\r\nãŸã ã—ã€å®Ÿè¡Œå›æ•°ãŒé™å®šã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã‚‰ç©æ¥µçš„ã«ä½¿ã£ã¦è‰¯ã„ã§ã—ã‚‡ã†ã€‚\r\n","body_html":"<a href=\"https://img.esa.io/uploads/production/attachments/16651/2021/01/11/97367/180665c6-7370-4579-8340-7be6254834e8.png\" target=\"_blank\" rel=\"noopener noreferrer\"><img width=\"1920\" alt=\"thumbnail\" src=\"https://img.esa.io/uploads/production/attachments/16651/2021/01/11/97367/180665c6-7370-4579-8340-7be6254834e8.png\"></a>\n<p data-sourcepos=\"3:1-3:290\">å…ˆæ—¥Rubyã‹ã‚‰Pythonã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹PyCallã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å­˜åœ¨ã‚’çŸ¥ã‚Šã€ãœã²ã¨ã‚‚ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’å–ã‚ŠãŸã„ã¨æ€ã£ãŸæ¬¡ç¬¬ã§ã™ã€‚ç¾çŠ¶Rubyã®CSVã®èª­ã¿è¾¼ã¿ã«ä¸æº€ã‚’æŒã£ã¦ãŠã‚Šã€ãã“ã‚’ã©ã†ã«ã‹è§£æ¶ˆã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚</p>\n<h1 data-sourcepos=\"5:1-5:9\" id=\"1-0-0\" name=\"1-0-0\">\n<a class=\"anchor\" id=\"PROBLEM\" name=\"PROBLEM\" href=\"#PROBLEM\" data-position=\"1-0-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"PROBLEM\"> &gt; PROBLEM</span></a>PROBLEM</h1>\n<ul data-sourcepos=\"6:1-7:0\">\n<li data-sourcepos=\"6:1-7:0\">å¤§é‡ã®CSVã‚’èª­ã¿è¾¼ã‚€éš›ã€æ¯å›æ™‚é–“ãŒã‹ã‹ã‚‹</li>\n</ul>\n<h1 data-sourcepos=\"8:1-8:10\" id=\"2-0-0\" name=\"2-0-0\">\n<a class=\"anchor\" id=\"SOLUTION\" name=\"SOLUTION\" href=\"#SOLUTION\" data-position=\"2-0-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"SOLUTION\"> &gt; SOLUTION</span></a>SOLUTION</h1>\n<p data-sourcepos=\"9:1-9:307\">ã¨ã„ã†ã‚ã‘ã§ã€ã€Œ<a href=\"https://dalibornasevic.com/posts/68-processing-large-csv-files-with-ruby\" target=\"_blank\" rel=\"noopener noreferrer\">Dalibor Nasevicã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¨˜äº‹</a>ã€ã«PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’ãã‚ãˆã¦æ¯”è¼ƒã—ã¦ã¿ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚è¨˜äº‹ã§ã¯ä¸‹è¨˜ã®é€šã‚Š <code>CSV.foreach</code> ãŒé€Ÿã„ã¨ã®çµè«–ã§ã—ãŸã€‚</p>\n<table data-sourcepos=\"11:1-17:66\">\n<thead>\n<tr data-sourcepos=\"11:1-11:66\">\n<th data-sourcepos=\"11:2-11:37\">kind_of_parse</th>\n<th data-sourcepos=\"11:39-11:51\">time (real)</th>\n<th data-sourcepos=\"11:53-11:65\">memory (MB)</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"13:1-13:66\">\n<td data-sourcepos=\"13:2-13:37\">1. <code>CSV.read</code>\n</td>\n<td data-sourcepos=\"13:39-13:51\">39.13</td>\n<td data-sourcepos=\"13:53-13:65\">866.6</td>\n</tr>\n<tr data-sourcepos=\"14:1-14:66\">\n<td data-sourcepos=\"14:2-14:37\">2. <code>CSV.parse</code>\n</td>\n<td data-sourcepos=\"14:39-14:51\">36.16</td>\n<td data-sourcepos=\"14:53-14:65\">936.87</td>\n</tr>\n<tr data-sourcepos=\"15:1-15:66\">\n<td data-sourcepos=\"15:2-15:37\">3. line by line from String Object</td>\n<td data-sourcepos=\"15:39-15:51\">23.39</td>\n<td data-sourcepos=\"15:53-15:65\">73.42</td>\n</tr>\n<tr data-sourcepos=\"16:1-16:66\">\n<td data-sourcepos=\"16:2-16:37\">4. line by line from IO Object</td>\n<td data-sourcepos=\"16:39-16:51\">24.55</td>\n<td data-sourcepos=\"16:53-16:65\">0.0</td>\n</tr>\n<tr data-sourcepos=\"17:1-17:66\">\n<td data-sourcepos=\"17:2-17:37\">5. <code>CSV.foreach</code>\n</td>\n<td data-sourcepos=\"17:39-17:51\">24.04</td>\n<td data-sourcepos=\"17:53-17:65\">0.0</td>\n</tr>\n</tbody>\n</table>\n<h2 data-sourcepos=\"19:1-19:30\" id=\"2-1-0\" name=\"2-1-0\">\n<a class=\"anchor\" id=\"PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯\" name=\"PyCall%E3%81%AE%E3%83%99%E3%83%B3%E3%83%81%E3%83%9E%E3%83%BC%E3%82%AF\" href=\"#PyCall%E3%81%AE%E3%83%99%E3%83%B3%E3%83%81%E3%83%9E%E3%83%BC%E3%82%AF\" data-position=\"2-1-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯\"> &gt; PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</span></a>PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯</h2>\n<p data-sourcepos=\"20:1-20:111\">ãã‚Œã§ã¯ã€PyCallã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯ã‚’è¨ˆã‚Šã¾ã—ã‚‡ã†ã€‚ã‚³ãƒ¼ãƒ‰ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚</p>\n<div class=\"code-block\" data-sourcepos=\"22:1-35:3\">\n<div class=\"code-filename\">\n<i class=\"fa fa-file-code-o\"></i>ruby</div>\n<div class=\"highlight\"><pre class=\"highlight ruby\"><code><span class=\"nb\">require_relative</span> <span class=\"s1\">'./helpers'</span>\n<span class=\"nb\">require</span> <span class=\"s1\">'pycall/import'</span>\n<span class=\"kp\">include</span> <span class=\"no\">PyCall</span><span class=\"o\">::</span><span class=\"no\">Import</span>\n<span class=\"n\">pyimport</span> <span class=\"ss\">:pandas</span><span class=\"p\">,</span> <span class=\"ss\">as: :pd</span>\n\n<span class=\"n\">print_memory_usage</span> <span class=\"k\">do</span>\n  <span class=\"n\">print_time_spent</span> <span class=\"k\">do</span>\n    <span class=\"n\">csv</span> <span class=\"o\">=</span> <span class=\"n\">pd</span><span class=\"p\">.</span><span class=\"nf\">read_csv</span><span class=\"o\">.</span><span class=\"p\">(</span><span class=\"s1\">'data.csv'</span><span class=\"p\">)</span>\n    <span class=\"n\">sum</span> <span class=\"o\">=</span> <span class=\"n\">csv</span><span class=\"p\">[</span><span class=\"s1\">'id'</span><span class=\"p\">].</span><span class=\"nf\">sum</span><span class=\"o\">.</span><span class=\"p\">()</span>\n    <span class=\"nb\">puts</span> <span class=\"s2\">\"Sum: </span><span class=\"si\">#{</span><span class=\"n\">sum</span><span class=\"si\">}</span><span class=\"s2\">\"</span>\n  <span class=\"k\">end</span>\n<span class=\"k\">end</span>\n</code></pre></div>\n</div>\n<p data-sourcepos=\"37:1-37:102\">PyCallã¯ <code>pyenv</code> ã¨ã®ç›¸æ€§ãŒæ‚ªã„ã®ã§Systemã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸPythonã§ãŸãŸãã¾ã™ã€‚</p>\n<div class=\"code-block\" data-sourcepos=\"39:1-44:3\">\n<div class=\"code-filename\">\n<i class=\"fa fa-file-code-o\"></i>sh</div>\n<div class=\"highlight\"><pre class=\"highlight shell\"><code><span class=\"nv\">$ PYTHON</span><span class=\"o\">=</span>/usr/bin/python3.4 ruby parse_6_pycall.rb\nSum: 499999500000\nTime: 1.49\nMemory: 54.99 MB\n</code></pre></div>\n</div>\n<p data-sourcepos=\"46:1-46:10\"><strong>çµæœ</strong></p>\n<table data-sourcepos=\"48:1-55:66\">\n<thead>\n<tr data-sourcepos=\"48:1-48:66\">\n<th data-sourcepos=\"48:2-48:37\">kind_of_parse</th>\n<th data-sourcepos=\"48:39-48:51\">time (real)</th>\n<th data-sourcepos=\"48:53-48:65\">memory (MB)</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"50:1-50:66\">\n<td data-sourcepos=\"50:2-50:37\">1. <code>CSV.read</code>\n</td>\n<td data-sourcepos=\"50:39-50:51\">39.13</td>\n<td data-sourcepos=\"50:53-50:65\">866.6</td>\n</tr>\n<tr data-sourcepos=\"51:1-51:66\">\n<td data-sourcepos=\"51:2-51:37\">2. <code>CSV.parse</code>\n</td>\n<td data-sourcepos=\"51:39-51:51\">36.16</td>\n<td data-sourcepos=\"51:53-51:65\">936.87</td>\n</tr>\n<tr data-sourcepos=\"52:1-52:66\">\n<td data-sourcepos=\"52:2-52:37\">3. line by line from String Object</td>\n<td data-sourcepos=\"52:39-52:51\">23.39</td>\n<td data-sourcepos=\"52:53-52:65\">73.42</td>\n</tr>\n<tr data-sourcepos=\"53:1-53:66\">\n<td data-sourcepos=\"53:2-53:37\">4. line by line from IO Object</td>\n<td data-sourcepos=\"53:39-53:51\">24.55</td>\n<td data-sourcepos=\"53:53-53:65\">0.0</td>\n</tr>\n<tr data-sourcepos=\"54:1-54:66\">\n<td data-sourcepos=\"54:2-54:37\">5. <code>CSV.foreach</code>\n</td>\n<td data-sourcepos=\"54:39-54:51\">24.04</td>\n<td data-sourcepos=\"54:53-54:65\">0.0</td>\n</tr>\n<tr data-sourcepos=\"55:1-55:66\">\n<td data-sourcepos=\"55:2-55:37\">6. PyCall</td>\n<td data-sourcepos=\"55:39-55:51\">1.49</td>\n<td data-sourcepos=\"55:53-55:65\">54.99</td>\n</tr>\n</tbody>\n</table>\n<p data-sourcepos=\"57:1-57:150\">ã¯ã„ã€çµæœãŒå‡ºã¾ã—ãŸã€‚Daliborã®ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯è¨˜äº‹ã§ä¸€ç•ªé€Ÿã‹ã£ãŸ <code>CSV.foreach</code> ã‚ˆã‚Š16å€ã®å®Ÿè¡Œé€Ÿåº¦ã¨ãªã‚Šã¾ã—ãŸã€‚</p>\n<h1 data-sourcepos=\"59:1-59:8\" id=\"3-0-0\" name=\"3-0-0\">\n<a class=\"anchor\" id=\"WRAPUP\" name=\"WRAPUP\" href=\"#WRAPUP\" data-position=\"3-0-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"WRAPUP\"> &gt; WRAPUP</span></a>WRAPUP</h1>\n<p data-sourcepos=\"60:1-60:248\">PyCallã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãŒ <code>PyObject</code>ã¨ActiveRecordã¨ç›¸æ€§ãŒæ‚ªãã†ãªã®ã¨ã€Pythonã¨RubyåŒæ–¹ã®ãƒ¡ãƒ¢ãƒªãƒ¼ç®¡ç†ãŒé‹ç”¨ã‚’é›£ã—ãã™ã‚‹ã“ã¨ã‹ã‚‰ã€å®‰æ˜“ã«æœ¬ç•ªç’°å¢ƒã®Railsã«å°å…¥ã™ã‚‹ã®ã¯å³ã—ã„ã¨æ€ã„ã¾ã™ã€‚</p>\n<p data-sourcepos=\"62:1-62:105\">ãŸã ã—ã€å®Ÿè¡Œå›æ•°ãŒé™å®šã•ã‚ŒãŸã‚¹ã‚¯ãƒªãƒ—ãƒˆãªã‚‰ç©æ¥µçš„ã«ä½¿ã£ã¦è‰¯ã„ã§ã—ã‚‡ã†ã€‚</p>\n","tags":["ruby","benchmark","pycall"],"updated_at":"2021-01-16T10:27:34+09:00","childPublishedDate":{"published_on":"2017-06-05T00:00:00.000Z"},"updated_by":{"name":"ãªã³ã®ğŸ‘·","screen_name":"nabinno","icon":"https://img.esa.io/uploads/production/members/94286/icon/thumb_m_ef5f024307008aa399b91f87fa5f64e8.jpg"}},"relatedPosts":{"edges":[{"node":{"number":60,"relative_category":"blog/backend","fields":{"title":"é€£è¼‰ Rails2Phoenix 2 èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹","excerpt":"é€£è¼‰ã€ŒRails2Phoenixã€ã«ãªã‚Šã¾ã™ã€å‰å›ã¯ã€ŒUmbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Herokuã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ ã€ã§ã—ãŸã€‚ä»Šå›ã¯å‰å›èª²é¡Œã¨ã—ã¦ã‚ãŒã£ãŸèªè¨¼æ©Ÿèƒ½ã®å®Ÿè£…ã‚’è©¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚   > PROBLEMPROBLEM \n\n- ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ æ‹¡å¼µã«ã¨ã‚‚ãªã„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãŒãµãˆã‚‹ã®ã‚’æŠ‘ãˆãŸã„ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®ãŸã‚ã®ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ã‚ã’ãŸã„ \n- æ‹¡å¼µã«ã¨ã‚‚ãªã„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãŒãµãˆã‚‹ã®ã‚’æŠ‘ãˆãŸã„\n- ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®ãŸã‚ã®ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„\n- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ã‚ã’ãŸã„   > SOLUTIONSOLUTION \n\nã¨ã„ã†ã‚ã‘ã§ã€ç¾åœ¨ã¤ã‹ã£ã¦ã„ã‚‹Railsã‚’Phoenixã«å¤‰æ›´ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚æ–¹é‡ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã€ä»Šå›ã¯Rails/Deviseã®èªè¨¼æ©Ÿèƒ½ã‚’Phoenixã§å®Ÿè£…ã™ã‚‹æµã‚Œã‚’å–ã‚Šä¸Šã’ã¾ã™ã€‚ \n\næ–¹é‡ \n\n- Railsã‹ã‚‰å¾ã€…ã«Phoenixã«ç§»è¡Œã§ãã‚‹ã‚ˆã†ã« ã„ã¾ã¾ã§ã¨ãŠãªã˜PaaSï¼ˆHerokuï¼‰ ã„ã¾ã¾ã§ã¨ãŠãªã˜ãƒ¬ãƒã‚¸ãƒˆãƒª ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã« æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã ã„ã¾ã¾ã§ã¨ãŠãªã˜DB ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„ \n- ã„ã¾ã¾ã§ã¨ãŠãªã˜PaaSï¼ˆHerokuï¼‰\n- ã„ã¾ã¾ã§ã¨ãŠãªã˜ãƒ¬ãƒã‚¸ãƒˆãƒª ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã« æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã \n- ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã«\n- æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã\n- ã„ã¾ã¾ã§ã¨ãŠãªã˜DB ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„ \n- ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„\n- Phoenixã¯ä»Šå¾Œã®æ‹¡å¼µæ€§ã‚’ã‹ã‚“ãŒãˆã¦Umbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§   > Guardianã‚’å®Ÿè£…ã™ã‚‹Guardianã‚’å®Ÿè£…ã™ã‚‹ \n\nã¾ãšã€å‚è€ƒã«ã—ãŸã®ã¯Blackodeã®guardian_authã§ã™ã€‚ãŸã ã€Guardianã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãµã‚‹ã„ã®ã§1.0ã¸ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨˜äº‹ã‚’ã‚‚ã¨ã«ã‚¢ãƒ¬ãƒ³ã‚¸ã—ã¦ã‚ã‚Šã¾ã™ã€‚èªè¨¼ã«é–¢ä¿‚ã—ãã†ãªæ§‹æˆã¯ä¸‹è¨˜ã®é€šã‚Šã€‚ \n\nãƒ­ã‚¸ãƒƒã‚¯ \n\n- MyApp.Account\n- MyApp.Account.Registration\n- MyApp.Account.User\n- MyApp.Auth.Guardian\n- MyApp.Auth.ErrorHandler\n- MyApp.Auth.Pipeline\n- MyApp.Auth.AfterPipeline\n- MyApp.Auth.Session \n\nã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ© \n\n- MyAppWeb.RegistrationController\n- MyAppWeb.SessionController   > ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¶ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã®è¨­å®šã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¶ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã®è¨­å®š \n\nGuardian1.0ã‹ã‚‰ç›´æ¥ã§ã¯ãªããƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä»‹ã—ã¦å‚ç…§ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ä¸‹è¨˜ã®ã‚ˆã†ã«å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”¨æ„ã—ã¦ã‚³ãƒ³ãƒ•ã‚£ã‚°ã«å‰²ã‚Šå½“ã¦ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app/auth/guardian.ex defmodule MyApp.Auth.Guardian do use Guardian, otp_app: :my_app alias MyApp.Account def subject_for_token(resource, _claims), do: {:ok, to_string(resource.id)} def subject_for_token(_, _), do: {:error, :reason_for_error} def resource_from_claims(claims), do: {:ok, Account.get_user!(claims[\"sub\"])} def resource_from_claims(_claims), do: {:error, :reason_for_error} end     elixir \n\n# apps/my_app/lib/my_app/auth/error_handler.ex defmodule MyApp.Auth.ErrorHandler do import Plug.Conn def auth_error(conn, {type, _reason}, _opts) do body = Poison.encode!(%{message: to_string(type)}) send_resp(conn, 401, body) end end     elixir \n\n# apps/my_app/config/config.exs config :my_app, MyApp.Auth.Guardian, issuer: \"MyApp\", ttl: {30, :days}, allowed_drift: 2000, # optionals allowed_algos: [\"HS512\"], verify_module: MyApp.Auth.Guardian.JWT, verify_issuer: true, secret_key: System.get_env(\"GUARDIAN_SECRET\") || \"secret_key\"     > ãƒ«ãƒ¼ã‚¿ãƒ¼ã®è¨­å®šãƒ«ãƒ¼ã‚¿ãƒ¼ã®è¨­å®š \n\nèªè¨¼ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€èªè¨¼ä¸­ã¨èªè¨¼å¾Œã®ã‚‚ã®ã‚’ç”¨æ„ã—ã‚³ãƒ³ãƒ•ã‚£ã‚°ã¨ãƒ«ãƒ¼ã‚¿ãƒ¼ã«å‰²ã‚Šå½“ã¦ã¾ã™ã€‚ \n\nãƒ«ãƒ¼ã‚¿ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ—å†…ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãã¿ã‚ã‚ã›ã«ã¤ã„ã¦ã€ã“ã“ã§ã¯æœªãƒ­ã‚°ã‚¤ãƒ³ã‚¹ã‚³ãƒ¼ãƒ—ã«ã¯èªè¨¼å‰ãƒ»èªè¨¼ä¸­ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã€ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã‚¹ã‚³ãƒ¼ãƒ—ã«ã¯èªè¨¼å‰ãƒ»èªè¨¼ä¸­ãƒ»èªè¨¼å¾Œãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’é©ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã†ã™ã‚‹ã“ã¨ã§ã©ã®ã‚¹ã‚³ãƒ¼ãƒ—ã«ã‚‚èªè¨¼ãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã€ã‹ã¤ã€èªè¨¼ã‚‚æ‹…ä¿ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚å…·ä½“çš„ã«ã„ã†ã¨ã€ãƒ«ãƒ¼ãƒˆ / ãªã©ã®åŒä¸€URLã§æœªãƒ­ã‚°ã‚¤ãƒ³ã‚¹ã‚³ãƒ¼ãƒ—ã¨ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã‚¹ã‚³ãƒ¼ãƒ—ã®åˆ‡ã‚Šæ›¿ãˆãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app/auth/pipeline.ex defmodule MyApp.Auth.Pipeline do use Guardian.Plug.Pipeline, otp_app: :my_app plug(Guardian.Plug.VerifySession, claims: %{\"typ\" => \"access\"}) plug(Guardian.Plug.VerifyHeader, claims: %{\"typ\" => \"access\"}) plug(Guardian.Plug.LoadResource, allow_blank: true) end     elixir \n\n# apps/my_app/lib/my_app/auth/after_pipeline.ex defmodule MyApp.Auth.AfterPipeline do use Guardian.Plug.Pipeline, otp_app: :my_app plug(Guardian.Plug.EnsureAuthenticated) end     elixir \n\n# apps/my_app/lib/my_app_web/router.ex defmodule MyAppWeb.Router do use MyAppWeb, :router pipeline :browser do plug(:accepts, [\"html\"]) plug(:fetch_session) plug(:fetch_flash) plug(:protect_from_forgery) plug(:put_secure_browser_headers) end pipeline :browser_auth do plug(MyApp.Auth.Pipeline) end pipeline :browser_auth_after do plug(MyApp.Auth.AfterPipeline) end scope \"/\", MyAppWeb do pipe_through([:browser, :browser_auth]) post(\"/registration\", RegistrationController, :create) get(\"/login\", SessionController, :new) post(\"/login\", SessionController, :create) get(\"/logout\", SessionController, :delete) end scope \"/\", MyAppWeb do pipe_through([:browser, :browser_auth, :browser_auth_after]) get(\"/edit\", RegistrationController, :edit) put(\"/edit\", RegistrationController, :update) get(\"/users\", UserController, :index) resources \"/\", UserController, only: [:show, :delete], param: \"username\" end end     elixir \n\n# apps/my_app/config/config.exs config :MyApp, MyApp.Auth.Pipeline, module: MyApp.Auth.Guardian, error_handler: MyApp.Auth.ErrorHandler config :MyApp, MyApp.Auth.AferPipeline, module: MyApp.Auth.Guardian, error_handler: MyApp.Auth.ErrorHandler     > ç™»éŒ²ç™»éŒ² \n\nç™»éŒ²ã¯ç™»éŒ²ç”¨ã®ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¢ãƒ‡ãƒ«ã¨ç™»éŒ²ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚’ç”¨æ„ã—ã¾ã™ã€‚ \n\nã“ã®ã‚ãŸã‚Šã¯Devise/Railsã¨ã‚ã¾ã‚Šå¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚ä»–ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€Œæ–°è¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç™ºè¡Œã€ã€Œãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ç¢ºèªã€ç­‰ã‚‚åŒæ§˜ã®æ§‹æˆã‚’ã¨ã‚ã†ã¨æ€ã£ã¦ã„ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app_web/controller/registration_controller.ex def create(conn, user_params) do changeset = User.registration_changeset(%User{}, user_params) case Registration.create(changeset, Repo) do {:ok, user} -> conn |> MyApp.Auth.login(user) |> put_flash(:info, \"Your account was created successfully\") |> redirect(to: page_path(conn, :home)) {:error, changeset} -> conn |> put_flash(:error, \"Unable to create account: Try again\") |> render(MyAppWeb.PageView, \"home.html\", changeset: changeset) end end     elixir \n\n# apps/my_app/lib/my_app/auth/auth.ex def login(conn, %User{} = user) do conn |> Guardian.Plug.sign_in(user) |> assign(:current_user, user) end     elixir \n\n# apps/my_app/lib/my_app/account/registration.ex def create(changeset, repo) do changeset |> repo.insert() end     > ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ \n\nãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”¨ã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã§å®Ÿè£…ã—ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app_web/controller/session_controller.ex @doc \"Logged in [POST /login]\" def create(conn, %{\"email\" => email, \"password\" => password}) do case Session.authenticate_user(email, password) do {:ok, user} -> conn |> Session.login(user) |> put_flash(:info, \"Logged in successfully\") |> redirect(to: page_path(conn, :home)) {:error, _reason} -> conn |> put_flash(:error, \"Wrong username/password\") |> render(\"new.html\") end end @doc \"Logged out [DELETE /logout]\" def delete(conn, _params) do conn |> Session.logout() |> put_flash(:info, \"Logged out successfully.\") |> redirect(to: \"/\") end     elixir \n\n# apps/my_app/lib/my_app/auth/session.ex defmodule MyApp.Auth.Session do import Ecto.Query import Plug.Conn import Comeonin.Bcrypt, only: [checkpw: 2, dummy_checkpw: 0] alias MyApp.Repo alias MyApp.Auth.Guardian alias MyApp.Account.User def login(conn, %User{} = user) do conn |> Guardian.Plug.sign_in(user) |> assign(:current_user, user) end def logout(conn), do: Guardian.Plug.sign_out(conn) def authenticate_user(email, given_password) do query = Ecto.Query.from(u in User, where: u.email == ^email) Repo.one(query) |> check_password(given_password) end def current_user(conn), do: Guardian.Plug.current_resource(conn, []) def logged_in?(conn), do: Guardian.Plug.authenticated?(conn, []) defp check_password(nil, _), do: {:error, \"Incorrect username or password\"} defp check_password(user, given_password) do case Comeonin.Bcrypt.checkpw(given_password, user.encrypted_password) do true -> {:ok, user} false -> {:error, \"Incorrect email or password\"} end end end   \n\nDevise/Railsã®ãƒ“ãƒ¥ãƒ¼ãƒ˜ãƒ«ãƒ‘ãƒ¼ã¯ãƒ“ãƒ¥ãƒ¼ãƒã‚¯ãƒ­ã§é©ç”¨ã—ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app_web.ex def view do quote do # .. import Okuribi.Auth.Session, only: [current_user: 1, logged_in?: 1] end end   \n\nã‚ã‚‹ã„ã¯ã€put_assignsé–¢æ•°ã‚’ã¯ã‚„ã—ã¦ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒã‚¯ãƒ­ã«é©ç”¨ã—ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app/auth/session.ex def put_assigns(%{private: %{phoenix_action: action}} = conn, settings) do current_resource = Guardian.Plug.current_resource(conn) settings = if current_resource, do: settings[:sign_in][action] || [], else: settings[:sign_out][action] || [] conn |> assign(:current_user, current_resource) |> assign(:page_title, settings[:page_title]) |> assign(:page_description, settings[:page_description]) end     elixir \n\n# apps/my_app/lib/my_app_web.ex def controller do quote do # .. import Okuribi.Auth, only: [put_assigns: 2] end end   \n\nassignsã²ã¨ã¤ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã®ã§ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã§ã¾ã¨ã‚ã¦æŒ‡å®šã™ã‚‹ã“ã¨ã§Railsã®ActionView::Helpers::CaptureHelper#provideã®ä»£ã‚ã‚Šã«ä½¿ãˆã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app_web/controller/*_controller.ex @page %{ sign_in: %{ new: %{ page_title: dgettext(\"views\", \"pages.home.signed_in.page_title\"), page_description: \"\" } }, sign_out: %{ new: %{ page_title: dgettext(\"views\", \"pages.home.signed_out.page_title\"), page_description: \"\" } } } plug(:put_assigns, @page when action in [:home])     > ãã®ä»–ãã®ä»– \n\nRailsã®ãƒ“ãƒ¥ãƒ¼ã‚’Phoenixã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ç§»æ¤ã™ã‚‹ã«ã¯ä¸‹è¨˜ã®å¤‰æ›ã‚’åœ°é“ã«è¡Œã£ã¦ã„ãã¾ã™ã€‚ \n\n- Rails ActionView::Helpers::FormHelper#form_for(record, options={}, &block) ActionView::Helpers::FormHelper#text_field(object_name, method, options={}) ActionView::Helpers::FormHelper#file_field(object_name, method, options={}) ActionView::Helpers::FormHelper#hidden_field(object_name, method, options={}) ActionView::Helpers::FormHelper#password_field(object_name, method, options={}) ActionView::Helpers::FormHelper#radio_button(object_name, method, tag_value, options={}) ActionView::Helpers::FormBuilder#submit(value=nil, options={}) ActionView::Helpers::TranslationHelper#t \n- ActionView::Helpers::FormHelper#form_for(record, options={}, &block)\n- ActionView::Helpers::FormHelper#text_field(object_name, method, options={})\n- ActionView::Helpers::FormHelper#file_field(object_name, method, options={})\n- ActionView::Helpers::FormHelper#hidden_field(object_name, method, options={})\n- ActionView::Helpers::FormHelper#password_field(object_name, method, options={})\n- ActionView::Helpers::FormHelper#radio_button(object_name, method, tag_value, options={})\n- ActionView::Helpers::FormBuilder#submit(value=nil, options={})\n- ActionView::Helpers::TranslationHelper#t\n- Phoenix Phoenix.HTML.Form.form_for(form_data, action, options \\\\ [], fun) Phoenix.HTML.Form.text_input(form, field, opts \\\\ []) Phoenix.HTML.Form.file_input(form, field, opts \\\\ []) Phoenix.HTML.Form.hidden_input(form, field, opts \\\\ []) Phoenix.HTML.Form.password_input(form, field, opts \\\\ []) Phoenix.HTML.Form.radio_button(form, field, value, opts \\\\ []) Phoenix.HTML.Form.submit(opts, opts \\\\ []) Gettext.dgettext(backend, domain, msgid, bindings \\\\ %{}) \n- Phoenix.HTML.Form.form_for(form_data, action, options \\\\ [], fun)\n- Phoenix.HTML.Form.text_input(form, field, opts \\\\ [])\n- Phoenix.HTML.Form.file_input(form, field, opts \\\\ [])\n- Phoenix.HTML.Form.hidden_input(form, field, opts \\\\ [])\n- Phoenix.HTML.Form.password_input(form, field, opts \\\\ [])\n- Phoenix.HTML.Form.radio_button(form, field, value, opts \\\\ [])\n- Phoenix.HTML.Form.submit(opts, opts \\\\ [])\n- Gettext.dgettext(backend, domain, msgid, bindings \\\\ %{})   > WRAPUPWRAPUP \n\nå‰å›ã‚‚ãã†ã§ã™ãŒã€ã‚³ãƒ¼ãƒ‰ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã¾ã‚åœ°å‘³ãªä½œæ¥­ã§ã™ã‚ˆã­ã€‚ã¨ã¾ã‚Œã€èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã§ããŸã®ã§è‰¯ã—ã¨ã—ã¾ã—ã‚‡ã†ã€‚"},"name":"[2018-05-20]é€£è¼‰ Rails2Phoenix 2 èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹","tags":["phoenix-framework","elixir","ruby-on-rails","ruby","wercker","heroku","authentication","guardian"],"childPublishedDate":{"published_on":"2018-05-20T00:00:00.000Z","published_on_unix":1526774400}}},{"node":{"number":59,"relative_category":"blog/backend","fields":{"title":"é€£è¼‰ Rails2Phoenix 1 Umbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Herokuã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹","excerpt":"ä½¿ã„æ…£ã‚ŒãŸRailsã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’æ‹¡å¼µã—ãŸã„ã®ã§ã™ãŒã€ãã®éƒ½åº¦æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã‚’å¢—ã‚„ã™å¿…è¦ãŒã‚ã‚Šã€ã“ã®ç‚¹ã‚’ã©ã†ã«ã‹ã‚¯ãƒªã‚¢ã—ãŸã„ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚é€£è¼‰ã€ŒRails2Phoenixã€ã«ãªã‚Šã¾ã™ã€ä»Šå›ã¯ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’Elixirè£½ã®Phoenix Frameworkã¸ã¨å¤‰æ›´ã‚’è©¦ã¿ã¾ã—ãŸã€‚   > PROBLEMPROBLEM \n\n- ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ æ‹¡å¼µã«ã¨ã‚‚ãªã„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãŒãµãˆã‚‹ã®ã‚’æŠ‘ãˆãŸã„ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®ãŸã‚ã®ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ã‚ã’ãŸã„ \n- æ‹¡å¼µã«ã¨ã‚‚ãªã„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãŒãµãˆã‚‹ã®ã‚’æŠ‘ãˆãŸã„\n- ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®ãŸã‚ã®ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„\n- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ã‚ã’ãŸã„   > SOLUTIONSOLUTION \n\nã¨ã„ã†ã‚ã‘ã§ã€ç¾åœ¨ã¤ã‹ã£ã¦ã„ã‚‹Railsã‚’Phoenixã«å¤‰æ›´ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚æ–¹é‡ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã€ä»Šå›ã¯Railsã‹ã‚‰ç§»è¡Œä¸­ã®Phoenix Umbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Herokuã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹æµã‚Œã‚’ã¨ã‚Šã‚ã’ã¾ã™ã€‚ \n\næ–¹é‡ \n\n- Railsã‹ã‚‰å¾ã€…ã«Phoenixã«ç§»è¡Œã§ãã‚‹ã‚ˆã†ã« ã„ã¾ã¾ã§ã¨ãŠãªã˜PaaSï¼ˆHerokuï¼‰ ã„ã¾ã¾ã§ã¨ãŠãªã˜ãƒ¬ãƒã‚¸ãƒˆãƒª ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã« æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã ã„ã¾ã¾ã§ã¨ãŠãªã˜DB ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„ \n- ã„ã¾ã¾ã§ã¨ãŠãªã˜PaaSï¼ˆHerokuï¼‰\n- ã„ã¾ã¾ã§ã¨ãŠãªã˜ãƒ¬ãƒã‚¸ãƒˆãƒª ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã« æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã \n- ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã«\n- æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã\n- ã„ã¾ã¾ã§ã¨ãŠãªã˜DB ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„ \n- ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„\n- Phoenixã¯ä»Šå¾Œã®æ‹¡å¼µæ€§ã‚’ã‹ã‚“ãŒãˆã¦Umbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§   > Herokuã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãªãŒã‚ŒHerokuã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãªãŒã‚Œ \n\nåŸºæœ¬çš„ã«ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆé€šã‚Šã€‚   > Phoenixã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆPhoenixã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ \n\nã¾ãšã€ã“ã‚“ãªæ„Ÿã˜ã§Phoenixã®éª¨çµ„ã¿ã‚’ã¤ãã‚Šã¾ã™ã€‚Phoenixé–¢é€£ã®ãƒ•ã‚¡ã‚¤ãƒ« apps/, deps/, config/config.exs, mix.exs, mix.lock ãŒè¿½åŠ ã•ã‚Œã¾ã™ã€‚   sh \n\n> cd rails_project > mix new . --umbrella > (cd ./apps && mix phx.new phoenix_app)   \n\næ¬¡ã«ã€æ—¢å­˜ã®Railsã§ã¤ãã‚‰ã‚ŒãŸã‚¹ã‚­ãƒ¼ãƒã‚’Phoenixã«ç§»æ¤ã—ã¾ã™ã€‚Ripperã‚’ã¤ã‹ã†ã¨ã¯ã‹ã©ã‚Šã¾ã™ã€‚ã¡ãªã¿ã«æ‰‹å‹•ã§ã‚¹ã‚­ãƒ¼ãƒã‚’ã¤ãã‚ŠãŸã„å ´åˆã¯ã€CLI mix phx.gen.schema --no-migration Blog.Post blog_posts title:string ã§ä½œæˆã—ã¾ã™ã€‚   rb \n\n# lib/tasks/convert_to_phoenix.rake # ã“ã¡ã‚‰ã¯ã‚¹ã‚­ãƒ¼ãƒç§»æ¤ã‚¿ã‚¹ã‚¯ã‚’Phoenix1.3ç”¨ã«æ”¹ã‚ãŸã‚‚ã® require 'ripper' require 'erb' require 'fileutils' namespace :db do namespace :schema do desc 'Convert schema from Rails to Phoenix' task convert_to_phoenix: :environment do ConvertSchemaForPhoenixService.call end end end class ConvertSchemaForPhoenixService class << self def call FileUtils.mkdir_p(File.join('tmp', 'models')) extract_activerecord_define_block( Ripper.sexp( Rails.root .join('db', 'schema.rb') .read ) ).select(&method(:create_table_block?)) .map(&method(:configuration)) .each do |conf| project_name = 'PhoenixApp' table_name = conf[:table_name] table_columns = conf[:table_columns].reject(&method(:reject_condition)) .map do |c| case c[:column_type] when 'text' then c[:column_type] = ':string' when 'datetime' then c[:column_type] = ':naive_datetime' when 'inet' then c[:column_type] = 'EctoNetwork.INET' else c[:column_type] = \":#{c[:column_type]}\" end c end File.write( File.join('tmp', 'models', \"#{conf[:table_name].singularize}.ex\"), template.result(binding) ) end end private def extract_activerecord_define_block(sexp) sexp.dig(1, 0, 2, 2) end def create_table_block?(activerecord_define_block_element_sexp) activerecord_define_block_element_sexp.dig(1, 1, 1) == 'create_table' rescue false end def extract_table_name(create_table_block_sexp) create_table_block_sexp.dig(1, 2, 1, 0, 1, 1, 1) end def extract_table_columns(create_table_block_sexp) create_table_block_sexp.dig(2, 2) end def extract_column_type(table_column_sexp) table_column_sexp.dig(3, 1) end def extract_column_name(table_column_sexp) # Return value of `t.index` is array like ['user_id']. if table_column_sexp.dig(4, 1, 0, 0) == :array return table_column_sexp.dig(4, 1, 0, 1).map { |e| e.dig(1, 1, 1) } end table_column_sexp.dig(4, 1, 0, 1, 1, 1) end def extract_column_option(table_column_sexp) # If is not `column_option`, then `table_column_sexp.dig(4, 1, 1, # 1)` method return nil. Set blank array ([]) for avoiding nil. table_column_sexp.dig(4, 1, 1, 1) || [] end def extract_option_key(column_option_sexp) # Remove colon for avoiding `null:`. column_option_sexp.dig(1, 1).gsub(/:\\z/, '') end def extract_option_value(column_option_sexp) if column_option_sexp.dig(2, 0) == :array return Array(column_option_sexp.dig(2, 1)).map { |e| e.dig(1, 1, 1) } end element = column_option_sexp.dig(2, 1) if element.class != Array return element end case element.dig(0) when :kw then element.dig(1) when :string_content then element.dig(1, 1) || '' end end def template ERB.new(<<'__EOD__', nil, '-') defmodule <%= project_name %>.<%= table_name.classify %> do use Ecto.Schema import Ecto.Changeset alias <%= project_name %>.<%= table_name.classify %> schema \"<%= table_name %>\" do<% table_columns.each do |c| %> field :<%= c[:column_name] -%>, <%= c[:column_type] -%> <% end %> timestamps inserted_at: :created_at end @doc false def changeset(%<%= table_name.classify %>{} = <%= table_name.singularize %>, attrs) do <%= table_name.singularize %> |> cast(attrs, [<%= table_columns.map { |c| \":\" << c[:column_name] }.join(\", \") -%>]) # |> validate_required([<%= table_columns.map { |c| \":\" << c[:column_name] }.join(\", \") -%>]) end end __EOD__ end def configuration(table) { table_name: extract_table_name(table), table_columns: extract_table_columns(table).map do |c| { column_name: extract_column_name(c), column_type: extract_column_type(c), column_option: Hash[extract_column_option(c).map { |o| [extract_option_key(o), extract_option_value(o)] }] } end } end def reject_condition(column) column[:column_name] =~ /\\A(created|updated)_at\\z/ || column[:column_type] == 'index' end end end     sh \n\n> rails db:schema:convert_to_phoenix   \n\næœ€å¾Œã«ã€æ—¢å­˜DBã¸ã¯ã“ã‚“ãªæ„Ÿã˜ã§æ¥ç¶šã—ã¾ã™ã€‚   config \n\n# rails_project/apps/phoenix_app/config/dev.exs config :phoenix_app, PhoenixApp.Repo, adapter: Ecto.Adapters.Postgres, url: System.get_env(\"DATABASE_URL\"), pool_size: 10, ssl: true     sh \n\n> (cd ./apps/phoenix_app/assets && npm install) > mix deps.get > mix phx.server     > ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’è¿½åŠ ãƒ‡ãƒ—ãƒ­ã‚¤ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’è¿½åŠ  \n\nã•ã¦ã€æ—¢å­˜ã®CIï¼ˆWerckerï¼‰ã‚‚æ›´æ–°ã—ã¾ã—ã‚‡ã†ã€‚ä»Šå›ã¯Phoenixé–¢é€£ãƒ–ãƒ©ãƒ³ãƒãŒæ›´æ–°ã•ã‚ŒãŸå ´åˆã«ã®ã¿ã€é–¢é€£ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’èµ°ã‚‰ã›ã‚‹ã‚ˆã†ã«ä¸‹è¨˜ã®ã‚ˆã†ã«å¤‰æ›´ã—ã¾ã—ãŸã€‚ \n\nBEFORE \n\n- build (all branch) deploy.prod (master branch) \n- deploy.prod (master branch) \n\nAFTER \n\n- build (all branch) deploy.prod (master branch) deploy.phoenix.prod (phoenix/base branch) \n- deploy.prod (master branch)\n- deploy.phoenix.prod (phoenix/base branch)   yaml \n\n# wercker.yml deploy-phoenix-prod-heroku: steps: - add-ssh-key: host: github.com keyname: GITHUB - add-to-known_hosts: hostname: github.com fingerprint: 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48 - heroku-deploy: key: $HEROKU_KEY user: $HEROKU_USER app-name: $HEROKU_APP_NAME install-toolbelt: true after-steps: - wantedly/pretty-slack-notify: webhook_url: ${SLACK_WEBHOOK_URL} channel: general     > Herokuã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆHerokuã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ä½œæˆ \n\nåŸºæœ¬ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®èª¬æ˜é€šã‚Šã§ã™ã€‚Phoenix Umbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æ³¨æ„ç‚¹ã¨ã—ã¦ã¯ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®å·®ç•°ãã‚‰ã„ã§ãã‚Œä»¥å¤–ã¯åŒã˜ã§ã™ã€‚ã¤ã¾ã‚Šã€ã“ã‚Œ rails_project/config/prod.exs ã‚’ã“ã† rails_project/apps/phoenix_app/config/prod.exs å¤‰æ›´ã—ã¾ã™ã€‚ \n\n1. Herokuã‚¢ãƒ—ãƒªã«ãƒ“ãƒ«ãƒ‰ãƒ‘ãƒƒã‚¯ã‚’é©ç”¨   sh \n\n> heroku create --buildpack https://github.com/HashNuke/heroku-buildpack-elixir.git > heroku buildpacks:add https://github.com/gjaldon/heroku-buildpack-phoenix-static.git   \n\n2. èµ·å‹•è¨­å®šã‚’æº–å‚™   config \n\n# rails_project/elixir_buildpack.config erlang_version=19.1 elixir_version=1.4.2 always_rebuild=false pre_compile=\"pwd\" post_compile=\"pwd\" runtime_path=/app config_vars_to_export=(DATABASE_URL) config_vars_to_export=(DATABASE_POOL_SIZE)     config \n\n# rails_project/phoenix_static_buildpack.config phoenix_relative_path=apps/phoenix_app     config \n\n# rails_project/Procfile web: MIX_ENV=prod mix phx.server   \n\n3. ç’°å¢ƒå¤‰æ•°ã‚’é©ç”¨ \n\nãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹é–¢é€£ã€‚   config \n\n# rails_project/apps/phoenix_app/config/prod.exs config :phoenix_app, PhoenixApp.Repo, adapter: Ecto.Adapters.Postgres, url: System.get_env(\"DATABASE_URL\"), pool_size: String.to_integer(System.get_env(\"DATABASE_POOL_SIZE\") || 10), ssl: true     sh \n\nheroku config:set DATABASE_URL=foo heroku config:set DATABASE_POOL_SIZE=bar   \n\nã‚¯ãƒ¬ãƒ‡ãƒ³ã‚·ãƒ£ãƒ«é–¢é€£ã€‚   sh \n\n> heroku config:set HEROKU_API_KEY=$(heroku auth:token) > heroku config:set SECRET_KEY_BASE=$(mix phx.gen.secret)     > WRAPUPWRAPUP \n\nå¤§æ ã¯æƒ³å®šé€šã‚Šã™ã‚“ãªã‚Šé€²ã‚ã‚‹ã“ã¨ãŒå‡ºæ¥ã¾ã—ãŸãŒã€èª²é¡Œã‚‚ã„ãã¤ã‹å‡ºã¦ãã¾ã—ãŸã€‚ã¾ãšã¯èªè¨¼æ©Ÿèƒ½ã€‚ã“ã¡ã‚‰ã¯æ¬¡å›ã®ãƒ†ãƒ¼ãƒã§å–ã‚Šä¸Šã’ã‚ˆã†ã¨æ€ã„ã¾ã™ãŒã€Railsã®èªè¨¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã»ã©å……å®Ÿã—ã¦ã„ãªã„ã®ã§è‡ªå‰ã§ã„ãã¤ã‹ç”¨æ„ã™ã‚‹å¿…è¦ãŒã‚ã‚Šãã†ã§ã™ã€‚æ¬¡ã«ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã€‚ã“ã‚Œã¯å…ƒã®Railsã®å®Ÿè£…ãŒæ‚ªã‹ã£ãŸã®ã§è‡´ã—æ–¹ãªã„ã®ã§ã™ãŒã€ç§»æ¤ã™ã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã‚Šãã†ã§ã™ã€‚å…ˆã«Railså´ã‚’æ•´ç†ã—ã¦ã‹ã‚‰é€²ã‚ãŸæ–¹ãŒè‰¯ã„ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚"},"name":"[2018-01-08]é€£è¼‰ Rails2Phoenix 1 Umbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Herokuã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹","tags":["phoenix-framework","elixir","ruby-on-rails","ruby","wercker","heroku"],"childPublishedDate":{"published_on":"2018-01-08T00:00:00.000Z","published_on_unix":1515369600}}},{"node":{"number":63,"relative_category":"blog/frontend","fields":{"title":"ã‚¤ã‚±ã¦ã‚‹ã—ãƒ¤ãƒã„è¨€èªREBOLã®å¾Œç¶™Redã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚½ãƒ•ãƒˆã‚’ã¤ãã£ãŸè©±","excerpt":"Redã¨ã„ã†è¨€èªã¯ã”å­˜ã˜ã§ã—ã‚‡ã†ã‹ã€‚å¯èª­æ€§ãŒé«˜ã„ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚’æŒã¡ã€ãƒ¯ãƒ³ãƒã‚¤ãƒŠãƒªãƒ¼ã‚’ã‚¯ãƒ­ã‚¹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã§ãã€ã‹ã¤ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆç”¨ã®UIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‚’æ¨™æº–ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«å‚™ãˆãŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã§ã™ã€‚ãã®é‡å¿ƒçš„ãªæŒ‘æˆ¦ã«ã™ãã«è™œã«ãªã‚Šã¾ã—ãŸã€‚æ–°å¹´æ—©ã€…ã®æ‹ã§ã™ã€‚   > PROBLEMPROBLEM \n\n- ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ç”¨ã®ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚½ãƒ•ãƒˆã‚’ã¤ãã‚‹ã«ã‚ãŸã‚Š é‡ãŸã„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒå¤šã„ æ±ç”¨çš„ãªè¨€èªã‚’ã¤ã‹ã£ã¦ã‚‹ã‚‚ã®ãŒå¤šãã€ãã®ãŸã‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¼ç­‰ã®ä¾å­˜é–¢ä¿‚ãŒå¤šããªã‚Šã‚„ã™ã„ \n- é‡ãŸã„ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒå¤šã„\n- æ±ç”¨çš„ãªè¨€èªã‚’ã¤ã‹ã£ã¦ã‚‹ã‚‚ã®ãŒå¤šãã€ãã®ãŸã‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ¼ç­‰ã®ä¾å­˜é–¢ä¿‚ãŒå¤šããªã‚Šã‚„ã™ã„   > SOLUTIONSOLUTION \n\nã¨ã„ã†ã‚ã‘ã§ã€å¹´æ˜ã‘è¦‹ã¤ã‘ãŸRedãŒã‚·ãƒ³ãƒ—ãƒ«ã ã£ãŸã®ã§ä½¿ã£ã¦ã¿ã¾ã—ãŸã€‚é¡Œæã¯ä»¥å‰ã¤ãã£ãŸEmacsãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€Œesa.elã€ã®ç§»æ¤ã§ã™ã€‚ \n\n- ä»Šå›ä½œã£ãŸã‚³ãƒ¼ãƒ‰ https://github.com/nabinno/esa.red    > ã‚„ã£ãŸã“ã¨ã‚„ã£ãŸã“ã¨   > ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ \n\næ§‹æ–‡ãŒã™ãªãŠãªã®ã§ç‰¹ã«ã‚¨ãƒ‡ã‚£ã‚¿ã¯é–¢ä¿‚ãªã•ãã†ã§ã—ãŸãŒã€æ…£ã‚Œè¦ªã—ã‚“ã§ã‚‹Emacsã«ã€ŒSkrylar/red.elã€ã‚’é©ç”¨ã—ã¾ã—ãŸã€‚ãã®éš›ã€ red-font-lock-keywords ã¨ red-indent-line ã«è¶³ã‚Šãªã„ç®‡æ‰€ãŒã‚ã£ãŸã®ã§ã‚ªãƒ¼ãƒãƒ¼ãƒ©ã‚¤ãƒ‰ã—ã¾ã—ãŸã€‚   > ç³–è¡£æ§‹æ–‡ã®é©ç”¨ç³–è¡£æ§‹æ–‡ã®é©ç”¨ \n\nRedã¯ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³REPLãŒã¤ã‹ãˆã‚‹ã®ã§ã€ docs.red-lang.org ã¨Red by Exampleã‚’ã¿ãªãŒã‚‰ã²ã¨ã¤ã²ã¨ã¤æŒ™å‹•ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚ãã®ä¸­ã§ã©ã†ã—ã¦ã‚‚æ…£ã‚Œãªã„è¡¨ç¾ãŒ2ã¤ã‚ã£ãŸã®ã§ç³–è¡£æ§‹æ–‡ã‚’å®Ÿè£…ã—ã¾ã—ãŸã€‚ \n\n- å®Ÿè£…ã—ãŸç³–è¡£æ§‹æ–‡ nabinno/red-elixir  \n\n1. compose \n\nãƒ–ãƒ­ãƒƒã‚¯å†…ã®å¤‰æ•°ã‚’è©•ä¾¡ã—ãƒ–ãƒ­ãƒƒã‚¯ã¨ã—ã¦è¿”ã™é–¢æ•° compose ã¯ã€VIDã®ãƒ•ã‚§ã‚¤ã‚¹æ›´æ–°ã«ã‚ˆãä½¿ã‚ã‚Œã¾ã™ã€‚HTML/JavaScripã§ã„ã†ã¨ã“ã‚DOMæ›´æ–°ã«ã‚ãŸã‚‹ã‚‚ã®ã¨ã„ãˆã°åˆ†ã‹ã‚‹ã§ã—ã‚‡ã†ã‹ã€‚é »ç¹ã«ã€Œ compose [foo (bar)] ã€ã®ã‚ˆã†ãªè¡¨ç¾ãŒã¤ã¥ãã¨ã»ã‹ã®å¤‰æ•°ã‚„é–¢æ•°ã¨ã¾ã–ã‚Šå¯èª­æ€§ãŒãŠã¡ã‚‹ã®ã§ã€Elixirã®ã‚·ã‚¸ãƒ«ã‚’å‚è€ƒã« compose é–¢æ•°ã‚’çœç•¥ã—ã¾ã—ãŸã€‚ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚ \n\n;-- before compose [foo (bar)] ;-- after ~c[foo (bar)]  \n\n2. é–¢æ•°ã®å…¥ã‚Œå­ \n\nç´ ã®Redã¯ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚¿ãƒ¼æ§‹æ–‡ãªã®ã§ã€é–¢æ•°ã®å…¥ã‚Œå­ã«ã‚ˆã‚‹å¯èª­æ€§ä½ä¸‹ã‚’ãŠã•ãˆã‚‹ãŸã‚å¤‰æ•°å®šç¾©ã‚’ã‚ˆãä½¿ã„ã¾ã™ã€‚å€‹äººçš„ã«ã¯å¤‰æ•°ã¯æ„å‘³ã®ã‚ã‚‹ã‚‚ã®ã ã‘ä½¿ã„ãŸã„æ´¾ãªã®ã§ã€ãƒ‘ã‚¤ãƒ—ã‚’å°å…¥ã—ã¾ã—ãŸã€‚ã¨ã„ã£ã¦ã‚‚ã€ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã®å ´åˆã€ãƒ‡ãƒ¼ã‚¿åŠ å·¥ã¯ã‚ã¾ã‚Šã‚„ã‚‰ãªã„ã®ã§ã¤ã‹ã†ã‚±ãƒ¼ã‚¹ã¯ã»ã¼ã‚ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚ã‚ã£ã¦ã‚‚ã“ã®ãã‚‰ã„ã§ã™ã€‚   red \n\n;-- before rejoin collect [ foreach d data [ keep rejoin [d \" \"] ] ] ;-- after data .[ |> Series/map 'd [rejoin [d \" \"]] |> rejoin ]     > ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã®ç”¨æ„ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã®ç”¨æ„ \n\nä»Šå›ã¯ä¸Šã§å®Ÿè£…ã—ãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€Œred-elixirã€ã®ã»ã‹ã«HTTPãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ»JSONãƒ‘ãƒ¼ã‚µãƒ¼ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚ãƒ©ã‚¤ãƒ–ãƒ©ãƒªãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¯git submodulesã§è‰¯ã„ã§ã™ãŒã€å‘¼ã³å‡ºã—ã‚‚è€ƒãˆã‚‹ã¨å®Ÿè£…ãŒå†—é•·çš„ã«ãªã‚‹ã®ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ã¨ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã‚’ã‚ã‚ã›ã¦ç”¨æ„ã—ã¾ã—ãŸï¼ˆnabinno/hotã€nabinno/modsï¼‰ã€‚ \n\nã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å¾Œã€ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‹ã‚‰å‘¼ã³å‡ºã—ã¾ã§ã®æµã‚Œ \n\nRedã¯Goã¨ãŠãªã˜ããƒ¯ãƒ³ãƒã‚¤ãƒŠãƒªãƒ¼ãªã®ã§ã€wgetã‚„curlã ã‘ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãŒå®Œäº†ã—ã¾ã™ã€‚   sh \n\n> mkdir -p ~/.local/bin > wget https://github.com/nabinno/hot/releases/download/0.0.3/hot-linux -O ~/.local/bin/hot > chmod 744 ~/.local/bin/hot   \n\nãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ç®¡ç†ã¯Elixirã®mixã‚’å‚è€ƒã«ã‚¿ã‚¹ã‚¯ãƒ©ãƒ³ãƒŠãƒ¼ç®¡ç†ãƒ•ã‚¡ã‚¤ãƒ«å†…ã«å®šç¾©ã—ã¾ã™ã€‚   sh \n\n> hot cmd/install https://raw.githubusercontent.com/nabinno/mods/master/mods.red > cat hots.red Red [] hots: context [ mods: [ red-elixir #(init: %init.red git: https://github.com/nabinno/red-elixir) json #(init: %json.red git: https://github.com/rebolek/red-tools) http-tools #(init: %http-tools.red git: https://github.com/rebolek/red-tools) ] ] > hot mods/get   \n\nãƒ“ãƒ«ãƒ‰æ™‚ã¯ #include ã‚’ã¤ã‹ã†ã®ã§ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å‘¼ã³å‡ºã—æ©Ÿèƒ½ã¯ä½¿ãˆãªã„ã§ã™ãŒã€ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³REPLã§æŒ™å‹•ç¢ºèªã—ã¦ã„ã‚‹éš›ã¯ do/args %require ã‚’ä½¿ã„ã¾ã™ã€‚   sh \n\n> red >> do/args %require [red-elixir] >> 1 .. 10 .[ |> Series/map 'i [i * 2] |> Series/map 'i [i + 1] ] == [3 5 7 9 11 13 15 17 19 21]     > WRAPUPWRAPUP \n\nã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚½ãƒ•ãƒˆã‚’ä½œã‚‹ä¸­ã§æ„Ÿã˜ãŸã“ã¨ã¯ã€ã“ã®1ç‚¹ã§ã™ã€‚Redã¯æ—¢å­˜ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã¨æ¯”ã¹ã‚‹ã¨ã¾ã ã¾ã æ©Ÿèƒ½ä¸è¶³æ„ŸãŒæ‹­ãˆã¾ã›ã‚“ãŒã€ãã‚Œã‚’è£œãˆã‚‹ã ã‘ã®è¡¨ç¾åŠ›ã‚’æŒã£ã¦ã„ã¾ã—ãŸã€‚æ‰‹è§¦ã‚ŠãŒæœ¬å½“ã«è‰¯ã„è¨€èªã§ã—ãŸã€‚"},"name":"[2019-03-31]ã‚¤ã‚±ã¦ã‚‹ã—ãƒ¤ãƒã„è¨€èªREBOLã®å¾Œç¶™Redã§ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‚½ãƒ•ãƒˆã‚’ã¤ãã£ãŸè©±","tags":["red","esa"],"childPublishedDate":{"published_on":"2019-03-31T00:00:00.000Z","published_on_unix":1553990400}}}]}},"pageContext":{"number":56}},"staticQueryHashes":[]}