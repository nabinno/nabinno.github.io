{"componentChunkName":"component---src-templates-post-tsx","path":"/posts/62","result":{"data":{"esaPost":{"number":62,"relative_category":"blog/backend","fields":{"title":"Elixirã§ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯","excerpt":"ç´†ä½™æ›²æŠ˜åˆã£ã¦ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã®é‹ç”¨ã‚’è¦‹ç›´ã™å¿…è¦ãŒå‡ºã¦ãã¾ã—ãŸã€‚äººã®èˆˆå‘³ã¨ã„ã†ã®ã¯å°½ããªã„ã‚‚ã®ã§çŸ¥ã‚ŠãŸã„ã“ã¨ãŒæ¬¡ã€…å‡ºã¦ãã¾ã™ã€‚ã«ã‚‚æ‹˜ã‚ã‚‰ãšäººã®æ™‚é–“ã¯æœ‰é™ã§ãã‚Œã«ã‚ãŒãªã†ãŸã‚ã®æ‰‹æ®µã‚’è€ƒãˆãŸã‚ã‘ã§ã™ã€‚   > PROBLEMPROBLEM \n\n- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ€ãƒ¼ã§è¨˜äº‹ã‚’èª­ã‚“ã å¾Œã«ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ï¼ˆãƒ–ã‚¯ãƒï¼‰ã™ã‚‹ã¨ãƒ•ã‚£ãƒ¼ãƒ‰æ¶ˆåŒ–ã™ã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹ ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾ãƒ–ã‚¯ãƒã—ã¦ã„ã‚‹ã¨ä¸‹è¨˜ã®å•é¡ŒãŒã§ã¦ãã‚‹ ã‚ã¨ã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ããªã„ èª­ã¿ãŸããªã„è¨˜äº‹ã‚’ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã† é©åˆ‡ã§ãªã„URLã§ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã† \n- ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾ãƒ–ã‚¯ãƒã—ã¦ã„ã‚‹ã¨ä¸‹è¨˜ã®å•é¡ŒãŒã§ã¦ãã‚‹ ã‚ã¨ã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ããªã„ èª­ã¿ãŸããªã„è¨˜äº‹ã‚’ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã† é©åˆ‡ã§ãªã„URLã§ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã† \n- ã‚ã¨ã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ããªã„\n- èª­ã¿ãŸããªã„è¨˜äº‹ã‚’ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã†\n- é©åˆ‡ã§ãªã„URLã§ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã†   > SOLUTIONSOLUTION \n\nã¨ã„ã†ã‚ã‘ã§ã€ä¸‹è¨˜ã®æ–¹é‡ã§ãƒ–ã‚¯ãƒã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚è¨­ç½®æ–¹æ³•ã®è©³ç´°ã¯GitHubãƒ¬ãƒã‚¸ãƒˆãƒªã‚’å‚ç…§ãã ã•ã„ã€‚ãã—ã¦ã€æ–¹é‡ã¯ä¸‹è¨˜ã®é€šã‚Šã«ãªã‚Šã¾ã™ã€‚ \n\næ–¹é‡ \n\n- ãƒ•ã‚£ãƒ¼ãƒ‰ã”ã¨ã«ã‚¿ã‚°ã¥ã‘ã™ã‚‹\n- ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹è¨˜äº‹ã‚’ãƒªãƒ³ã‚¯ã¨ã‚¿ã‚¤ãƒˆãƒ«ã§é™¤å¤–åˆ¤å®šã™ã‚‹\n- ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹è¨˜äº‹ã‚’ãƒªãƒ³ã‚¯ã‹ã‚‰æ ¡æ­£ã™ã¹ãã‚‚ã®ã‹ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã¹ãã‚‚ã®ã‹åˆ¤å®šã™ã‚‹\n- ä¸Šè¨˜è¨­å®šã¯YAMLãƒ•ã‚¡ã‚¤ãƒ«ã§ç°¡å˜ã«ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\n- ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼ã¨ãƒ–ã‚¯ãƒã‚’éåŒæœŸå‡¦ç†ã§ãã‚‹ã‚ˆã†Elixirã§å®Ÿè£…ã™ã‚‹   > ãƒ–ã‚¯ãƒã®ç®¡ç†æ–¹æ³•ãƒ–ã‚¯ãƒã®ç®¡ç†æ–¹æ³• \n\nã¾ãšãƒ–ã‚¯ãƒã®ç®¡ç†ã§ã™ãŒã€ä¸‹è¨˜5ã¤ã®YAMLãƒ•ã‚¡ã‚¤ãƒ«ã§æ§‹æˆã—ã¦ã„ã¾ã™ã€æ§‹é€ ã¯ãƒãƒƒãƒ—ã¨ãƒªã‚¹ãƒˆã®ã¿ã€‚ãƒ–ã‚¯ãƒã—ãŸã„ã¨æ€ã†è¨˜äº‹ã‚’èª­ã¿ã™ã™ã‚ã‚‹ä¸­ã§æ°—ã«ãªã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå‡ºã¦ããŸã‚‰éƒ½åº¦ feed.yaml ã‚’æ›´æ–°ã—ã¾ã™ã€‚ã¾ãŸã€è¨˜äº‹ã«ãƒã‚¤ã‚ºãŒå¤šã„ã‚ˆã†ã ã£ãŸã‚‰å‚¾å‘ã‚’åˆ†æã—ã¦é™¤å¤–ãƒ•ã‚¡ã‚¤ãƒ« feed_excluded_link.yaml feed_excluded_title.yaml ã‚’æ›´æ–°ã—ã¾ã™ã€‚    item description     feed.yaml ãƒ•ã‚£ãƒ¼ãƒ‰ã‚°ãƒ«ãƒ¼ãƒ—åã«å¯¾ã™ã‚‹ãƒªãƒ³ã‚¯ã€ã‚¿ã‚°ã®ãƒãƒƒãƒ—   feed_excluded_link.yaml é™¤å¤–ã™ã¹ããƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã®ãƒªã‚¹ãƒˆ   feed_excluded_title.yaml é™¤å¤–ã™ã¹ããƒ•ã‚£ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒªã‚¹ãƒˆ   feed_corrected_link.yaml ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã«å¯¾ã™ã‚‹ãƒˆãƒªãƒŸãƒ³ã‚°ã™ã¹ããƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒƒãƒ—   feed_redirected_link.yaml ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã«å¯¾ã™ã‚‹ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆãƒªãƒ³ã‚¯ã®ãƒãƒƒãƒ—      yaml \n\n# feed.yaml nabinno/sports/feed_group_name: tags: - ski links: - http://rss.example.com/ski_feed.rss - http://rss.example.com/snowboard_feed.rss - http://ski-status.example.com/rss # feed_excluded_link.yaml - anti-ski.example.com - awesome-snowboard.example.com # feed_excluded_title.yaml - queer - two-planker - beaver-tail # feed_corrected_link.yaml amazon.com: - ref - ie # feed_redirected_link.yaml ski-status.example.com: - Floki.find(fst, \".post__body a\")     > Elixirã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†Elixirã«ã‚ˆã‚‹éåŒæœŸå‡¦ç† \n\nElixirã§éåŒæœŸå‡¦ç†ã‚’è¡Œã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€å¤§ããåˆ†ã‘ã¦ç›£è¦–æ©Ÿæ§‹ã®Supervisorã¨éåŒæœŸå‡¦ç†ã®Task.async_streamã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚   > ç›£è¦–æ©Ÿæ§‹ Supervisorç›£è¦–æ©Ÿæ§‹ Supervisor \n\nã¾ãšã€Supervisorã€‚Elixirã«ã¯ç›£è¦–æ©Ÿæ§‹SupervisorãŒã‚ã‚Šã€ãã‚ŒãŒå„ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’å­ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚ã“ã“ã§ã¯ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼ã¨ãƒ–ã‚¯ãƒã¯åˆ¥ã€…ã®ãƒ¯ãƒ¼ã‚«ãƒ¼ã§å‡¦ç†ã—ã¾ã™ãŒã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæš–æ°—å‡¦ç†ã‚’åˆ¥ãƒ¯ãƒ¼ã‚«ãƒ¼ã§è¡Œã£ã¦ã„ã‚‹ãŸã‚å†èµ·å‹•æˆ¦ç•¥ã¯ã€Œå¤±æ•—ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­ã«ã‚ã‚‹ã™ã¹ã¦ã®å­ãƒ—ãƒ­ã‚»ã‚¹ã‚’å†èµ·å‹•ã€ï¼ˆ one_for_all ï¼‰ã«ã—ã¦ã‚ã‚Šã¾ã™ã€‚å†èµ·å‹•æˆ¦ç•¥ã®è©³ç´°ã¯ã€ŒOTPã‚¹ãƒ¼ãƒ‘ãƒã‚¤ã‚¶ Â· Elixir Schoolã€ã‚’å‚ç…§ä¸‹ã•ã„ã€‚ \n\nä¸‹è¨˜ã®ã‚ˆã†ã« Supervisor.start_link ã‚’ Keshikimi2.Application.start ã«é©ç”¨ã™ã‚‹ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ï¼ˆ mix run ï¼‰ã—ãŸæ™‚ç‚¹ã§ç›£è¦–æ©Ÿæ§‹ãŒèµ·å‹•ã•ã‚Œã¾ã™ã€‚   ex \n\nSupervisor.start_link( [ :hackney_pool.child_spec(:hatena_bookmark_pool, timeout: 15_000, max_connections: 100), # @todo å½“è©²ãƒ¯ãƒ¼ã‚«ãƒ¼ã§æš–æ°—å‡¦ç†ã‚’è¡Œã£ã¦ã„ãªã„ã®ã§ `one_for_one` ã«ã—ãŸå ´åˆã€å†èµ·å‹•æ™‚ã«ã»ã‹ã«å½±éŸ¿ã™ã‚‹ supervisor(Cachex, [:feed, []]), supervisor(Keshikimi2Feed.Registry, [prefix]), # ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼å‡¦ç† (PubSub) supervisor(Keshikimi2Feed.Subscriber, [prefix]), worker(Keshikimi2Feed.Worker, [prefix]), worker(Keshikimi2Feed.Publisher, [[prefix: prefix, poll_interval: 3_000]]), # ãƒ–ã‚¯ãƒå‡¦ç† worker(Keshikimi2.HatenaBookmark.AddEntry, [ [prefix: prefix, poll_interval: 3_000] ]) ], strategy: :one_for_all, name: name(prefix) )     > éåŒæœŸå‡¦ç† Task.async_streaméåŒæœŸå‡¦ç† Task.async_stream \n\næ¬¡ã«ã€Task.async_streamã€‚é…åˆ—ã‚’å¼•ãå›ã™ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ã¯ Task.async_stream ãŒã†ã£ã¦ã¤ã‘ã§ã™ã€‚ä¸‹è¨˜ã§ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã‚’å–ã‚Šå‡ºã—ã€é™¤å¤–å‡¦ç†ã€æ ¡æ­£å‡¦ç†ã‚’åŠ ãˆã¦ã€ãƒ–ã‚¯ãƒã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡ºã™ã¨ã„ã†æµã‚Œã‚’çµ„ã‚“ã§ã„ã¾ã™ã€‚Elixirã§ã¯ã€æµã‚Œã‚’ã²ã¨ã¾ã¨ã‚ã«ã—ã¦è¦–è¦šçš„ã«ã‚ã‹ã‚Šã‚„ã™ãéåŒæœŸå‡¦ç†ã—ã¦ãã“ã¨ãŒã§ãã¾ã™ã€‚   ex \n\nCachex.keys!(:feed) |> Enum.reject(fn key -> key in [ \"excluded_links\", \"excluded_titles\", \"corrected_links\", \"redirected_links\", \"feed_group\", \"archived_links\" ] end) |> Task.async_stream( fn item_link -> with {:ok, [item_title, feed_tags]} <- Cachex.get(:feed, item_link), :ok <- validate_all(item_link, item_title), corrected_link <- correct_all(item_link), {:ok, payload} <- FormData.create( %{ url: corrected_link, comment: feed_tags |> Enum.map_join(fn tag -> \"[#{tag}]\" end), rks: System.get_env(\"HATENA_BOOKMARK_RKS\"), private: 0, keep_original_url: 1, with_status_op: 1, from: \"inplace\", post_twitter: 0, post_evernote: 0 }, :url_encoded, get: false ) do do_add_entries_to_hb(payload) Logger.info(\"add entry: #{item_link}\") end archive_link(item_link) end, timeout: 15_000 ) |> Stream.run()     > WRAPUPWRAPUP \n\nElixirã®éåŒæœŸå‡¦ç†ã‚’ä½¿ã†ã“ã¨ã§ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã®é‹ç”¨ãŒã¨ã¦ã‚‚å¿«é©ã«ãªã‚Šã¾ã—ãŸã€‚ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã¨ã®ä»Šå¾Œã®ä»˜ãåˆã„æ–¹ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«è€ƒãˆã¦ã„ã¾ã™ã€‚ \n\n- æ‰‹å‹•ã§ãƒ–ã‚¯ãƒ: æ°—ã«ãªã£ãŸè¨˜äº‹ãŒã‚ã‚‹ã”ã¨ã«\n- ãƒ–ã‚¯ãƒã®ç¢ºèª: æ°—ã«ãªã‚‹ã‚¿ã‚°ã”ã¨ã«ã¾ã¨ã‚ã¦ç¢ºèª \n\nãƒ–ã‚¯ãƒã®ç¢ºèªã«ã¤ã„ã¦ã¯ã€ä¾‹ãˆã°ã€CIã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã„ã‚‹é–“ã«æœ€è¿‘ã®GitHubã®å‹•å‘ã‚’ç¢ºèªã—ãŸã„å ´åˆã¯ã€Œnabinno/githubã€ã‚’ã¿ã‚‹ã€ã¨ã„ã†æ„Ÿã˜ã®é‹ç”¨ã§ã™ã€‚ \n\nèé€šãŒåˆ©ã‹ãªã„ç‚¹ã§é€”ä¸­é‹ç”¨ãŒé›£ã—ããªã‚‹æ°—ã‚‚ã—ã¾ã™ãŒã€ã—ã°ã‚‰ãå›ã—ã¦ã¿ã¾ã™ã€‚","thumbnail":"https://raw.githubusercontent.com/nabinno/keshikimi2/master/priv/img/diagram.png"},"wip":false,"body_md":"<img alt=thumbnail src=https://raw.githubusercontent.com/nabinno/keshikimi2/master/priv/img/diagram.png />\r\n\r\nç´†ä½™æ›²æŠ˜åˆã£ã¦ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã®é‹ç”¨ã‚’è¦‹ç›´ã™å¿…è¦ãŒå‡ºã¦ãã¾ã—ãŸã€‚äººã®èˆˆå‘³ã¨ã„ã†ã®ã¯å°½ããªã„ã‚‚ã®ã§çŸ¥ã‚ŠãŸã„ã“ã¨ãŒæ¬¡ã€…å‡ºã¦ãã¾ã™ã€‚ã«ã‚‚æ‹˜ã‚ã‚‰ãšäººã®æ™‚é–“ã¯æœ‰é™ã§ãã‚Œã«ã‚ãŒãªã†ãŸã‚ã®æ‰‹æ®µã‚’è€ƒãˆãŸã‚ã‘ã§ã™ã€‚\r\n\r\n# PROBLEM\r\n- ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ€ãƒ¼ã§è¨˜äº‹ã‚’èª­ã‚“ã å¾Œã«ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ï¼ˆãƒ–ã‚¯ãƒï¼‰ã™ã‚‹ã¨ãƒ•ã‚£ãƒ¼ãƒ‰æ¶ˆåŒ–ã™ã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹\r\n    - ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾ãƒ–ã‚¯ãƒã—ã¦ã„ã‚‹ã¨ä¸‹è¨˜ã®å•é¡ŒãŒã§ã¦ãã‚‹\r\n        - ã‚ã¨ã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ããªã„\r\n        - èª­ã¿ãŸããªã„è¨˜äº‹ã‚’ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã†\r\n        - é©åˆ‡ã§ãªã„URLã§ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã†\r\n\r\n# SOLUTION\r\nã¨ã„ã†ã‚ã‘ã§ã€ä¸‹è¨˜ã®æ–¹é‡ã§ãƒ–ã‚¯ãƒã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚è¨­ç½®æ–¹æ³•ã®è©³ç´°ã¯[GitHubãƒ¬ãƒã‚¸ãƒˆãƒª](https://github.com/nabinno/keshikimi2)ã‚’å‚ç…§ãã ã•ã„ã€‚ãã—ã¦ã€æ–¹é‡ã¯ä¸‹è¨˜ã®é€šã‚Šã«ãªã‚Šã¾ã™ã€‚\r\n\r\n**æ–¹é‡**\r\n\r\n- ãƒ•ã‚£ãƒ¼ãƒ‰ã”ã¨ã«ã‚¿ã‚°ã¥ã‘ã™ã‚‹\r\n- ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹è¨˜äº‹ã‚’ãƒªãƒ³ã‚¯ã¨ã‚¿ã‚¤ãƒˆãƒ«ã§é™¤å¤–åˆ¤å®šã™ã‚‹\r\n- ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹è¨˜äº‹ã‚’ãƒªãƒ³ã‚¯ã‹ã‚‰æ ¡æ­£ã™ã¹ãã‚‚ã®ã‹ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã¹ãã‚‚ã®ã‹åˆ¤å®šã™ã‚‹\r\n- ä¸Šè¨˜è¨­å®šã¯YAMLãƒ•ã‚¡ã‚¤ãƒ«ã§ç°¡å˜ã«ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹\r\n- ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼ã¨ãƒ–ã‚¯ãƒã‚’éåŒæœŸå‡¦ç†ã§ãã‚‹ã‚ˆã†Elixirã§å®Ÿè£…ã™ã‚‹\r\n\r\n## ãƒ–ã‚¯ãƒã®ç®¡ç†æ–¹æ³•\r\nã¾ãšãƒ–ã‚¯ãƒã®ç®¡ç†ã§ã™ãŒã€ä¸‹è¨˜5ã¤ã®YAMLãƒ•ã‚¡ã‚¤ãƒ«ã§æ§‹æˆã—ã¦ã„ã¾ã™ã€æ§‹é€ ã¯ãƒãƒƒãƒ—ã¨ãƒªã‚¹ãƒˆã®ã¿ã€‚ãƒ–ã‚¯ãƒã—ãŸã„ã¨æ€ã†è¨˜äº‹ã‚’èª­ã¿ã™ã™ã‚ã‚‹ä¸­ã§æ°—ã«ãªã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå‡ºã¦ããŸã‚‰éƒ½åº¦ `feed.yaml` ã‚’æ›´æ–°ã—ã¾ã™ã€‚ã¾ãŸã€è¨˜äº‹ã«ãƒã‚¤ã‚ºãŒå¤šã„ã‚ˆã†ã ã£ãŸã‚‰å‚¾å‘ã‚’åˆ†æã—ã¦é™¤å¤–ãƒ•ã‚¡ã‚¤ãƒ« `feed_excluded_link.yaml` `feed_excluded_title.yaml` ã‚’æ›´æ–°ã—ã¾ã™ã€‚\r\n\r\n| item                        | description                                              |\r\n|-----------------------------|----------------------------------------------------------|\r\n| `feed.yaml`                 | ãƒ•ã‚£ãƒ¼ãƒ‰ã‚°ãƒ«ãƒ¼ãƒ—åã«å¯¾ã™ã‚‹ãƒªãƒ³ã‚¯ã€ã‚¿ã‚°ã®ãƒãƒƒãƒ—           |\r\n| `feed_excluded_link.yaml`   | é™¤å¤–ã™ã¹ããƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã®ãƒªã‚¹ãƒˆ                         |\r\n| `feed_excluded_title.yaml`  | é™¤å¤–ã™ã¹ããƒ•ã‚£ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒªã‚¹ãƒˆ                       |\r\n| `feed_corrected_link.yaml`  | ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã«å¯¾ã™ã‚‹ãƒˆãƒªãƒŸãƒ³ã‚°ã™ã¹ããƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒƒãƒ— |\r\n| `feed_redirected_link.yaml` | ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã«å¯¾ã™ã‚‹ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆãƒªãƒ³ã‚¯ã®ãƒãƒƒãƒ—       |\r\n\r\n```yaml\r\n# feed.yaml\r\nnabinno/sports/feed_group_name:\r\n  tags:\r\n    - ski\r\n  links:\r\n    - http://rss.example.com/ski_feed.rss\r\n    - http://rss.example.com/snowboard_feed.rss\r\n    - http://ski-status.example.com/rss\r\n\r\n# feed_excluded_link.yaml\r\n- anti-ski.example.com\r\n- awesome-snowboard.example.com\r\n\r\n# feed_excluded_title.yaml\r\n- queer\r\n- two-planker\r\n- beaver-tail\r\n\r\n# feed_corrected_link.yaml\r\namazon.com:\r\n  - ref\r\n  - ie\r\n\r\n# feed_redirected_link.yaml\r\nski-status.example.com:\r\n  - Floki.find(fst, \".post__body a\")\r\n```\r\n\r\n## Elixirã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†\r\nElixirã§éåŒæœŸå‡¦ç†ã‚’è¡Œã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€å¤§ããåˆ†ã‘ã¦ç›£è¦–æ©Ÿæ§‹ã®Supervisorã¨éåŒæœŸå‡¦ç†ã®Task.async_streamã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚\r\n\r\n### ç›£è¦–æ©Ÿæ§‹ Supervisor\r\nã¾ãšã€Supervisorã€‚Elixirã«ã¯ç›£è¦–æ©Ÿæ§‹SupervisorãŒã‚ã‚Šã€ãã‚ŒãŒå„ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’å­ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚ã“ã“ã§ã¯ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼ã¨ãƒ–ã‚¯ãƒã¯åˆ¥ã€…ã®ãƒ¯ãƒ¼ã‚«ãƒ¼ã§å‡¦ç†ã—ã¾ã™ãŒã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæš–æ°—å‡¦ç†ã‚’åˆ¥ãƒ¯ãƒ¼ã‚«ãƒ¼ã§è¡Œã£ã¦ã„ã‚‹ãŸã‚å†èµ·å‹•æˆ¦ç•¥ã¯ã€Œå¤±æ•—ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­ã«ã‚ã‚‹ã™ã¹ã¦ã®å­ãƒ—ãƒ­ã‚»ã‚¹ã‚’å†èµ·å‹•ã€ï¼ˆ `one_for_all` ï¼‰ã«ã—ã¦ã‚ã‚Šã¾ã™ã€‚å†èµ·å‹•æˆ¦ç•¥ã®è©³ç´°ã¯ã€Œ[OTPã‚¹ãƒ¼ãƒ‘ãƒã‚¤ã‚¶ Â· Elixir School](https://elixirschool.com/ja/lessons/advanced/otp-supervisors/)ã€ã‚’å‚ç…§ä¸‹ã•ã„ã€‚\r\n\r\nä¸‹è¨˜ã®ã‚ˆã†ã« `Supervisor.start_link` ã‚’ `Keshikimi2.Application.start` ã«é©ç”¨ã™ã‚‹ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ï¼ˆ `mix run` ï¼‰ã—ãŸæ™‚ç‚¹ã§ç›£è¦–æ©Ÿæ§‹ãŒèµ·å‹•ã•ã‚Œã¾ã™ã€‚\r\n\r\n```ex\r\nSupervisor.start_link(\r\n  [\r\n    :hackney_pool.child_spec(:hatena_bookmark_pool, timeout: 15_000, max_connections: 100),\r\n    # @todo å½“è©²ãƒ¯ãƒ¼ã‚«ãƒ¼ã§æš–æ°—å‡¦ç†ã‚’è¡Œã£ã¦ã„ãªã„ã®ã§ `one_for_one` ã«ã—ãŸå ´åˆã€å†èµ·å‹•æ™‚ã«ã»ã‹ã«å½±éŸ¿ã™ã‚‹\r\n    supervisor(Cachex, [:feed, []]),\r\n    supervisor(Keshikimi2Feed.Registry, [prefix]),\r\n\r\n    # ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼å‡¦ç† (PubSub)\r\n    supervisor(Keshikimi2Feed.Subscriber, [prefix]),\r\n    worker(Keshikimi2Feed.Worker, [prefix]),\r\n    worker(Keshikimi2Feed.Publisher, [[prefix: prefix, poll_interval: 3_000]]),\r\n\r\n    # ãƒ–ã‚¯ãƒå‡¦ç†\r\n    worker(Keshikimi2.HatenaBookmark.AddEntry, [\r\n      [prefix: prefix, poll_interval: 3_000]\r\n    ])\r\n  ],\r\n  strategy: :one_for_all,\r\n  name: name(prefix)\r\n)\r\n```\r\n\r\n### éåŒæœŸå‡¦ç† Task.async_stream\r\næ¬¡ã«ã€Task.async_streamã€‚é…åˆ—ã‚’å¼•ãå›ã™ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ã¯ `Task.async_stream` ãŒã†ã£ã¦ã¤ã‘ã§ã™ã€‚ä¸‹è¨˜ã§ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã‚’å–ã‚Šå‡ºã—ã€é™¤å¤–å‡¦ç†ã€æ ¡æ­£å‡¦ç†ã‚’åŠ ãˆã¦ã€ãƒ–ã‚¯ãƒã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡ºã™ã¨ã„ã†æµã‚Œã‚’çµ„ã‚“ã§ã„ã¾ã™ã€‚Elixirã§ã¯ã€æµã‚Œã‚’ã²ã¨ã¾ã¨ã‚ã«ã—ã¦è¦–è¦šçš„ã«ã‚ã‹ã‚Šã‚„ã™ãéåŒæœŸå‡¦ç†ã—ã¦ãã“ã¨ãŒã§ãã¾ã™ã€‚\r\n\r\n```ex\r\nCachex.keys!(:feed)\r\n|> Enum.reject(fn key ->\r\n  key in [\r\n    \"excluded_links\",\r\n    \"excluded_titles\",\r\n    \"corrected_links\",\r\n    \"redirected_links\",\r\n    \"feed_group\",\r\n    \"archived_links\"\r\n  ]\r\nend)\r\n|> Task.async_stream(\r\n  fn item_link ->\r\n    with {:ok, [item_title, feed_tags]} <- Cachex.get(:feed, item_link),\r\n         :ok <- validate_all(item_link, item_title),\r\n         corrected_link <- correct_all(item_link),\r\n         {:ok, payload} <-\r\n           FormData.create(\r\n             %{\r\n               url: corrected_link,\r\n               comment: feed_tags |> Enum.map_join(fn tag -> \"[#{tag}]\" end),\r\n               rks: System.get_env(\"HATENA_BOOKMARK_RKS\"),\r\n               private: 0,\r\n               keep_original_url: 1,\r\n               with_status_op: 1,\r\n               from: \"inplace\",\r\n               post_twitter: 0,\r\n               post_evernote: 0\r\n             },\r\n             :url_encoded,\r\n             get: false\r\n           ) do\r\n      do_add_entries_to_hb(payload)\r\n      Logger.info(\"add entry: #{item_link}\")\r\n    end\r\n\r\n    archive_link(item_link)\r\n  end,\r\n  timeout: 15_000\r\n)\r\n|> Stream.run()\r\n```\r\n\r\n# WRAPUP\r\nElixirã®éåŒæœŸå‡¦ç†ã‚’ä½¿ã†ã“ã¨ã§ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã®é‹ç”¨ãŒã¨ã¦ã‚‚å¿«é©ã«ãªã‚Šã¾ã—ãŸã€‚ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã¨ã®ä»Šå¾Œã®ä»˜ãåˆã„æ–¹ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«è€ƒãˆã¦ã„ã¾ã™ã€‚\r\n\r\n- **æ‰‹å‹•ã§ãƒ–ã‚¯ãƒ:** æ°—ã«ãªã£ãŸè¨˜äº‹ãŒã‚ã‚‹ã”ã¨ã«\r\n- **ãƒ–ã‚¯ãƒã®ç¢ºèª:** æ°—ã«ãªã‚‹ã‚¿ã‚°ã”ã¨ã«ã¾ã¨ã‚ã¦ç¢ºèª\r\n\r\nãƒ–ã‚¯ãƒã®ç¢ºèªã«ã¤ã„ã¦ã¯ã€ä¾‹ãˆã°ã€CIã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã„ã‚‹é–“ã«æœ€è¿‘ã®GitHubã®å‹•å‘ã‚’ç¢ºèªã—ãŸã„å ´åˆã¯ã€Œ[nabinno/github](http://b.hatena.ne.jp/nabinno/github)ã€ã‚’ã¿ã‚‹ã€ã¨ã„ã†æ„Ÿã˜ã®é‹ç”¨ã§ã™ã€‚\r\n\r\nèé€šãŒåˆ©ã‹ãªã„ç‚¹ã§é€”ä¸­é‹ç”¨ãŒé›£ã—ããªã‚‹æ°—ã‚‚ã—ã¾ã™ãŒã€ã—ã°ã‚‰ãå›ã—ã¦ã¿ã¾ã™ã€‚\r\n","body_html":"<a href=\"https://raw.githubusercontent.com/nabinno/keshikimi2/master/priv/img/diagram.png\" target=\"_blank\" rel=\"noopener noreferrer\"><img alt=\"thumbnail\" src=\"https://raw.githubusercontent.com/nabinno/keshikimi2/master/priv/img/diagram.png\"></a>\n<p data-sourcepos=\"3:1-3:297\">ç´†ä½™æ›²æŠ˜åˆã£ã¦ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã®é‹ç”¨ã‚’è¦‹ç›´ã™å¿…è¦ãŒå‡ºã¦ãã¾ã—ãŸã€‚äººã®èˆˆå‘³ã¨ã„ã†ã®ã¯å°½ããªã„ã‚‚ã®ã§çŸ¥ã‚ŠãŸã„ã“ã¨ãŒæ¬¡ã€…å‡ºã¦ãã¾ã™ã€‚ã«ã‚‚æ‹˜ã‚ã‚‰ãšäººã®æ™‚é–“ã¯æœ‰é™ã§ãã‚Œã«ã‚ãŒãªã†ãŸã‚ã®æ‰‹æ®µã‚’è€ƒãˆãŸã‚ã‘ã§ã™ã€‚</p>\n<h1 data-sourcepos=\"5:1-5:9\" id=\"1-0-0\" name=\"1-0-0\">\n<a class=\"anchor\" id=\"PROBLEM\" name=\"PROBLEM\" href=\"#PROBLEM\" data-position=\"1-0-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"PROBLEM\"> &gt; PROBLEM</span></a>PROBLEM</h1>\n<ul data-sourcepos=\"6:1-11:0\">\n<li data-sourcepos=\"6:1-11:0\">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ€ãƒ¼ã§è¨˜äº‹ã‚’èª­ã‚“ã å¾Œã«ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ï¼ˆãƒ–ã‚¯ãƒï¼‰ã™ã‚‹ã¨ãƒ•ã‚£ãƒ¼ãƒ‰æ¶ˆåŒ–ã™ã‚‹ã®ã«æ™‚é–“ãŒã‹ã‹ã‚‹\n<ul data-sourcepos=\"7:5-11:0\">\n<li data-sourcepos=\"7:5-11:0\">ãƒ•ã‚£ãƒ¼ãƒ‰ã‚’ãã®ã¾ã¾ãƒ–ã‚¯ãƒã—ã¦ã„ã‚‹ã¨ä¸‹è¨˜ã®å•é¡ŒãŒã§ã¦ãã‚‹\n<ul data-sourcepos=\"8:9-11:0\">\n<li data-sourcepos=\"8:9-8:52\">ã‚ã¨ã§ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ããªã„</li>\n<li data-sourcepos=\"9:9-9:61\">èª­ã¿ãŸããªã„è¨˜äº‹ã‚’ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã†</li>\n<li data-sourcepos=\"10:9-11:0\">é©åˆ‡ã§ãªã„URLã§ãƒ–ã‚¯ãƒã—ã¦ã—ã¾ã†</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1 data-sourcepos=\"12:1-12:10\" id=\"2-0-0\" name=\"2-0-0\">\n<a class=\"anchor\" id=\"SOLUTION\" name=\"SOLUTION\" href=\"#SOLUTION\" data-position=\"2-0-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"SOLUTION\"> &gt; SOLUTION</span></a>SOLUTION</h1>\n<p data-sourcepos=\"13:1-13:242\">ã¨ã„ã†ã‚ã‘ã§ã€ä¸‹è¨˜ã®æ–¹é‡ã§ãƒ–ã‚¯ãƒã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚è¨­ç½®æ–¹æ³•ã®è©³ç´°ã¯<a href=\"https://github.com/nabinno/keshikimi2\" target=\"_blank\" rel=\"noopener noreferrer\">GitHubãƒ¬ãƒã‚¸ãƒˆãƒª</a>ã‚’å‚ç…§ãã ã•ã„ã€‚ãã—ã¦ã€æ–¹é‡ã¯ä¸‹è¨˜ã®é€šã‚Šã«ãªã‚Šã¾ã™ã€‚</p>\n<p data-sourcepos=\"15:1-15:10\"><strong>æ–¹é‡</strong></p>\n<ul data-sourcepos=\"17:1-22:0\">\n<li data-sourcepos=\"17:1-17:41\">ãƒ•ã‚£ãƒ¼ãƒ‰ã”ã¨ã«ã‚¿ã‚°ã¥ã‘ã™ã‚‹</li>\n<li data-sourcepos=\"18:1-18:80\">ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹è¨˜äº‹ã‚’ãƒªãƒ³ã‚¯ã¨ã‚¿ã‚¤ãƒˆãƒ«ã§é™¤å¤–åˆ¤å®šã™ã‚‹</li>\n<li data-sourcepos=\"19:1-19:122\">ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹è¨˜äº‹ã‚’ãƒªãƒ³ã‚¯ã‹ã‚‰æ ¡æ­£ã™ã¹ãã‚‚ã®ã‹ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã™ã¹ãã‚‚ã®ã‹åˆ¤å®šã™ã‚‹</li>\n<li data-sourcepos=\"20:1-20:75\">ä¸Šè¨˜è¨­å®šã¯YAMLãƒ•ã‚¡ã‚¤ãƒ«ã§ç°¡å˜ã«ç®¡ç†ã§ãã‚‹ã‚ˆã†ã«ã™ã‚‹</li>\n<li data-sourcepos=\"21:1-22:0\">ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼ã¨ãƒ–ã‚¯ãƒã‚’éåŒæœŸå‡¦ç†ã§ãã‚‹ã‚ˆã†Elixirã§å®Ÿè£…ã™ã‚‹</li>\n</ul>\n<h2 data-sourcepos=\"23:1-23:27\" id=\"2-1-0\" name=\"2-1-0\">\n<a class=\"anchor\" id=\"ãƒ–ã‚¯ãƒã®ç®¡ç†æ–¹æ³•\" name=\"%E3%83%96%E3%82%AF%E3%83%9E%E3%81%AE%E7%AE%A1%E7%90%86%E6%96%B9%E6%B3%95\" href=\"#%E3%83%96%E3%82%AF%E3%83%9E%E3%81%AE%E7%AE%A1%E7%90%86%E6%96%B9%E6%B3%95\" data-position=\"2-1-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"ãƒ–ã‚¯ãƒã®ç®¡ç†æ–¹æ³•\"> &gt; ãƒ–ã‚¯ãƒã®ç®¡ç†æ–¹æ³•</span></a>ãƒ–ã‚¯ãƒã®ç®¡ç†æ–¹æ³•</h2>\n<p data-sourcepos=\"24:1-24:444\">ã¾ãšãƒ–ã‚¯ãƒã®ç®¡ç†ã§ã™ãŒã€ä¸‹è¨˜5ã¤ã®YAMLãƒ•ã‚¡ã‚¤ãƒ«ã§æ§‹æˆã—ã¦ã„ã¾ã™ã€æ§‹é€ ã¯ãƒãƒƒãƒ—ã¨ãƒªã‚¹ãƒˆã®ã¿ã€‚ãƒ–ã‚¯ãƒã—ãŸã„ã¨æ€ã†è¨˜äº‹ã‚’èª­ã¿ã™ã™ã‚ã‚‹ä¸­ã§æ°—ã«ãªã‚‹ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå‡ºã¦ããŸã‚‰éƒ½åº¦ <code>feed.yaml</code> ã‚’æ›´æ–°ã—ã¾ã™ã€‚ã¾ãŸã€è¨˜äº‹ã«ãƒã‚¤ã‚ºãŒå¤šã„ã‚ˆã†ã ã£ãŸã‚‰å‚¾å‘ã‚’åˆ†æã—ã¦é™¤å¤–ãƒ•ã‚¡ã‚¤ãƒ« <code>feed_excluded_link.yaml</code> <code>feed_excluded_title.yaml</code> ã‚’æ›´æ–°ã—ã¾ã™ã€‚</p>\n<table data-sourcepos=\"26:1-32:115\">\n<thead>\n<tr data-sourcepos=\"26:1-26:90\">\n<th data-sourcepos=\"26:2-26:30\">item</th>\n<th data-sourcepos=\"26:32-26:89\">description</th>\n</tr>\n</thead>\n<tbody>\n<tr data-sourcepos=\"28:1-28:113\">\n<td data-sourcepos=\"28:2-28:30\"><code>feed.yaml</code></td>\n<td data-sourcepos=\"28:32-28:112\">ãƒ•ã‚£ãƒ¼ãƒ‰ã‚°ãƒ«ãƒ¼ãƒ—åã«å¯¾ã™ã‚‹ãƒªãƒ³ã‚¯ã€ã‚¿ã‚°ã®ãƒãƒƒãƒ—</td>\n</tr>\n<tr data-sourcepos=\"29:1-29:106\">\n<td data-sourcepos=\"29:2-29:30\"><code>feed_excluded_link.yaml</code></td>\n<td data-sourcepos=\"29:32-29:105\">é™¤å¤–ã™ã¹ããƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã®ãƒªã‚¹ãƒˆ</td>\n</tr>\n<tr data-sourcepos=\"30:1-30:107\">\n<td data-sourcepos=\"30:2-30:30\"><code>feed_excluded_title.yaml</code></td>\n<td data-sourcepos=\"30:32-30:106\">é™¤å¤–ã™ã¹ããƒ•ã‚£ãƒ¼ãƒ‰ã‚¿ã‚¤ãƒˆãƒ«ã®ãƒªã‚¹ãƒˆ</td>\n</tr>\n<tr data-sourcepos=\"31:1-31:118\">\n<td data-sourcepos=\"31:2-31:30\"><code>feed_corrected_link.yaml</code></td>\n<td data-sourcepos=\"31:32-31:117\">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã«å¯¾ã™ã‚‹ãƒˆãƒªãƒŸãƒ³ã‚°ã™ã¹ããƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®ãƒãƒƒãƒ—</td>\n</tr>\n<tr data-sourcepos=\"32:1-32:115\">\n<td data-sourcepos=\"32:2-32:30\"><code>feed_redirected_link.yaml</code></td>\n<td data-sourcepos=\"32:32-32:114\">ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã«å¯¾ã™ã‚‹ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆå…ˆãƒªãƒ³ã‚¯ã®ãƒãƒƒãƒ—</td>\n</tr>\n</tbody>\n</table>\n<div class=\"code-block\" data-sourcepos=\"34:1-61:3\">\n<div class=\"code-filename\">\n<i class=\"fa fa-file-code-o\"></i>yaml</div>\n<div class=\"highlight\"><pre class=\"highlight yaml\"><code><span class=\"c1\"># feed.yaml</span>\n<span class=\"s\">nabinno/sports/feed_group_name</span><span class=\"pi\">:</span>\n  <span class=\"na\">tags</span><span class=\"pi\">:</span>\n    <span class=\"pi\">-</span> <span class=\"s\">ski</span>\n  <span class=\"na\">links</span><span class=\"pi\">:</span>\n    <span class=\"pi\">-</span> <span class=\"s\">http://rss.example.com/ski_feed.rss</span>\n    <span class=\"pi\">-</span> <span class=\"s\">http://rss.example.com/snowboard_feed.rss</span>\n    <span class=\"pi\">-</span> <span class=\"s\">http://ski-status.example.com/rss</span>\n\n<span class=\"c1\"># feed_excluded_link.yaml</span>\n<span class=\"pi\">-</span> <span class=\"s\">anti-ski.example.com</span>\n<span class=\"pi\">-</span> <span class=\"s\">awesome-snowboard.example.com</span>\n\n<span class=\"c1\"># feed_excluded_title.yaml</span>\n<span class=\"pi\">-</span> <span class=\"s\">queer</span>\n<span class=\"pi\">-</span> <span class=\"s\">two-planker</span>\n<span class=\"pi\">-</span> <span class=\"s\">beaver-tail</span>\n\n<span class=\"c1\"># feed_corrected_link.yaml</span>\n<span class=\"s\">amazon.com</span><span class=\"pi\">:</span>\n  <span class=\"pi\">-</span> <span class=\"s\">ref</span>\n  <span class=\"pi\">-</span> <span class=\"s\">ie</span>\n\n<span class=\"c1\"># feed_redirected_link.yaml</span>\n<span class=\"s\">ski-status.example.com</span><span class=\"pi\">:</span>\n  <span class=\"pi\">-</span> <span class=\"s\">Floki.find(fst, \".post__body a\")</span>\n</code></pre></div>\n</div>\n<h2 data-sourcepos=\"63:1-63:33\" id=\"2-2-0\" name=\"2-2-0\">\n<a class=\"anchor\" id=\"Elixirã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†\" name=\"Elixir%E3%81%AB%E3%82%88%E3%82%8B%E9%9D%9E%E5%90%8C%E6%9C%9F%E5%87%A6%E7%90%86\" href=\"#Elixir%E3%81%AB%E3%82%88%E3%82%8B%E9%9D%9E%E5%90%8C%E6%9C%9F%E5%87%A6%E7%90%86\" data-position=\"2-2-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"Elixirã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†\"> &gt; Elixirã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†</span></a>Elixirã«ã‚ˆã‚‹éåŒæœŸå‡¦ç†</h2>\n<p data-sourcepos=\"64:1-64:162\">Elixirã§éåŒæœŸå‡¦ç†ã‚’è¡Œã£ã¦ã„ã‚‹ã®ã§ã™ãŒã€å¤§ããåˆ†ã‘ã¦ç›£è¦–æ©Ÿæ§‹ã®Supervisorã¨éåŒæœŸå‡¦ç†ã®Task.async_streamã‚’ä½¿ã£ã¦ã„ã¾ã™ã€‚</p>\n<h3 data-sourcepos=\"66:1-66:27\" id=\"2-2-1\" name=\"2-2-1\">\n<a class=\"anchor\" id=\"ç›£è¦–æ©Ÿæ§‹ Supervisor\" name=\"%E7%9B%A3%E8%A6%96%E6%A9%9F%E6%A7%8B%20Supervisor\" href=\"#%E7%9B%A3%E8%A6%96%E6%A9%9F%E6%A7%8B%20Supervisor\" data-position=\"2-2-1\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"ç›£è¦–æ©Ÿæ§‹ Supervisor\"> &gt; ç›£è¦–æ©Ÿæ§‹ Supervisor</span></a>ç›£è¦–æ©Ÿæ§‹ Supervisor</h3>\n<p data-sourcepos=\"67:1-67:609\">ã¾ãšã€Supervisorã€‚Elixirã«ã¯ç›£è¦–æ©Ÿæ§‹SupervisorãŒã‚ã‚Šã€ãã‚ŒãŒå„ãƒ¯ãƒ¼ã‚«ãƒ¼ã‚’å­ãƒ—ãƒ­ã‚»ã‚¹ã¨ã—ã¦ç®¡ç†ã—ã¦ã„ã¾ã™ã€‚ã“ã“ã§ã¯ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼ã¨ãƒ–ã‚¯ãƒã¯åˆ¥ã€…ã®ãƒ¯ãƒ¼ã‚«ãƒ¼ã§å‡¦ç†ã—ã¾ã™ãŒã€ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãŒæš–æ°—å‡¦ç†ã‚’åˆ¥ãƒ¯ãƒ¼ã‚«ãƒ¼ã§è¡Œã£ã¦ã„ã‚‹ãŸã‚å†èµ·å‹•æˆ¦ç•¥ã¯ã€Œå¤±æ•—ã—ãŸã‚¤ãƒ™ãƒ³ãƒˆã®ä¸­ã«ã‚ã‚‹ã™ã¹ã¦ã®å­ãƒ—ãƒ­ã‚»ã‚¹ã‚’å†èµ·å‹•ã€ï¼ˆ <code>one_for_all</code> ï¼‰ã«ã—ã¦ã‚ã‚Šã¾ã™ã€‚å†èµ·å‹•æˆ¦ç•¥ã®è©³ç´°ã¯ã€Œ<a href=\"https://elixirschool.com/ja/lessons/advanced/otp-supervisors/\" target=\"_blank\" rel=\"noopener noreferrer\">OTPã‚¹ãƒ¼ãƒ‘ãƒã‚¤ã‚¶ Â· Elixir School</a>ã€ã‚’å‚ç…§ä¸‹ã•ã„ã€‚</p>\n<p data-sourcepos=\"69:1-69:197\">ä¸‹è¨˜ã®ã‚ˆã†ã« <code>Supervisor.start_link</code> ã‚’ <code>Keshikimi2.Application.start</code> ã«é©ç”¨ã™ã‚‹ã¨ã€ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹å§‹ï¼ˆ <code>mix run</code> ï¼‰ã—ãŸæ™‚ç‚¹ã§ç›£è¦–æ©Ÿæ§‹ãŒèµ·å‹•ã•ã‚Œã¾ã™ã€‚</p>\n<div class=\"code-block\" data-sourcepos=\"71:1-92:3\">\n<div class=\"code-filename\">\n<i class=\"fa fa-file-code-o\"></i>ex</div>\n<div class=\"highlight\"><pre class=\"highlight elixir\"><code><span class=\"no\">Supervisor</span><span class=\"o\">.</span><span class=\"n\">start_link</span><span class=\"p\">(</span>\n  <span class=\"p\">[</span>\n    <span class=\"ss\">:hackney_pool</span><span class=\"o\">.</span><span class=\"n\">child_spec</span><span class=\"p\">(</span><span class=\"ss\">:hatena_bookmark_pool</span><span class=\"p\">,</span> <span class=\"ss\">timeout:</span> <span class=\"mi\">15_000</span><span class=\"p\">,</span> <span class=\"ss\">max_connections:</span> <span class=\"mi\">100</span><span class=\"p\">),</span>\n    <span class=\"c1\"># @todo å½“è©²ãƒ¯ãƒ¼ã‚«ãƒ¼ã§æš–æ°—å‡¦ç†ã‚’è¡Œã£ã¦ã„ãªã„ã®ã§ `one_for_one` ã«ã—ãŸå ´åˆã€å†èµ·å‹•æ™‚ã«ã»ã‹ã«å½±éŸ¿ã™ã‚‹</span>\n    <span class=\"n\">supervisor</span><span class=\"p\">(</span><span class=\"no\">Cachex</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"ss\">:feed</span><span class=\"p\">,</span> <span class=\"p\">[]]),</span>\n    <span class=\"n\">supervisor</span><span class=\"p\">(</span><span class=\"no\">Keshikimi2Feed</span><span class=\"o\">.</span><span class=\"no\">Registry</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">prefix</span><span class=\"p\">]),</span>\n\n    <span class=\"c1\"># ãƒ•ã‚£ãƒ¼ãƒ‰èª­è¾¼å‡¦ç† (PubSub)</span>\n    <span class=\"n\">supervisor</span><span class=\"p\">(</span><span class=\"no\">Keshikimi2Feed</span><span class=\"o\">.</span><span class=\"no\">Subscriber</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">prefix</span><span class=\"p\">]),</span>\n    <span class=\"n\">worker</span><span class=\"p\">(</span><span class=\"no\">Keshikimi2Feed</span><span class=\"o\">.</span><span class=\"no\">Worker</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">prefix</span><span class=\"p\">]),</span>\n    <span class=\"n\">worker</span><span class=\"p\">(</span><span class=\"no\">Keshikimi2Feed</span><span class=\"o\">.</span><span class=\"no\">Publisher</span><span class=\"p\">,</span> <span class=\"p\">[[</span><span class=\"ss\">prefix:</span> <span class=\"n\">prefix</span><span class=\"p\">,</span> <span class=\"ss\">poll_interval:</span> <span class=\"mi\">3_000</span><span class=\"p\">]]),</span>\n\n    <span class=\"c1\"># ãƒ–ã‚¯ãƒå‡¦ç†</span>\n    <span class=\"n\">worker</span><span class=\"p\">(</span><span class=\"no\">Keshikimi2</span><span class=\"o\">.</span><span class=\"no\">HatenaBookmark</span><span class=\"o\">.</span><span class=\"no\">AddEntry</span><span class=\"p\">,</span> <span class=\"p\">[</span>\n      <span class=\"p\">[</span><span class=\"ss\">prefix:</span> <span class=\"n\">prefix</span><span class=\"p\">,</span> <span class=\"ss\">poll_interval:</span> <span class=\"mi\">3_000</span><span class=\"p\">]</span>\n    <span class=\"p\">])</span>\n  <span class=\"p\">],</span>\n  <span class=\"ss\">strategy:</span> <span class=\"ss\">:one_for_all</span><span class=\"p\">,</span>\n  <span class=\"ss\">name:</span> <span class=\"n\">name</span><span class=\"p\">(</span><span class=\"n\">prefix</span><span class=\"p\">)</span>\n<span class=\"p\">)</span>\n</code></pre></div>\n</div>\n<h3 data-sourcepos=\"94:1-94:37\" id=\"2-2-2\" name=\"2-2-2\">\n<a class=\"anchor\" id=\"éåŒæœŸå‡¦ç† Task.async_stream\" name=\"%E9%9D%9E%E5%90%8C%E6%9C%9F%E5%87%A6%E7%90%86%20Task.async_stream\" href=\"#%E9%9D%9E%E5%90%8C%E6%9C%9F%E5%87%A6%E7%90%86%20Task.async_stream\" data-position=\"2-2-2\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"éåŒæœŸå‡¦ç† Task.async_stream\"> &gt; éåŒæœŸå‡¦ç† Task.async_stream</span></a>éåŒæœŸå‡¦ç† Task.async_stream</h3>\n<p data-sourcepos=\"95:1-95:461\">æ¬¡ã«ã€Task.async_streamã€‚é…åˆ—ã‚’å¼•ãå›ã™ãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ã¯ <code>Task.async_stream</code> ãŒã†ã£ã¦ã¤ã‘ã§ã™ã€‚ä¸‹è¨˜ã§ã¯ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‹ã‚‰ãƒ–ã‚¯ãƒå¯¾è±¡ã«ãªã‚‹ãƒ•ã‚£ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã‚’å–ã‚Šå‡ºã—ã€é™¤å¤–å‡¦ç†ã€æ ¡æ­£å‡¦ç†ã‚’åŠ ãˆã¦ã€ãƒ–ã‚¯ãƒã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡ºã™ã¨ã„ã†æµã‚Œã‚’çµ„ã‚“ã§ã„ã¾ã™ã€‚Elixirã§ã¯ã€æµã‚Œã‚’ã²ã¨ã¾ã¨ã‚ã«ã—ã¦è¦–è¦šçš„ã«ã‚ã‹ã‚Šã‚„ã™ãéåŒæœŸå‡¦ç†ã—ã¦ãã“ã¨ãŒã§ãã¾ã™ã€‚</p>\n<div class=\"code-block\" data-sourcepos=\"97:1-139:3\">\n<div class=\"code-filename\">\n<i class=\"fa fa-file-code-o\"></i>ex</div>\n<div class=\"highlight\"><pre class=\"highlight elixir\"><code><span class=\"no\">Cachex</span><span class=\"o\">.</span><span class=\"n\">keys!</span><span class=\"p\">(</span><span class=\"ss\">:feed</span><span class=\"p\">)</span>\n<span class=\"o\">|&gt;</span> <span class=\"no\">Enum</span><span class=\"o\">.</span><span class=\"n\">reject</span><span class=\"p\">(</span><span class=\"k\">fn</span> <span class=\"n\">key</span> <span class=\"o\">-&gt;</span>\n  <span class=\"n\">key</span> <span class=\"ow\">in</span> <span class=\"p\">[</span>\n    <span class=\"s2\">\"excluded_links\"</span><span class=\"p\">,</span>\n    <span class=\"s2\">\"excluded_titles\"</span><span class=\"p\">,</span>\n    <span class=\"s2\">\"corrected_links\"</span><span class=\"p\">,</span>\n    <span class=\"s2\">\"redirected_links\"</span><span class=\"p\">,</span>\n    <span class=\"s2\">\"feed_group\"</span><span class=\"p\">,</span>\n    <span class=\"s2\">\"archived_links\"</span>\n  <span class=\"p\">]</span>\n<span class=\"k\">end</span><span class=\"p\">)</span>\n<span class=\"o\">|&gt;</span> <span class=\"no\">Task</span><span class=\"o\">.</span><span class=\"n\">async_stream</span><span class=\"p\">(</span>\n  <span class=\"k\">fn</span> <span class=\"n\">item_link</span> <span class=\"o\">-&gt;</span>\n    <span class=\"n\">with</span> <span class=\"p\">{</span><span class=\"ss\">:ok</span><span class=\"p\">,</span> <span class=\"p\">[</span><span class=\"n\">item_title</span><span class=\"p\">,</span> <span class=\"n\">feed_tags</span><span class=\"p\">]}</span> <span class=\"o\">&lt;-</span> <span class=\"no\">Cachex</span><span class=\"o\">.</span><span class=\"n\">get</span><span class=\"p\">(</span><span class=\"ss\">:feed</span><span class=\"p\">,</span> <span class=\"n\">item_link</span><span class=\"p\">),</span>\n         <span class=\"ss\">:ok</span> <span class=\"o\">&lt;-</span> <span class=\"n\">validate_all</span><span class=\"p\">(</span><span class=\"n\">item_link</span><span class=\"p\">,</span> <span class=\"n\">item_title</span><span class=\"p\">),</span>\n         <span class=\"n\">corrected_link</span> <span class=\"o\">&lt;-</span> <span class=\"n\">correct_all</span><span class=\"p\">(</span><span class=\"n\">item_link</span><span class=\"p\">),</span>\n         <span class=\"p\">{</span><span class=\"ss\">:ok</span><span class=\"p\">,</span> <span class=\"n\">payload</span><span class=\"p\">}</span> <span class=\"o\">&lt;-</span>\n           <span class=\"no\">FormData</span><span class=\"o\">.</span><span class=\"n\">create</span><span class=\"p\">(</span>\n             <span class=\"p\">%{</span>\n               <span class=\"ss\">url:</span> <span class=\"n\">corrected_link</span><span class=\"p\">,</span>\n               <span class=\"ss\">comment:</span> <span class=\"n\">feed_tags</span> <span class=\"o\">|&gt;</span> <span class=\"no\">Enum</span><span class=\"o\">.</span><span class=\"n\">map_join</span><span class=\"p\">(</span><span class=\"k\">fn</span> <span class=\"n\">tag</span> <span class=\"o\">-&gt;</span> <span class=\"s2\">\"[</span><span class=\"si\">#{</span><span class=\"n\">tag</span><span class=\"si\">}</span><span class=\"s2\">]\"</span> <span class=\"k\">end</span><span class=\"p\">),</span>\n               <span class=\"ss\">rks:</span> <span class=\"no\">System</span><span class=\"o\">.</span><span class=\"n\">get_env</span><span class=\"p\">(</span><span class=\"s2\">\"HATENA_BOOKMARK_RKS\"</span><span class=\"p\">),</span>\n               <span class=\"ss\">private:</span> <span class=\"mi\">0</span><span class=\"p\">,</span>\n               <span class=\"ss\">keep_original_url:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n               <span class=\"ss\">with_status_op:</span> <span class=\"mi\">1</span><span class=\"p\">,</span>\n               <span class=\"ss\">from:</span> <span class=\"s2\">\"inplace\"</span><span class=\"p\">,</span>\n               <span class=\"ss\">post_twitter:</span> <span class=\"mi\">0</span><span class=\"p\">,</span>\n               <span class=\"ss\">post_evernote:</span> <span class=\"mi\">0</span>\n             <span class=\"p\">},</span>\n             <span class=\"ss\">:url_encoded</span><span class=\"p\">,</span>\n             <span class=\"ss\">get:</span> <span class=\"no\">false</span>\n           <span class=\"p\">)</span> <span class=\"k\">do</span>\n      <span class=\"n\">do_add_entries_to_hb</span><span class=\"p\">(</span><span class=\"n\">payload</span><span class=\"p\">)</span>\n      <span class=\"no\">Logger</span><span class=\"o\">.</span><span class=\"n\">info</span><span class=\"p\">(</span><span class=\"s2\">\"add entry: </span><span class=\"si\">#{</span><span class=\"n\">item_link</span><span class=\"si\">}</span><span class=\"s2\">\"</span><span class=\"p\">)</span>\n    <span class=\"k\">end</span>\n\n    <span class=\"n\">archive_link</span><span class=\"p\">(</span><span class=\"n\">item_link</span><span class=\"p\">)</span>\n  <span class=\"k\">end</span><span class=\"p\">,</span>\n  <span class=\"ss\">timeout:</span> <span class=\"mi\">15_000</span>\n<span class=\"p\">)</span>\n<span class=\"o\">|&gt;</span> <span class=\"no\">Stream</span><span class=\"o\">.</span><span class=\"n\">run</span><span class=\"p\">()</span>\n</code></pre></div>\n</div>\n<h1 data-sourcepos=\"141:1-141:8\" id=\"3-0-0\" name=\"3-0-0\">\n<a class=\"anchor\" id=\"WRAPUP\" name=\"WRAPUP\" href=\"#WRAPUP\" data-position=\"3-0-0\"><i class=\"fa fa-link\"></i><span class=\"hidden\" data-text=\"WRAPUP\"> &gt; WRAPUP</span></a>WRAPUP</h1>\n<p data-sourcepos=\"142:1-142:216\">Elixirã®éåŒæœŸå‡¦ç†ã‚’ä½¿ã†ã“ã¨ã§ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã®é‹ç”¨ãŒã¨ã¦ã‚‚å¿«é©ã«ãªã‚Šã¾ã—ãŸã€‚ã¯ã¦ãªãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯ã¨ã®ä»Šå¾Œã®ä»˜ãåˆã„æ–¹ã¯ä¸‹è¨˜ã®ã‚ˆã†ã«è€ƒãˆã¦ã„ã¾ã™ã€‚</p>\n<ul data-sourcepos=\"144:1-146:0\">\n<li data-sourcepos=\"144:1-144:65\">\n<strong>æ‰‹å‹•ã§ãƒ–ã‚¯ãƒ:</strong> æ°—ã«ãªã£ãŸè¨˜äº‹ãŒã‚ã‚‹ã”ã¨ã«</li>\n<li data-sourcepos=\"145:1-146:0\">\n<strong>ãƒ–ã‚¯ãƒã®ç¢ºèª:</strong> æ°—ã«ãªã‚‹ã‚¿ã‚°ã”ã¨ã«ã¾ã¨ã‚ã¦ç¢ºèª</li>\n</ul>\n<p data-sourcepos=\"147:1-147:239\">ãƒ–ã‚¯ãƒã®ç¢ºèªã«ã¤ã„ã¦ã¯ã€ä¾‹ãˆã°ã€CIã§ãƒ‡ãƒ—ãƒ­ã‚¤ã—ã¦ã„ã‚‹é–“ã«æœ€è¿‘ã®GitHubã®å‹•å‘ã‚’ç¢ºèªã—ãŸã„å ´åˆã¯ã€Œ<a href=\"http://b.hatena.ne.jp/nabinno/github\" target=\"_blank\" rel=\"noopener noreferrer\">nabinno/github</a>ã€ã‚’ã¿ã‚‹ã€ã¨ã„ã†æ„Ÿã˜ã®é‹ç”¨ã§ã™ã€‚</p>\n<p data-sourcepos=\"149:1-149:111\">èé€šãŒåˆ©ã‹ãªã„ç‚¹ã§é€”ä¸­é‹ç”¨ãŒé›£ã—ããªã‚‹æ°—ã‚‚ã—ã¾ã™ãŒã€ã—ã°ã‚‰ãå›ã—ã¦ã¿ã¾ã™ã€‚</p>\n","tags":["elixir","hatena-bookmark"],"updated_at":"2021-01-16T01:12:01+09:00","childPublishedDate":{"published_on":"2019-01-01T00:00:00.000Z"},"updated_by":{"name":"ãªã³ã®ğŸ‘·","screen_name":"nabinno","icon":"https://img.esa.io/uploads/production/members/94286/icon/thumb_m_ef5f024307008aa399b91f87fa5f64e8.jpg"}},"relatedPosts":{"edges":[{"node":{"number":55,"relative_category":"blog/backend","fields":{"title":"PositiveSSLã‚’Herokuã«é©ç”¨ã™ã‚‹","excerpt":"å¹´ã«1å›ã®SSLæ›´æ–°ã®ã‚¤ãƒ™ãƒ³ãƒˆã§ã™ã€‚æ¯å¹´åŒã˜ã“ã¨ã‚’ã™ã‚Œã°è‰¯ã„ã‹ã¨ã„ã†ã¨ãã†ã§ã‚‚ãªãã€è²©ç¤¾ã¨å¸ã®éƒ½åˆã§SSLã®è³¼å…¥æ–¹æ³•ãŒå¾®å¦™ã«å¤‰ã‚ã‚Šã¾ã™ã€‚ã¨ã¯è¨€ãˆã€æ¯å¹´ä¸€ã‹ã‚‰èª¿ã¹ç›´ã™ã®ã‚‚æ‰‹é–“ãªã®ã§å‚™å¿˜ã¨ã—ã¦è¨˜ã—ã¦ãŠãã¾ã™ã€‚   > PROBLEMPROBLEM \n\n- Herokuã®SSLã®æœŸé™ãŒããŸ   > SOLUTIONSOLUTION \n\n- ã¨ã„ã†ã‚ã‘ã§ã€ã„ã¤ã‚‚ä½¿ã£ã¦ã„ã‚‹SSLè²©å£²ä»£ç†åº—SSLs.comï¼ˆNameCheapç¤¾ï¼‰ã§PositiveSSLï¼ˆé‹ç”¨Comodoç¤¾ï¼‰ã‚’è³¼å…¥ã—Herokuã«é©ç”¨ã—ã¾ã™ã€‚   > HOWTOHOWTO \n\n1. è¨¼æ˜æ›¸ã‚’è³¼å…¥ã™ã‚‹ SSLè²©å£²ä»£ç†åº—ã§ã‚ã‚Œã°ã©ã“ã§ã‚‚ã„ã„ã®ã§ã™ãŒã€æ˜”ã‹ã‚‰ä½¿ã£ã¦ã„ã‚‹ã®ã§ \n2. SSLè²©å£²ä»£ç†åº—ã§ã‚ã‚Œã°ã©ã“ã§ã‚‚ã„ã„ã®ã§ã™ãŒã€æ˜”ã‹ã‚‰ä½¿ã£ã¦ã„ã‚‹ã®ã§\n3. ç§˜å¯†éµã¨ç½²åãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ã¤ãã‚‹ ç§˜å¯†éµ openssl genrsa -des3 -out server.orig.key 2048 ç§˜å¯†éµãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã—openssl rsa -in server.orig.key -out server.key ç½²åãƒªã‚¯ã‚¨ã‚¹ãƒˆ openssl req -new -key server.key -out server.csr \n4. ç§˜å¯†éµ openssl genrsa -des3 -out server.orig.key 2048 \n5. ç§˜å¯†éµãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãªã—openssl rsa -in server.orig.key -out server.key \n6. ç½²åãƒªã‚¯ã‚¨ã‚¹ãƒˆ openssl req -new -key server.key -out server.csr \n7. è¨¼æ˜æ›¸ç™ºè¡Œã‚’ç”³è«‹ã™ã‚‹ SSLè²©å£²ä»£ç†åº—ã‚ˆã‚Šç½²åãƒªã‚¯ã‚¨ã‚¹ãƒˆserver.csrã¨é–¢é€£æƒ…å ±ã‚’é€ä¿¡ã—ã¾ã™ \n8. SSLè²©å£²ä»£ç†åº—ã‚ˆã‚Šç½²åãƒªã‚¯ã‚¨ã‚¹ãƒˆserver.csrã¨é–¢é€£æƒ…å ±ã‚’é€ä¿¡ã—ã¾ã™\n9. ãƒ‰ãƒ¡ã‚¤ãƒ³ä¿æŒã®è¨¼æ˜ã‚’ã™ã‚‹ PositiveSSLã®é‹ç”¨ä¼šç¤¾Comodoã«å¯¾ã—ãƒ‰ãƒ¡ã‚¤ãƒ³ä¿æŒã®è¨¼æ˜ã—ã¾ã™ è¨¼æ˜æ–¹æ³•ã¯ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã™ã‚‹ã€ã‚ã‚‹ã„ã¯ã€Webã‚µã‚¤ãƒˆã«ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨­ç½®ã™ã‚‹ã‹ã®2æŠã«ãªã‚Šã¾ã™ \n10. PositiveSSLã®é‹ç”¨ä¼šç¤¾Comodoã«å¯¾ã—ãƒ‰ãƒ¡ã‚¤ãƒ³ä¿æŒã®è¨¼æ˜ã—ã¾ã™\n11. è¨¼æ˜æ–¹æ³•ã¯ãƒ¡ãƒ¼ãƒ«ã‚’å—ä¿¡ã™ã‚‹ã€ã‚ã‚‹ã„ã¯ã€Webã‚µã‚¤ãƒˆã«ãƒ—ãƒ¬ãƒ¼ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’è¨­ç½®ã™ã‚‹ã‹ã®2æŠã«ãªã‚Šã¾ã™\n12. Herokuç”¨ã®è¨¼æ˜æ›¸ã‚’ã¤ãã‚‹ è¨¼æ˜ã‚¿ã‚¹ã‚¯ã‚’ã“ãªã—ã—ã°ã‚‰ãã™ã‚‹ã¨ã€Comodoç¤¾ã‚ˆã‚Šè¤‡æ•°ã®è¨¼æ˜æ›¸ãŒé€ã‚‰ã‚Œã¦ãã¾ã™ Herokuç”¨ã«è¨¼æ˜æ›¸ã‚’ã¤ãã‚‹ cat www_example_com.crt COMODORSADomainValidationSecureServerCA.crt COMODORSAAddTrustCA.crt AddTrustExternalCARoot.crt > server.crt \n13. è¨¼æ˜ã‚¿ã‚¹ã‚¯ã‚’ã“ãªã—ã—ã°ã‚‰ãã™ã‚‹ã¨ã€Comodoç¤¾ã‚ˆã‚Šè¤‡æ•°ã®è¨¼æ˜æ›¸ãŒé€ã‚‰ã‚Œã¦ãã¾ã™\n14. Herokuç”¨ã«è¨¼æ˜æ›¸ã‚’ã¤ãã‚‹ cat www_example_com.crt COMODORSADomainValidationSecureServerCA.crt COMODORSAAddTrustCA.crt AddTrustExternalCARoot.crt > server.crt \n15. Herokuã«è¨¼æ˜æ›¸ã‚’é©ç”¨ã™ã‚‹ æ–°è¦ã§é©ç”¨ã™ã‚‹å ´åˆã¯æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ heroku addons:add ssl:endpoint heroku certs:add server.crt server.key æ›´æ–°ã™ã‚‹å ´åˆã¯æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ heroku certs:update server.crt server.key \n16. æ–°è¦ã§é©ç”¨ã™ã‚‹å ´åˆã¯æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ heroku addons:add ssl:endpoint heroku certs:add server.crt server.key \n17. heroku addons:add ssl:endpoint\n18. heroku certs:add server.crt server.key\n19. æ›´æ–°ã™ã‚‹å ´åˆã¯æ¬¡ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ heroku certs:update server.crt server.key \n20. heroku certs:update server.crt server.key   > WRAPUPWRAPUP \n\nã“ã®ã‚ãŸã‚ŠãŒè‡ªå‹•åŒ–ã•ã‚Œã‚Œã°è‰¯ã„ã¨æ€ã„ã¤ã¤ã€è‡ªå‹•åŒ–ã•ã‚ŒãŸã‚‰ã“ã®ã‚ãŸã‚Šã‚’èª¿ã¹ã‚‹ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ãŒãªããªã‚‹ã®ã§å¹´ã«ä¸€å›ã®ãƒªãƒãƒ“ãƒªã‚¤ãƒ™ãƒ³ãƒˆã¨ã—ã¦ä½ç½®ã¥ã‘ã¦ãŠãã¾ã™ã€ã¯ã„ã€‚"},"name":"[2017-04-23]PositiveSSLã‚’Herokuã«é©ç”¨ã™ã‚‹","tags":[],"childPublishedDate":{"published_on":"2017-04-23T00:00:00.000Z","published_on_unix":1492905600}}},{"node":{"number":54,"relative_category":"blog/frontend","fields":{"title":"Xamariné–‹ç™ºç’°å¢ƒã‚’ã¨ã¨ã®ãˆã‚‹","excerpt":"Xamarinã«æ‰‹ã‚’å‡ºã—å§‹ã‚ãŸã®ã¯è‰¯ã„ã®ã§ã™ãŒã€ãã®é–‹ç™ºç’°å¢ƒãŒã©ã†ã«ã‚‚æ‰‹ã«ãªã˜ã¾ãšè©¦è¡ŒéŒ¯èª¤ã—ã¦ã„ã¾ã™ã€‚ä»Šå›ã®è¨˜äº‹ã§è§£æ±ºã§ãã‚‹ã‹ã¨ã„ã†ã¨å¾®å¦™ã§ã¯ã‚ã‚Šã¾ã™ãŒã€ã‚„ã‚Œã‚‹ã ã‘ã®ã“ã¨ã¯ã‚„ã£ã¦ã¿ã‚ˆã†ã¨æ€ã„ã¾ã™ã€‚   > PROBLEMPROBLEM \n\n- Xamariné–‹ç™ºç’°å¢ƒãŒã‚µãƒ¼ãƒãƒ¼å´ã®ãã‚Œã¨ã‹ã„é›¢ã—ã¦ã„ã‚‹ Visual Studio Community 2015ã®å‹•ä½œãŒã‚‚ã£ã•ã‚Šã—ã¦ã„ã‚‹ é©åˆ‡ãªé–‹ç™ºãƒ•ãƒ­ãƒ¼ãŒã‚ã‹ã‚‰ãªã„ é©åˆ‡ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒã‚ã‹ã‚‰ãªã„ é©åˆ‡ãªXAMLãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¯ãƒ¼ãŒã‚ã‹ã‚‰ãªã„ é©åˆ‡ãªAndroidã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒã‚ã‹ã‚‰ãªã„ \n- Visual Studio Community 2015ã®å‹•ä½œãŒã‚‚ã£ã•ã‚Šã—ã¦ã„ã‚‹\n- é©åˆ‡ãªé–‹ç™ºãƒ•ãƒ­ãƒ¼ãŒã‚ã‹ã‚‰ãªã„\n- é©åˆ‡ãªã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ãŒã‚ã‹ã‚‰ãªã„\n- é©åˆ‡ãªXAMLãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¯ãƒ¼ãŒã‚ã‹ã‚‰ãªã„\n- é©åˆ‡ãªAndroidã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ãŒã‚ã‹ã‚‰ãªã„   > SOLUTIONSOLUTION \n\nã¨ã„ã†ã‚ã‘ã§ã€å‹•ä½œãŒå¿«é©ã«ãªã£ãŸã¨ã„ã‚ã‚Œã‚‹Visual Studio 2017ãŒã§ãŸã®ã§ãã¡ã‚‰ã‚’ä¸­å¿ƒã«é–‹ç™ºç’°å¢ƒã‚’æš«å®šã§æ•´ç†ã—ã¾ã™ã€æ°¸é ã®WIPã§ã™ã€‚   > é–‹ç™ºãƒ•ãƒ­ãƒ¼é–‹ç™ºãƒ•ãƒ­ãƒ¼ \n\nã¾ãšã€æƒ³å®šã—ã¦ã„ã‚‹é–‹ç™ºãƒ•ãƒ­ãƒ¼ã¯ä¸‹è¨˜ã®é€šã‚Šã€‚ \n\n- ãƒ†ã‚¹ãƒˆé§†å‹•é–‹ç™º ãƒ‡ãƒãƒƒã‚° ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ç”»é¢ã®å‹•ä½œç¢ºèª - ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ”ãƒ¼ãƒ‰ç­‰è€ƒæ…®ã—ã¦UWPã§ãŠã“ãªã† ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ - Debug.WriteLineãªã©ã®ç¢ºèª ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆ - å¤‰æ•°ã®è¿½è·¡ C# REPL - C#ã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å‹•ä½œç¢ºèª XAMLã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ã„ã‚‰ãªã„å­ ãƒ†ã‚¹ãƒˆ å˜ä½“ãƒ†ã‚¹ãƒˆ - NUnit UIãƒ†ã‚¹ãƒˆ - ä¿ç•™ \n- ãƒ‡ãƒãƒƒã‚° ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ç”»é¢ã®å‹•ä½œç¢ºèª - ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ”ãƒ¼ãƒ‰ç­‰è€ƒæ…®ã—ã¦UWPã§ãŠã“ãªã† ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ - Debug.WriteLineãªã©ã®ç¢ºèª ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆ - å¤‰æ•°ã®è¿½è·¡ C# REPL - C#ã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å‹•ä½œç¢ºèª XAMLã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ã„ã‚‰ãªã„å­ \n- ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ç”»é¢ã®å‹•ä½œç¢ºèª - ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ”ãƒ¼ãƒ‰ç­‰è€ƒæ…®ã—ã¦UWPã§ãŠã“ãªã†\n- ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆ - Debug.WriteLineãªã©ã®ç¢ºèª\n- ã‚¤ãƒŸãƒ‡ã‚£ã‚¨ã‚¤ãƒˆ - å¤‰æ•°ã®è¿½è·¡\n- C# REPL - C#ã‚„ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å‹•ä½œç¢ºèª\n- XAMLã®ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ - ã„ã‚‰ãªã„å­\n- ãƒ†ã‚¹ãƒˆ å˜ä½“ãƒ†ã‚¹ãƒˆ - NUnit UIãƒ†ã‚¹ãƒˆ - ä¿ç•™ \n- å˜ä½“ãƒ†ã‚¹ãƒˆ - NUnit\n- UIãƒ†ã‚¹ãƒˆ - ä¿ç•™\n- Github Flowã«ãã£ãŸãƒ‡ãƒ—ãƒ­ã‚¤ featureãƒ–ãƒ©ãƒ³ãƒã‚’ãã£ã¦ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãŸã¦ã‚‹ å½“è©²ãƒ–ãƒ©ãƒ³ãƒã«å¯¾ã—ã¦CIãƒ„ãƒ¼ãƒ«ã§ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆãƒ»é…å¸ƒã‚’è‡ªå‹•åŒ– - ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆå¾Œã«ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã«ãƒ¡ãƒ¼ãƒ«ã«ã¦é…å¸ƒã—ã‚¹ãƒãƒ›ã§ç¢ºèªã—ã¦ã‚‚ã‚‰ã†æµã‚Œã€‚ CIãƒ„ãƒ¼ãƒ« Visual Studio Mobile Center - HockeyAppï¼ˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã¨Xamarin Test Cloudï¼ˆUIãƒ†ã‚¹ãƒˆï¼‰ã‚’çµ±åˆã—ãŸCIã‚µãƒ¼ãƒ“ã‚¹ã€‚Xamarin.Formsã¯2017å¹´3æœˆ18æ—¥ç¾åœ¨iOSå¯¾å¿œã€Androidéå¯¾å¿œã¨ã„ã†çŠ¶æ³ã€‚UWPã¯çŸ¥ã‚‰ãªã„ã€‚ Wercker - masterãƒãƒ¼ã‚¸å¾Œã«ã„ã‚‰ãªããªã£ãŸfeatureãƒ–ãƒ©ãƒ³ãƒã‚’æ¶ˆã™ãªã©ã®å¾Œç‰‡ä»˜ã‘å½¹ã€‚ Appã‚¹ãƒˆã‚¢ã¸ãƒ‡ãƒ—ãƒ­ã‚¤ Android iOS UWP \n- featureãƒ–ãƒ©ãƒ³ãƒã‚’ãã£ã¦ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ãŸã¦ã‚‹\n- å½“è©²ãƒ–ãƒ©ãƒ³ãƒã«å¯¾ã—ã¦CIãƒ„ãƒ¼ãƒ«ã§ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆãƒ»é…å¸ƒã‚’è‡ªå‹•åŒ– - ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆå¾Œã«ãƒ¬ãƒ“ãƒ¥ã‚¢ãƒ¼ã«ãƒ¡ãƒ¼ãƒ«ã«ã¦é…å¸ƒã—ã‚¹ãƒãƒ›ã§ç¢ºèªã—ã¦ã‚‚ã‚‰ã†æµã‚Œã€‚ CIãƒ„ãƒ¼ãƒ« Visual Studio Mobile Center - HockeyAppï¼ˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã¨Xamarin Test Cloudï¼ˆUIãƒ†ã‚¹ãƒˆï¼‰ã‚’çµ±åˆã—ãŸCIã‚µãƒ¼ãƒ“ã‚¹ã€‚Xamarin.Formsã¯2017å¹´3æœˆ18æ—¥ç¾åœ¨iOSå¯¾å¿œã€Androidéå¯¾å¿œã¨ã„ã†çŠ¶æ³ã€‚UWPã¯çŸ¥ã‚‰ãªã„ã€‚ Wercker - masterãƒãƒ¼ã‚¸å¾Œã«ã„ã‚‰ãªããªã£ãŸfeatureãƒ–ãƒ©ãƒ³ãƒã‚’æ¶ˆã™ãªã©ã®å¾Œç‰‡ä»˜ã‘å½¹ã€‚ \n- CIãƒ„ãƒ¼ãƒ« Visual Studio Mobile Center - HockeyAppï¼ˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã¨Xamarin Test Cloudï¼ˆUIãƒ†ã‚¹ãƒˆï¼‰ã‚’çµ±åˆã—ãŸCIã‚µãƒ¼ãƒ“ã‚¹ã€‚Xamarin.Formsã¯2017å¹´3æœˆ18æ—¥ç¾åœ¨iOSå¯¾å¿œã€Androidéå¯¾å¿œã¨ã„ã†çŠ¶æ³ã€‚UWPã¯çŸ¥ã‚‰ãªã„ã€‚ Wercker - masterãƒãƒ¼ã‚¸å¾Œã«ã„ã‚‰ãªããªã£ãŸfeatureãƒ–ãƒ©ãƒ³ãƒã‚’æ¶ˆã™ãªã©ã®å¾Œç‰‡ä»˜ã‘å½¹ã€‚ \n- Visual Studio Mobile Center - HockeyAppï¼ˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãƒ¬ãƒãƒ¼ãƒˆï¼‰ã¨Xamarin Test Cloudï¼ˆUIãƒ†ã‚¹ãƒˆï¼‰ã‚’çµ±åˆã—ãŸCIã‚µãƒ¼ãƒ“ã‚¹ã€‚Xamarin.Formsã¯2017å¹´3æœˆ18æ—¥ç¾åœ¨iOSå¯¾å¿œã€Androidéå¯¾å¿œã¨ã„ã†çŠ¶æ³ã€‚UWPã¯çŸ¥ã‚‰ãªã„ã€‚\n- Wercker - masterãƒãƒ¼ã‚¸å¾Œã«ã„ã‚‰ãªããªã£ãŸfeatureãƒ–ãƒ©ãƒ³ãƒã‚’æ¶ˆã™ãªã©ã®å¾Œç‰‡ä»˜ã‘å½¹ã€‚\n- Appã‚¹ãƒˆã‚¢ã¸ãƒ‡ãƒ—ãƒ­ã‚¤ Android iOS UWP \n- Android\n- iOS\n- UWP \n\nã¡ãªã¿ã«Werckerã§ã®featureãƒ–ãƒ©ãƒ³ãƒãªã©ã®å¾Œç‰‡ä»˜ã‘ã¯ã“ã‚“ãªæ„Ÿã˜ã§ã™ã€‚masterãƒãƒ¼ã‚¸ã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§èµ°ã‚‰ã›ã¾ã™ã€‚   yaml \n\nbox: ruby:2.4.0 build: steps: - add-ssh-key: host: github.com keyname: GITHUB - add-to-known_hosts: hostname: github.com fingerprint: 16:27:ac:a5:76:28:2d:36:63:1b:56:4d:eb:df:a6:48 - script: name: Add git-tag code: | _tag=$(date -u -d '9 hours' +%Y-%m-%d-%H-%M-%S) git remote add origin git@github.com:nabinno/utagaki.git git config --global user.email 'wercker@blahfe.com' git config --global user.name 'Wercker Bot' git tag -a $_tag master -m 'wercker deploy' git push origin $_tag after-steps: - wantedly/pretty-slack-notify: webhook_url: ${SLACK_WEBHOOK_URL} channel: general     > é–‹ç™ºç’°å¢ƒé–‹ç™ºç’°å¢ƒ \n\nãã®ä¸Šã§é–‹ç™ºç’°å¢ƒã¯ä¸‹è¨˜ã®é€šã‚Šã«è¨­å®šã—ã¾ã™ã€‚Visual Studio 2017ç‰ˆXamarinã¯ç¾æ™‚ç‚¹ã§HypervisorãŒHyper-Vã‚’è€ƒæ…®ã—ã¦ã„ãªã„ã€Intel HAXMã‚„VirtualBoxãªã©ã®ãƒ›ã‚¹ãƒˆå‹ã‚’å‰æã¨ã—ã¦ã„ã¾ã™ã€‚ãŸã ç§è¦‹ã¨ã—ã¦ã¯ã€VirtualBoxãªã©ã®ãƒ›ã‚¹ãƒˆå‹ã¯Windowsã‚¢ãƒƒãƒ—ãƒ‡ãƒ¼ãƒˆæ™‚ã«å‹•ä½œæ¤œè¨¼å¯¾è±¡ã¨ãªã£ã¦ãŠã‚‰ãšã‚¯ãƒ©ãƒƒã‚·ãƒ¥ãŒèµ·ãã‚„ã™ã„ã§ã™ã€‚Hyper-Vã‚’é–‹ç™ºç’°å¢ƒã¨ã™ã‚‹ã“ã¨ã‚’ãŠè–¦ã‚ã—ã¾ã™ã€‚ã„ãšã‚Œã«ã›ã‚ˆã€ãƒ‡ãƒãƒƒã‚°ã¯ãƒ“ãƒ«ãƒ‰ã‚¹ãƒ”ãƒ¼ãƒ‰ç­‰ãŒHypervisorã«å·¦å³ã•ã‚Œã‚‹Androidã§ã¯ãªãUWPã§è¡Œã†ã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚ \n\n- IDE Visual Studio Community 2017 Basic extentions Microsoft Visual Studio Community 2017 Version 15.0.26228.9 D15RTWSVC Microsoft .NET Framework Version 4.6.01586 Visual C# 2017 JavaScript Language Service 2.0 JavaScript Project System 2.0 JavaScript UWP Project System 2.0 TypeScript 2.1.5.0 Microsoft Visual Studio VC Package 1.0 Xamarin 4.3.0.784 (73f58d6) Xamarin.Android SDK 7.1.0.41 (9578cdc) Xamarin.iOS and Xamarin.Mac SDK 10.4.0.123 (35d1ccd) Visual Studio Tools for Unity 3.0.0.1 Visual Studio Tools for Universal Windows Apps 15.0.26228.00 Mono Debugging for Visual Studio Mono.Debugging.VisualStudio ASP.NET and Web Tools 2017 15.0.30223.0 NuGet Package Manager 4.0.0 Common Azure Tools 1.9 NpgsqlVSPackage Extension 1.0 Merq 1.1.13-alpha (2f64b6d) VSPackage Extension 1.2 Other extentions JetBrains ReSharper Ultimate 2016.3.2 - ãªã«ã¯ã¨ã‚‚ã‚ã‚Œå…¥ã‚Œã¦ãŠãã€‚ CodeMaid 10.2.7 - æ°—è»½ã«ã‚³ãƒ¼ãƒ‰æ•´å½¢ã—ã¦ãã‚Œã‚‹ã€‚ .ignore 1.2.71 Markdown Editor 1.11.201 File Nesting 2.6.67 GitHub.VisualStudio 2.2.0.8 VSColorOutput 2.5 HideMenu 1.0 - MinimaliticViewã¨ã®çµ„ã¿åˆã‚ã›ã§Emacsã£ã½ã„ç”»é¢ã«ãªã‚‹ã€‚ MinimaliticView Extension 1.0 Debugç”¨ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ XAML Previewer for Xamarin.Forms - Gorilla Playerã¯VS2017æœªå¯¾å¿œã®ä¸Šã€Data Bindingã‚’å‚ç…§ã§ããªã„ãŸã‚æ©Ÿèƒ½çš„ã«XAML Previewer for Xamarin.Formsã¨ã»ã¼ã‹ã‚ã‚‰ãªã„æ§˜å­ã€‚ Android Emulator Manager/Android SDK Manager - VS2017ã§ã¯Hyper-Vãƒ™ãƒ¼ã‚¹ã®Visual Studio Emulator for XamarinãŒãªããªã‚Šã€Intel HAXMãƒ™ãƒ¼ã‚¹ã®Android Emulator Manager/Android SDK Manager (Google)ã®ã¿ã¨ãªã£ãŸã€‚ \n- Visual Studio Community 2017\n- Basic extentions Microsoft Visual Studio Community 2017 Version 15.0.26228.9 D15RTWSVC Microsoft .NET Framework Version 4.6.01586 Visual C# 2017 JavaScript Language Service 2.0 JavaScript Project System 2.0 JavaScript UWP Project System 2.0 TypeScript 2.1.5.0 Microsoft Visual Studio VC Package 1.0 Xamarin 4.3.0.784 (73f58d6) Xamarin.Android SDK 7.1.0.41 (9578cdc) Xamarin.iOS and Xamarin.Mac SDK 10.4.0.123 (35d1ccd) Visual Studio Tools for Unity 3.0.0.1 Visual Studio Tools for Universal Windows Apps 15.0.26228.00 Mono Debugging for Visual Studio Mono.Debugging.VisualStudio ASP.NET and Web Tools 2017 15.0.30223.0 NuGet Package Manager 4.0.0 Common Azure Tools 1.9 NpgsqlVSPackage Extension 1.0 Merq 1.1.13-alpha (2f64b6d) VSPackage Extension 1.2 \n- Microsoft Visual Studio Community 2017 Version 15.0.26228.9 D15RTWSVC\n- Microsoft .NET Framework Version 4.6.01586\n- Visual C# 2017\n- JavaScript Language Service 2.0\n- JavaScript Project System 2.0\n- JavaScript UWP Project System 2.0\n- TypeScript 2.1.5.0\n- Microsoft Visual Studio VC Package 1.0\n- Xamarin 4.3.0.784 (73f58d6)\n- Xamarin.Android SDK 7.1.0.41 (9578cdc)\n- Xamarin.iOS and Xamarin.Mac SDK 10.4.0.123 (35d1ccd)\n- Visual Studio Tools for Unity 3.0.0.1\n- Visual Studio Tools for Universal Windows Apps 15.0.26228.00\n- Mono Debugging for Visual Studio Mono.Debugging.VisualStudio\n- ASP.NET and Web Tools 2017 15.0.30223.0\n- NuGet Package Manager 4.0.0\n- Common Azure Tools 1.9\n- NpgsqlVSPackage Extension 1.0\n- Merq 1.1.13-alpha (2f64b6d)\n- VSPackage Extension 1.2\n- Other extentions JetBrains ReSharper Ultimate 2016.3.2 - ãªã«ã¯ã¨ã‚‚ã‚ã‚Œå…¥ã‚Œã¦ãŠãã€‚ CodeMaid 10.2.7 - æ°—è»½ã«ã‚³ãƒ¼ãƒ‰æ•´å½¢ã—ã¦ãã‚Œã‚‹ã€‚ .ignore 1.2.71 Markdown Editor 1.11.201 File Nesting 2.6.67 GitHub.VisualStudio 2.2.0.8 VSColorOutput 2.5 HideMenu 1.0 - MinimaliticViewã¨ã®çµ„ã¿åˆã‚ã›ã§Emacsã£ã½ã„ç”»é¢ã«ãªã‚‹ã€‚ MinimaliticView Extension 1.0 \n- JetBrains ReSharper Ultimate 2016.3.2 - ãªã«ã¯ã¨ã‚‚ã‚ã‚Œå…¥ã‚Œã¦ãŠãã€‚\n- CodeMaid 10.2.7 - æ°—è»½ã«ã‚³ãƒ¼ãƒ‰æ•´å½¢ã—ã¦ãã‚Œã‚‹ã€‚\n- .ignore 1.2.71\n- Markdown Editor 1.11.201\n- File Nesting 2.6.67\n- GitHub.VisualStudio 2.2.0.8\n- VSColorOutput 2.5\n- HideMenu 1.0 - MinimaliticViewã¨ã®çµ„ã¿åˆã‚ã›ã§Emacsã£ã½ã„ç”»é¢ã«ãªã‚‹ã€‚\n- MinimaliticView Extension 1.0\n- Debugç”¨ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ XAML Previewer for Xamarin.Forms - Gorilla Playerã¯VS2017æœªå¯¾å¿œã®ä¸Šã€Data Bindingã‚’å‚ç…§ã§ããªã„ãŸã‚æ©Ÿèƒ½çš„ã«XAML Previewer for Xamarin.Formsã¨ã»ã¼ã‹ã‚ã‚‰ãªã„æ§˜å­ã€‚ Android Emulator Manager/Android SDK Manager - VS2017ã§ã¯Hyper-Vãƒ™ãƒ¼ã‚¹ã®Visual Studio Emulator for XamarinãŒãªããªã‚Šã€Intel HAXMãƒ™ãƒ¼ã‚¹ã®Android Emulator Manager/Android SDK Manager (Google)ã®ã¿ã¨ãªã£ãŸã€‚ \n- XAML Previewer for Xamarin.Forms - Gorilla Playerã¯VS2017æœªå¯¾å¿œã®ä¸Šã€Data Bindingã‚’å‚ç…§ã§ããªã„ãŸã‚æ©Ÿèƒ½çš„ã«XAML Previewer for Xamarin.Formsã¨ã»ã¼ã‹ã‚ã‚‰ãªã„æ§˜å­ã€‚\n- Android Emulator Manager/Android SDK Manager - VS2017ã§ã¯Hyper-Vãƒ™ãƒ¼ã‚¹ã®Visual Studio Emulator for XamarinãŒãªããªã‚Šã€Intel HAXMãƒ™ãƒ¼ã‚¹ã®Android Emulator Manager/Android SDK Manager (Google)ã®ã¿ã¨ãªã£ãŸã€‚\n- DevStack Prism Prism template - ã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ã€ã‚¹ãƒ‹ãƒšãƒƒãƒˆä¾¿åˆ© Profile78 - Profile259ã«ãªã£ã¦ã„ã‚‹ãŒWindows 8å¿…è¦ãªã„ã®ã§ Newtonsoft.Json FubarCoder.RestSharp.Portable.HttpClient NUnit Moq \n- Prism Prism template - ã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ã€ã‚¹ãƒ‹ãƒšãƒƒãƒˆä¾¿åˆ© Profile78 - Profile259ã«ãªã£ã¦ã„ã‚‹ãŒWindows 8å¿…è¦ãªã„ã®ã§ Newtonsoft.Json FubarCoder.RestSharp.Portable.HttpClient NUnit Moq \n- Prism template - ã‚¹ã‚­ãƒ£ãƒ•ã‚©ãƒ¼ãƒ«ãƒ‰ã€ã‚¹ãƒ‹ãƒšãƒƒãƒˆä¾¿åˆ©\n- Profile78 - Profile259ã«ãªã£ã¦ã„ã‚‹ãŒWindows 8å¿…è¦ãªã„ã®ã§\n- Newtonsoft.Json\n- FubarCoder.RestSharp.Portable.HttpClient\n- NUnit\n- Moq   > ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ \n\nãŠã¾ã‘ã®Emacsé¢¨ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã€‚Edit.Emacsãƒ¡ã‚½ãƒƒãƒ‰ã¯1ç´šå¸‚æ°‘ã§ã¯ãªã„ã®ã§ãã®å‘¨è¾ºã§ä»£æ›¿ã—ã¾ã™ã€‚Edit.LineCutã€Edit.Outlineã€ReSharpeã®ã„ã‚‰ãªã„ã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰ã¯å‰Šé™¤ã—ã¦ã„ã¾ã™ã€‚    category command keybind     Navigation CodeMaid.SwitchFile C-c,:   Navigation Edit.CharLeft C-b   Navigation Edit.CharRight C-f   Navigation Edit.DocumentBottom M->   Navigation Edit.DocumentTop M-<   Navigation Edit.GoTo M-g   Navigation Edit.IncrementalSearch C-s   Navigation Edit.LineDown C-n   Navigation Edit.LineEnd C-e   Navigation Edit.LineStart C-a   Navigation Edit.LineUp C-p   Navigation Edit.NextMethod M-}   Navigation Edit.PageDown C-v   Navigation Edit.PageUp M-v   Navigation Edit.PreviousMethod M-{   Navigation Edit.ScrollLineCenter C-l   Navigation Edit.ToggleAllOutling C-u,M-c   Navigation Edit.ToggleOutlingExpansion C-i   Navigation Edit.WordNext M-f   Navigation Edit.WordPrevious M-b   Navigation ReSharper.ReSharper_GotoRecentFiles M-x,b   Navigation Team.TeamExplorerSearch C-x,g   Navigation View.C#Interactive C-c,i   Navigation Window.NewVerticalTabGroup C-x,&#124;   Navigation Window.PreviousTabGroup C-x,1   Edit Build.BuildSolution C-c,b   Edit Build.RebuildSolution C-c,r   Edit CodeMaid.JoinLine C-c,j   Edit CodeMaid.SortLines M-x,s   Edit Debug.Start C-c,d   Edit Edit.BackwardDelete C-h   Edit Edit.BackwardDelete M-h   Edit Edit.BreakLine C-m   Edit Edit.Capitalize M-c   Edit Edit.CommentSelection M-;   Edit Edit.Delete C-d   Edit Edit.InsertSnippet C-,   Edit Edit.LineCut C-k   Edit Edit.LineDownExtendColumn M-.   Edit Edit.LineUpExtendColumn M-,   Edit Edit.MakeLowercase M-l   Edit Edit.MakeUppercase M-u   Edit Edit.Paste C-y   Edit Edit.SelectCurrentWord C-SPC   Edit Edit.UncommentSelection M-:   Edit Edit.Undo M-/   Edit File.Close C-x,k   Edit File.SaveSelection C-x,C-s   Edit Project.AddNewItem C-c,s   Edit ReSharpe._ReSharper_DuplicateText C-c,p   Edit ReSharper.ReSharper_GotoRelatedFile C-c,;   Edit ReSharper.ReSharper_GotoText C-c,g   Edit Tools.ManageNuGetPackagesforSolution C-c,n   Edit Tools.Options M-0   Edit View.PackageManagerConsole C-q,1      > WRAPUPWRAPUP \n\né€”ä¸­é€”ä¸­å¿ƒã®å£°ãŒæ¼ã‚Œã¦ã„ã¾ã™ãŒã€ãªã‚“ã¨ã‹è§¦ã‚Œã‚‹çŠ¶æ…‹ã«ãªã£ã¦ãã¾ã—ãŸã€‚ãŸã ã€ãƒ¢ãƒãƒ™ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã—ã¦ã¯ä¸‹ãŒã‚Šæ°—å‘³ãªã®ã§ã“ã®ã¾ã¾Xamarinã‚’ã•ã‚ã‚Šç¶šã‘ã‚‹ã‹ã¯åˆ†ã‹ã‚Šã¾ã›ã‚“ã€‚ã‚„ã¯ã‚Šæ–‡åŒ–ãŒé•ã„ã¾ã™ã­ã€‚"},"name":"[2017-03-31]Xamariné–‹ç™ºç’°å¢ƒã‚’ã¨ã¨ã®ãˆã‚‹","tags":["xamarin.forms","prism","xamarin"],"childPublishedDate":{"published_on":"2017-03-31T00:00:00.000Z","published_on_unix":1490918400}}},{"node":{"number":60,"relative_category":"blog/backend","fields":{"title":"é€£è¼‰ Rails2Phoenix 2 èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹","excerpt":"é€£è¼‰ã€ŒRails2Phoenixã€ã«ãªã‚Šã¾ã™ã€å‰å›ã¯ã€ŒUmbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Herokuã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ ã€ã§ã—ãŸã€‚ä»Šå›ã¯å‰å›èª²é¡Œã¨ã—ã¦ã‚ãŒã£ãŸèªè¨¼æ©Ÿèƒ½ã®å®Ÿè£…ã‚’è©¦ã¿ãŸã„ã¨æ€ã„ã¾ã™ã€‚   > PROBLEMPROBLEM \n\n- ã‚µãƒ¼ãƒ“ã‚¹ã«ã¤ã„ã¦ æ‹¡å¼µã«ã¨ã‚‚ãªã„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãŒãµãˆã‚‹ã®ã‚’æŠ‘ãˆãŸã„ ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®ãŸã‚ã®ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ã‚ã’ãŸã„ \n- æ‹¡å¼µã«ã¨ã‚‚ãªã„æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ãŒãµãˆã‚‹ã®ã‚’æŠ‘ãˆãŸã„\n- ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£ã®ãŸã‚ã®ã‚³ã‚¹ãƒˆã‚’æŠ‘ãˆãŸã„\n- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ã‚ã’ãŸã„   > SOLUTIONSOLUTION \n\nã¨ã„ã†ã‚ã‘ã§ã€ç¾åœ¨ã¤ã‹ã£ã¦ã„ã‚‹Railsã‚’Phoenixã«å¤‰æ›´ã™ã‚‹ã“ã¨ã«ã—ã¾ã—ãŸã€‚æ–¹é‡ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã€ä»Šå›ã¯Rails/Deviseã®èªè¨¼æ©Ÿèƒ½ã‚’Phoenixã§å®Ÿè£…ã™ã‚‹æµã‚Œã‚’å–ã‚Šä¸Šã’ã¾ã™ã€‚ \n\næ–¹é‡ \n\n- Railsã‹ã‚‰å¾ã€…ã«Phoenixã«ç§»è¡Œã§ãã‚‹ã‚ˆã†ã« ã„ã¾ã¾ã§ã¨ãŠãªã˜PaaSï¼ˆHerokuï¼‰ ã„ã¾ã¾ã§ã¨ãŠãªã˜ãƒ¬ãƒã‚¸ãƒˆãƒª ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã« æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã ã„ã¾ã¾ã§ã¨ãŠãªã˜DB ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„ \n- ã„ã¾ã¾ã§ã¨ãŠãªã˜PaaSï¼ˆHerokuï¼‰\n- ã„ã¾ã¾ã§ã¨ãŠãªã˜ãƒ¬ãƒã‚¸ãƒˆãƒª ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã« æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã \n- ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ã¯ phoenix/base ã‚’ãƒ™ãƒ¼ã‚¹ã«\n- æ°—è»½ã«å‚ç…§ã§ãã‚‹ã‚ˆã†ã«Railsé–¢é€£ãƒ•ã‚¡ã‚¤ãƒ«ã¯å¯èƒ½ãªé™ã‚Šã®ã“ã—ã¦ãŠã\n- ã„ã¾ã¾ã§ã¨ãŠãªã˜DB ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„ \n- ç§»è¡Œå®Œäº†ã¾ã§DBãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã—ãªã„\n- Phoenixã¯ä»Šå¾Œã®æ‹¡å¼µæ€§ã‚’ã‹ã‚“ãŒãˆã¦Umbrellaãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§   > Guardianã‚’å®Ÿè£…ã™ã‚‹Guardianã‚’å®Ÿè£…ã™ã‚‹ \n\nã¾ãšã€å‚è€ƒã«ã—ãŸã®ã¯Blackodeã®guardian_authã§ã™ã€‚ãŸã ã€Guardianã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ãŒãµã‚‹ã„ã®ã§1.0ã¸ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³è¨˜äº‹ã‚’ã‚‚ã¨ã«ã‚¢ãƒ¬ãƒ³ã‚¸ã—ã¦ã‚ã‚Šã¾ã™ã€‚èªè¨¼ã«é–¢ä¿‚ã—ãã†ãªæ§‹æˆã¯ä¸‹è¨˜ã®é€šã‚Šã€‚ \n\nãƒ­ã‚¸ãƒƒã‚¯ \n\n- MyApp.Account\n- MyApp.Account.Registration\n- MyApp.Account.User\n- MyApp.Auth.Guardian\n- MyApp.Auth.ErrorHandler\n- MyApp.Auth.Pipeline\n- MyApp.Auth.AfterPipeline\n- MyApp.Auth.Session \n\nã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ© \n\n- MyAppWeb.RegistrationController\n- MyAppWeb.SessionController   > ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¶ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã®è¨­å®šã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚¶ã¨ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©ã®è¨­å®š \n\nGuardian1.0ã‹ã‚‰ç›´æ¥ã§ã¯ãªããƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ä»‹ã—ã¦å‚ç…§ã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚ä¸‹è¨˜ã®ã‚ˆã†ã«å„ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’ç”¨æ„ã—ã¦ã‚³ãƒ³ãƒ•ã‚£ã‚°ã«å‰²ã‚Šå½“ã¦ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app/auth/guardian.ex defmodule MyApp.Auth.Guardian do use Guardian, otp_app: :my_app alias MyApp.Account def subject_for_token(resource, _claims), do: {:ok, to_string(resource.id)} def subject_for_token(_, _), do: {:error, :reason_for_error} def resource_from_claims(claims), do: {:ok, Account.get_user!(claims[\"sub\"])} def resource_from_claims(_claims), do: {:error, :reason_for_error} end     elixir \n\n# apps/my_app/lib/my_app/auth/error_handler.ex defmodule MyApp.Auth.ErrorHandler do import Plug.Conn def auth_error(conn, {type, _reason}, _opts) do body = Poison.encode!(%{message: to_string(type)}) send_resp(conn, 401, body) end end     elixir \n\n# apps/my_app/config/config.exs config :my_app, MyApp.Auth.Guardian, issuer: \"MyApp\", ttl: {30, :days}, allowed_drift: 2000, # optionals allowed_algos: [\"HS512\"], verify_module: MyApp.Auth.Guardian.JWT, verify_issuer: true, secret_key: System.get_env(\"GUARDIAN_SECRET\") || \"secret_key\"     > ãƒ«ãƒ¼ã‚¿ãƒ¼ã®è¨­å®šãƒ«ãƒ¼ã‚¿ãƒ¼ã®è¨­å®š \n\nèªè¨¼ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã¯ã€èªè¨¼ä¸­ã¨èªè¨¼å¾Œã®ã‚‚ã®ã‚’ç”¨æ„ã—ã‚³ãƒ³ãƒ•ã‚£ã‚°ã¨ãƒ«ãƒ¼ã‚¿ãƒ¼ã«å‰²ã‚Šå½“ã¦ã¾ã™ã€‚ \n\nãƒ«ãƒ¼ã‚¿ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ—å†…ã®ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ãã¿ã‚ã‚ã›ã«ã¤ã„ã¦ã€ã“ã“ã§ã¯æœªãƒ­ã‚°ã‚¤ãƒ³ã‚¹ã‚³ãƒ¼ãƒ—ã«ã¯èªè¨¼å‰ãƒ»èªè¨¼ä¸­ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã€ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã‚¹ã‚³ãƒ¼ãƒ—ã«ã¯èªè¨¼å‰ãƒ»èªè¨¼ä¸­ãƒ»èªè¨¼å¾Œãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã‚’é©ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã†ã™ã‚‹ã“ã¨ã§ã©ã®ã‚¹ã‚³ãƒ¼ãƒ—ã«ã‚‚èªè¨¼ãƒªã‚½ãƒ¼ã‚¹ã‚’ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ã“ã¨ãŒã§ãã€ã‹ã¤ã€èªè¨¼ã‚‚æ‹…ä¿ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚å…·ä½“çš„ã«ã„ã†ã¨ã€ãƒ«ãƒ¼ãƒˆ / ãªã©ã®åŒä¸€URLã§æœªãƒ­ã‚°ã‚¤ãƒ³ã‚¹ã‚³ãƒ¼ãƒ—ã¨ãƒ­ã‚°ã‚¤ãƒ³æ¸ˆã‚¹ã‚³ãƒ¼ãƒ—ã®åˆ‡ã‚Šæ›¿ãˆãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app/auth/pipeline.ex defmodule MyApp.Auth.Pipeline do use Guardian.Plug.Pipeline, otp_app: :my_app plug(Guardian.Plug.VerifySession, claims: %{\"typ\" => \"access\"}) plug(Guardian.Plug.VerifyHeader, claims: %{\"typ\" => \"access\"}) plug(Guardian.Plug.LoadResource, allow_blank: true) end     elixir \n\n# apps/my_app/lib/my_app/auth/after_pipeline.ex defmodule MyApp.Auth.AfterPipeline do use Guardian.Plug.Pipeline, otp_app: :my_app plug(Guardian.Plug.EnsureAuthenticated) end     elixir \n\n# apps/my_app/lib/my_app_web/router.ex defmodule MyAppWeb.Router do use MyAppWeb, :router pipeline :browser do plug(:accepts, [\"html\"]) plug(:fetch_session) plug(:fetch_flash) plug(:protect_from_forgery) plug(:put_secure_browser_headers) end pipeline :browser_auth do plug(MyApp.Auth.Pipeline) end pipeline :browser_auth_after do plug(MyApp.Auth.AfterPipeline) end scope \"/\", MyAppWeb do pipe_through([:browser, :browser_auth]) post(\"/registration\", RegistrationController, :create) get(\"/login\", SessionController, :new) post(\"/login\", SessionController, :create) get(\"/logout\", SessionController, :delete) end scope \"/\", MyAppWeb do pipe_through([:browser, :browser_auth, :browser_auth_after]) get(\"/edit\", RegistrationController, :edit) put(\"/edit\", RegistrationController, :update) get(\"/users\", UserController, :index) resources \"/\", UserController, only: [:show, :delete], param: \"username\" end end     elixir \n\n# apps/my_app/config/config.exs config :MyApp, MyApp.Auth.Pipeline, module: MyApp.Auth.Guardian, error_handler: MyApp.Auth.ErrorHandler config :MyApp, MyApp.Auth.AferPipeline, module: MyApp.Auth.Guardian, error_handler: MyApp.Auth.ErrorHandler     > ç™»éŒ²ç™»éŒ² \n\nç™»éŒ²ã¯ç™»éŒ²ç”¨ã®ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¢ãƒ‡ãƒ«ã¨ç™»éŒ²ã‚µãƒ¼ãƒ“ã‚¹ï¼‰ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚’ç”¨æ„ã—ã¾ã™ã€‚ \n\nã“ã®ã‚ãŸã‚Šã¯Devise/Railsã¨ã‚ã¾ã‚Šå¤‰ã‚ã‚Šã¾ã›ã‚“ã€‚ä»–ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€Œæ–°è¦ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ç™ºè¡Œã€ã€Œãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹ç¢ºèªã€ç­‰ã‚‚åŒæ§˜ã®æ§‹æˆã‚’ã¨ã‚ã†ã¨æ€ã£ã¦ã„ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app_web/controller/registration_controller.ex def create(conn, user_params) do changeset = User.registration_changeset(%User{}, user_params) case Registration.create(changeset, Repo) do {:ok, user} -> conn |> MyApp.Auth.login(user) |> put_flash(:info, \"Your account was created successfully\") |> redirect(to: page_path(conn, :home)) {:error, changeset} -> conn |> put_flash(:error, \"Unable to create account: Try again\") |> render(MyAppWeb.PageView, \"home.html\", changeset: changeset) end end     elixir \n\n# apps/my_app/lib/my_app/auth/auth.ex def login(conn, %User{} = user) do conn |> Guardian.Plug.sign_in(user) |> assign(:current_user, user) end     elixir \n\n# apps/my_app/lib/my_app/account/registration.ex def create(changeset, repo) do changeset |> repo.insert() end     > ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ \n\nãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆã¯ã‚»ãƒƒã‚·ãƒ§ãƒ³ç”¨ã®ã‚µãƒ¼ãƒ“ã‚¹ã¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã§å®Ÿè£…ã—ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app_web/controller/session_controller.ex @doc \"Logged in [POST /login]\" def create(conn, %{\"email\" => email, \"password\" => password}) do case Session.authenticate_user(email, password) do {:ok, user} -> conn |> Session.login(user) |> put_flash(:info, \"Logged in successfully\") |> redirect(to: page_path(conn, :home)) {:error, _reason} -> conn |> put_flash(:error, \"Wrong username/password\") |> render(\"new.html\") end end @doc \"Logged out [DELETE /logout]\" def delete(conn, _params) do conn |> Session.logout() |> put_flash(:info, \"Logged out successfully.\") |> redirect(to: \"/\") end     elixir \n\n# apps/my_app/lib/my_app/auth/session.ex defmodule MyApp.Auth.Session do import Ecto.Query import Plug.Conn import Comeonin.Bcrypt, only: [checkpw: 2, dummy_checkpw: 0] alias MyApp.Repo alias MyApp.Auth.Guardian alias MyApp.Account.User def login(conn, %User{} = user) do conn |> Guardian.Plug.sign_in(user) |> assign(:current_user, user) end def logout(conn), do: Guardian.Plug.sign_out(conn) def authenticate_user(email, given_password) do query = Ecto.Query.from(u in User, where: u.email == ^email) Repo.one(query) |> check_password(given_password) end def current_user(conn), do: Guardian.Plug.current_resource(conn, []) def logged_in?(conn), do: Guardian.Plug.authenticated?(conn, []) defp check_password(nil, _), do: {:error, \"Incorrect username or password\"} defp check_password(user, given_password) do case Comeonin.Bcrypt.checkpw(given_password, user.encrypted_password) do true -> {:ok, user} false -> {:error, \"Incorrect email or password\"} end end end   \n\nDevise/Railsã®ãƒ“ãƒ¥ãƒ¼ãƒ˜ãƒ«ãƒ‘ãƒ¼ã¯ãƒ“ãƒ¥ãƒ¼ãƒã‚¯ãƒ­ã§é©ç”¨ã—ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app_web.ex def view do quote do # .. import Okuribi.Auth.Session, only: [current_user: 1, logged_in?: 1] end end   \n\nã‚ã‚‹ã„ã¯ã€put_assignsé–¢æ•°ã‚’ã¯ã‚„ã—ã¦ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒã‚¯ãƒ­ã«é©ç”¨ã—ã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app/auth/session.ex def put_assigns(%{private: %{phoenix_action: action}} = conn, settings) do current_resource = Guardian.Plug.current_resource(conn) settings = if current_resource, do: settings[:sign_in][action] || [], else: settings[:sign_out][action] || [] conn |> assign(:current_user, current_resource) |> assign(:page_title, settings[:page_title]) |> assign(:page_description, settings[:page_description]) end     elixir \n\n# apps/my_app/lib/my_app_web.ex def controller do quote do # .. import Okuribi.Auth, only: [put_assigns: 2] end end   \n\nassignsã²ã¨ã¤ã§ã‚¢ã‚¯ã‚»ã‚¹ã§ãã‚‹ã®ã§ã€ä¸‹è¨˜ã®ã‚ˆã†ã«ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã§ã¾ã¨ã‚ã¦æŒ‡å®šã™ã‚‹ã“ã¨ã§Railsã®ActionView::Helpers::CaptureHelper#provideã®ä»£ã‚ã‚Šã«ä½¿ãˆã¾ã™ã€‚   elixir \n\n# apps/my_app/lib/my_app_web/controller/*_controller.ex @page %{ sign_in: %{ new: %{ page_title: dgettext(\"views\", \"pages.home.signed_in.page_title\"), page_description: \"\" } }, sign_out: %{ new: %{ page_title: dgettext(\"views\", \"pages.home.signed_out.page_title\"), page_description: \"\" } } } plug(:put_assigns, @page when action in [:home])     > ãã®ä»–ãã®ä»– \n\nRailsã®ãƒ“ãƒ¥ãƒ¼ã‚’Phoenixã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã«ç§»æ¤ã™ã‚‹ã«ã¯ä¸‹è¨˜ã®å¤‰æ›ã‚’åœ°é“ã«è¡Œã£ã¦ã„ãã¾ã™ã€‚ \n\n- Rails ActionView::Helpers::FormHelper#form_for(record, options={}, &block) ActionView::Helpers::FormHelper#text_field(object_name, method, options={}) ActionView::Helpers::FormHelper#file_field(object_name, method, options={}) ActionView::Helpers::FormHelper#hidden_field(object_name, method, options={}) ActionView::Helpers::FormHelper#password_field(object_name, method, options={}) ActionView::Helpers::FormHelper#radio_button(object_name, method, tag_value, options={}) ActionView::Helpers::FormBuilder#submit(value=nil, options={}) ActionView::Helpers::TranslationHelper#t \n- ActionView::Helpers::FormHelper#form_for(record, options={}, &block)\n- ActionView::Helpers::FormHelper#text_field(object_name, method, options={})\n- ActionView::Helpers::FormHelper#file_field(object_name, method, options={})\n- ActionView::Helpers::FormHelper#hidden_field(object_name, method, options={})\n- ActionView::Helpers::FormHelper#password_field(object_name, method, options={})\n- ActionView::Helpers::FormHelper#radio_button(object_name, method, tag_value, options={})\n- ActionView::Helpers::FormBuilder#submit(value=nil, options={})\n- ActionView::Helpers::TranslationHelper#t\n- Phoenix Phoenix.HTML.Form.form_for(form_data, action, options \\\\ [], fun) Phoenix.HTML.Form.text_input(form, field, opts \\\\ []) Phoenix.HTML.Form.file_input(form, field, opts \\\\ []) Phoenix.HTML.Form.hidden_input(form, field, opts \\\\ []) Phoenix.HTML.Form.password_input(form, field, opts \\\\ []) Phoenix.HTML.Form.radio_button(form, field, value, opts \\\\ []) Phoenix.HTML.Form.submit(opts, opts \\\\ []) Gettext.dgettext(backend, domain, msgid, bindings \\\\ %{}) \n- Phoenix.HTML.Form.form_for(form_data, action, options \\\\ [], fun)\n- Phoenix.HTML.Form.text_input(form, field, opts \\\\ [])\n- Phoenix.HTML.Form.file_input(form, field, opts \\\\ [])\n- Phoenix.HTML.Form.hidden_input(form, field, opts \\\\ [])\n- Phoenix.HTML.Form.password_input(form, field, opts \\\\ [])\n- Phoenix.HTML.Form.radio_button(form, field, value, opts \\\\ [])\n- Phoenix.HTML.Form.submit(opts, opts \\\\ [])\n- Gettext.dgettext(backend, domain, msgid, bindings \\\\ %{})   > WRAPUPWRAPUP \n\nå‰å›ã‚‚ãã†ã§ã™ãŒã€ã‚³ãƒ¼ãƒ‰ã®ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¯ã¾ã‚åœ°å‘³ãªä½œæ¥­ã§ã™ã‚ˆã­ã€‚ã¨ã¾ã‚Œã€èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã§ããŸã®ã§è‰¯ã—ã¨ã—ã¾ã—ã‚‡ã†ã€‚"},"name":"[2018-05-20]é€£è¼‰ Rails2Phoenix 2 èªè¨¼æ©Ÿèƒ½ã‚’å®Ÿè£…ã™ã‚‹","tags":["phoenix-framework","elixir","ruby-on-rails","ruby","wercker","heroku","authentication","guardian"],"childPublishedDate":{"published_on":"2018-05-20T00:00:00.000Z","published_on_unix":1526774400}}}]}},"pageContext":{"number":62}},"staticQueryHashes":[]}